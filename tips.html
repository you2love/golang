<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¸¸ç”¨æŠ€å·§ä¸æœ€ä½³å®è·µ - Go å­¦ä¹ æ•™ç¨‹</title>
    <link rel="stylesheet" href="styles.css?v=1.3">
    <script src="scroll.js"></script>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <h3>ğŸ“š å­¦ä¹ ç›®å½•</h3>
            <ul>
                <li><a href="index.html">ğŸ  é¦–é¡µ</a></li>
                
                                <li class="level-1">
                    <span class="level-badge">é˜¶æ®µä¸€ï¼šå…¥é—¨</span>
                </li>
                <li class="nav-item">
                    <a href="introduction.html"><span>ğŸ“– 1. Go è¯­è¨€ç®€ä»‹</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="introduction.html#history">Go çš„å†å²</a></li>
                        <li><a href="introduction.html#features">Go çš„ç‰¹ç‚¹</a></li>
                        <li><a href="introduction.html#install">å®‰è£…ä¸é…ç½®</a></li>
                        <li><a href="introduction.html#helloworld">Hello World</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="basics.html"><span>ğŸ”¤ 2. åŸºç¡€è¯­æ³•</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="basics.html#variables">å˜é‡å£°æ˜</a></li>
                        <li><a href="basics.html#datatypes">æ•°æ®ç±»å‹</a></li>
                        <li><a href="basics.html#operators">è¿ç®—ç¬¦</a></li>
                        <li><a href="basics.html#arrays">æ•°ç»„ä¸åˆ‡ç‰‡</a></li>
                        <li><a href="basics.html#maps">æ˜ å°„</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="control-flow.html"><span>ğŸ”„ 3. æ§åˆ¶æµ</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="control-flow.html#if">if è¯­å¥</a></li>
                        <li><a href="control-flow.html#switch">switch è¯­å¥</a></li>
                        <li><a href="control-flow.html#for">for å¾ªç¯</a></li>
                        <li><a href="control-flow.html#defer">defer è¯­å¥</a></li>
                    </ul>
                </li>
                <li class="level-1">
                    <span class="level-badge">é˜¶æ®µäºŒï¼šè¿›é˜¶</span>
                </li>
                <li class="nav-item">
                    <a href="functions.html"><span>âš¡ 4. å‡½æ•°</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="functions.html#basic">åŸºæœ¬å‡½æ•°</a></li>
                        <li><a href="functions.html#multiple">å¤šè¿”å›å€¼</a></li>
                        <li><a href="functions.html#variadic">å¯å˜å‚æ•°</a></li>
                        <li><a href="functions.html#closure">é—­åŒ…</a></li>
                        <li><a href="functions.html#methods">æ–¹æ³•</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="structs.html"><span>ğŸ—ï¸ 5. ç»“æ„ä½“ä¸æ¥å£</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="structs.html#struct">ç»“æ„ä½“</a></li>
                        <li><a href="structs.html#nested">åµŒå¥—ç»“æ„ä½“</a></li>
                        <li><a href="structs.html#methods">ç»“æ„ä½“æ–¹æ³•</a></li>
                        <li><a href="structs.html#interface">æ¥å£</a></li>
                        <li><a href="structs.html#tags">ç»“æ„ä½“æ ‡ç­¾</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="modules.html"><span>ğŸ“¦ 6. æ¨¡å—åŒ–ä¸ Go Module</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="modules.html#introduction">Go Module ç®€ä»‹</a></li>
                        <li><a href="modules.html#init">åˆå§‹åŒ– Module</a></li>
                        <li><a href="modules.html#dependency">ä¾èµ–ç®¡ç†</a></li>
                        <li><a href="modules.html#version">ç‰ˆæœ¬æ§åˆ¶</a></li>
                        <li><a href="modules.html#private">ç§æœ‰ Module</a></li>
                    </ul>
                </li>
                <li class="level-1">
                    <span class="level-badge">é˜¶æ®µäºŒï¼šè¿›é˜¶äºŒ</span>
                </li>
                <li class="nav-item">
                    <a href="generics.html"><span>ğŸ§© 7. æ³›å‹</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="generics.html#functions">æ³›å‹å‡½æ•°</a></li>
                        <li><a href="generics.html#types">æ³›å‹ç±»å‹</a></li>
                        <li><a href="generics.html#constraints">ç±»å‹çº¦æŸ</a></li>
                        <li><a href="generics.html#inference">ç±»å‹æ¨æ–­</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="reflection.html"><span>ğŸ” 8. åå°„</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="reflection.html#typevalue">Type å’Œ Value</a></li>
                        <li><a href="reflection.html#struct">ç»“æ„ä½“åå°„</a></li>
                        <li><a href="reflection.html#modify">ä¿®æ”¹å€¼</a></li>
                        <li><a href="reflection.html#methods">è°ƒç”¨æ–¹æ³•</a></li>
                        <li><a href="reflection.html#performance">æ€§èƒ½è€ƒè™‘</a></li>
                    </ul>
                </li>
                <li class="level-1">
                    <span class="level-badge">é˜¶æ®µä¸‰ï¼šé«˜çº§</span>
                </li>
                <li class="nav-item">
                    <a href="concurrency.html"><span>ğŸš€ 9. å¹¶å‘ç¼–ç¨‹</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="concurrency.html#goroutine">Goroutine</a></li>
                        <li><a href="concurrency.html#channel">Channel</a></li>
                        <li><a href="concurrency.html#select">Select</a></li>
                        <li><a href="concurrency.html#mutex">äº’æ–¥é”</a></li>
                        <li><a href="concurrency.html#context">Context</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="stdlib.html"><span>ğŸ“š 10. å¸¸ç”¨æ ‡å‡†åº“</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="stdlib.html#regexp">regexp æ­£åˆ™è¡¨è¾¾å¼</a></li>
                        <li><a href="stdlib.html#sync">sync å¹¶å‘åŸè¯­</a></li>
                        <li><a href="stdlib.html#json">json æ•°æ®ç¼–ç </a></li>
                        <li><a href="stdlib.html#time">time æ—¶é—´å¤„ç†</a></li>
                        <li><a href="stdlib.html#io">io è¾“å…¥è¾“å‡º</a></li>
                        <li><a href="stdlib.html#bufio">bufio ç¼“å†² I/O</a></li>
                        <li><a href="stdlib.html#exp">exp å®éªŒæ€§åº“</a></li>
                        <li><a href="stdlib.html#embed">embed æ–‡ä»¶åµŒå…¥</a></li>
                        <li><a href="stdlib.html#bestpractices">æœ€ä½³å®è·µ</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="tips.html" class="active"><span>ğŸ’¡ 11. å¸¸ç”¨æŠ€å·§ä¸æœ€ä½³å®è·µ</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="tips.html#idioms">æƒ¯ç”¨æ¨¡å¼</a></li>
                        <li><a href="tips.html#performance">æ€§èƒ½ä¼˜åŒ–</a></li>
                        <li><a href="tips.html#error">é”™è¯¯å¤„ç†</a></li>
                        <li><a href="tips.html#testing">æµ‹è¯•æŠ€å·§</a></li>
                        <li><a href="tips.html#debug">è°ƒè¯•æŠ€å·§</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="ecosystem.html"><span>ğŸŒ 12. ç¤¾åŒºåº“</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="ecosystem.html#gin">Gin Web æ¡†æ¶</a></li>
                        <li><a href="ecosystem.html#gorm">GORM ORM</a></li>
                        <li><a href="ecosystem.html#viper">Viper é…ç½®</a></li>
                        <li><a href="ecosystem.html#zap">Zap æ—¥å¿—</a></li>
                        <li><a href="ecosystem.html#validator">Validator å‚æ•°æ ¡éªŒ</a></li>
                        <li><a href="ecosystem.html#cobra">Cobra å‘½ä»¤è¡Œå·¥å…·</a></li>
                        <li><a href="ecosystem.html#gomicro">Go-Micro å¾®æœåŠ¡</a></li>
                        <li><a href="ecosystem.html#etcd">Etcd åˆ†å¸ƒå¼å­˜å‚¨</a></li>
                        <li><a href="ecosystem.html#protobuf">Protobuf æ•°æ®åºåˆ—åŒ–</a></li>
                        <li><a href="ecosystem.html#redis">Redis å®¢æˆ·ç«¯</a></li>
                        <li><a href="ecosystem.html#mysql">MySQL å®¢æˆ·ç«¯</a></li>
                        <li><a href="ecosystem.html#bestpractices">æœ€ä½³å®è·µ</a></li>
                    </ul>
                </li>

        </aside>
        <div class="content">
            <a href="index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
            <h1>å¸¸ç”¨æŠ€å·§ä¸æœ€ä½³å®è·µ</h1>

            <h2 id="idioms">æƒ¯ç”¨æ¨¡å¼</h2>

            <h3>1. é”™è¯¯å¤„ç†æœ€ä½³å®è·µ</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"errors"</span>
    <span class="string">"fmt"</span>
)

<span class="comment">// âœ… å¥½çš„åšæ³•ï¼šç«‹å³å¤„ç†é”™è¯¯</span>
<span class="function">func</span> <span class="function">goodErrorHandling</span>() <span class="keyword">error</span> {
    data, err := <span class="function">readData</span>()
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> fmt.<span class="function">Errorf</span>(<span class="string">"failed to read data: %w"</span>, err)
    }
    
    result, err := <span class="function">processData</span>(data)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> fmt.<span class="function">Errorf</span>(<span class="string">"failed to process data: %w"</span>, err)
    }
    
    <span class="keyword">return</span> <span class="function">saveResult</span>(result)
}

<span class="comment">// âŒ åçš„åšæ³•ï¼šå¿½ç•¥é”™è¯¯</span>
<span class="function">func</span> <span class="function">badErrorHandling</span>() {
    data, _ := <span class="function">readData</span>()  <span class="comment">// å¿½ç•¥é”™è¯¯</span>
    <span class="function">processData</span>(data)
}

<span class="comment">// âœ… ä½¿ç”¨ errors.Is å’Œ errors.As</span>
<span class="function">func</span> <span class="function">checkError</span>(err <span class="keyword">error</span>) {
    <span class="keyword">var</span> notFoundErr *NotFoundError
    <span class="keyword">if</span> errors.<span class="function">As</span>(err, &notFoundErr) {
        fmt.<span class="function">Println</span>(<span class="string">"Not found:"</span>, notFoundErr)
    }
    
    <span class="keyword">if</span> errors.<span class="function">Is</span>(err, ErrInvalidInput) {
        fmt.<span class="function">Println</span>(<span class="string">"Invalid input"</span>)
    }
}

<span class="comment">// âœ… è‡ªå®šä¹‰é”™è¯¯ç±»å‹</span>
<span class="keyword">type</span> ValidationError <span class="keyword">struct</span> {
    Field   <span class="keyword">string</span>
    Message <span class="keyword">string</span>
}

<span class="function">func</span> (e *ValidationError) <span class="function">Error</span>() <span class="keyword">string</span> {
    <span class="keyword">return</span> fmt.<span class="function">Sprintf</span>(<span class="string">"validation error on field %s: %s"</span>, e.Field, e.Message)
}

<span class="function">func</span> <span class="function">validate</span>(input <span class="keyword">string</span>) <span class="keyword">error</span> {
    <span class="keyword">if</span> input == <span class="string">""</span> {
        <span class="keyword">return</span> &ValidationError{
            Field:   <span class="string">"input"</span>,
            Message: <span class="string">"cannot be empty"</span>,
        }
    }
    <span class="keyword">return</span> <span class="keyword">nil</span>
}</code></pre>

            <h3>2. æ¥å£è®¾è®¡åŸåˆ™</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> <span class="string">"fmt"</span>

<span class="comment">// âœ… å¥½çš„åšæ³•ï¼šæ¥å£åº”è¯¥å°è€Œä¸“æ³¨</span>
<span class="keyword">type</span> Reader <span class="keyword">interface</span> {
    <span class="function">Read</span>(p []<span class="keyword">byte</span>) (<span class="keyword">n</span> <span class="keyword">int</span>, err <span class="keyword">error</span>)
}

<span class="keyword">type</span> Writer <span class="keyword">interface</span> {
    <span class="function">Write</span>(p []<span class="keyword">byte</span>) (<span class="keyword">n</span> <span class="keyword">int</span>, err <span class="keyword">error</span>)
}

<span class="keyword">type</span> ReadWriter <span class="keyword">interface</span> {
    Reader
    Writer
}

<span class="comment">// âŒ åçš„åšæ³•ï¼šæ¥å£å¤ªå¤§</span>
<span class="keyword">type</span> BadInterface <span class="keyword">interface</span> {
    <span class="function">Read</span>(p []<span class="keyword">byte</span>) (<span class="keyword">n</span> <span class="keyword">int</span>, err <span class="keyword">error</span>)
    <span class="function">Write</span>(p []<span class="keyword">byte</span>) (<span class="keyword">n</span> <span class="keyword">int</span>, err <span class="keyword">error</span>)
    <span class="function">Close</span>() <span class="keyword">error</span>
    <span class="function">Seek</span>(offset <span class="keyword">int64</span>, whence <span class="keyword">int</span>) (<span class="keyword">int64</span>, <span class="keyword">error</span>)
    <span class="comment">// ... æ›´å¤šæ–¹æ³•</span>
}

<span class="comment">// âœ… æ¥å—æ¥å£ï¼Œè¿”å›ç»“æ„ä½“</span>
<span class="function">func</span> <span class="function">processData</span>(r Reader) {
    data := <span class="function">make</span>([]<span class="keyword">byte</span>, <span class="number">1024</span>)
    r.<span class="function">Read</span>(data)
}

<span class="keyword">type</span> MyReader <span class="keyword">struct</span> {
    data []<span class="keyword">byte</span>
}

<span class="function">func</span> (m *MyReader) <span class="function">Read</span>(p []<span class="keyword">byte</span>) (<span class="keyword">n</span> <span class="keyword">int</span>, err <span class="keyword">error</span>) {
    <span class="comment">// å®ç°</span>
    <span class="keyword">return</span> <span class="number">0</span>, <span class="keyword">nil</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    reader := &MyReader{}
    <span class="function">processData</span>(reader)
}</code></pre>

            <h3>3. å¹¶å‘æ¨¡å¼</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
)

<span class="comment">// âœ… Worker Pool æ¨¡å¼</span>
<span class="keyword">type</span> WorkerPool <span class="keyword">struct</span> {
    tasks   <span class="keyword">chan</span> Task
    workers <span class="keyword">int</span>
    wg      sync.WaitGroup
}

<span class="keyword">type</span> Task <span class="keyword">struct</span> {
    ID   <span class="keyword">int</span>
    Data <span class="keyword">string</span>
}

<span class="function">func</span> <span class="function">NewWorkerPool</span>(workers <span class="keyword">int</span>) *WorkerPool {
    <span class="keyword">return</span> &WorkerPool{
        tasks:   <span class="function">make</span>(<span class="keyword">chan</span> Task, <span class="number">100</span>),
        workers: workers,
    }
}

<span class="function">func</span> (wp *WorkerPool) <span class="function">Start</span>() {
    <span class="keyword">for</span> i := <span class="number">0</span>; i < wp.workers; i++ {
        wp.wg.<span class="function">Add</span>(<span class="number">1</span>)
        <span class="keyword">go</span> wp.<span class="function">worker</span>(i)
    }
}

<span class="function">func</span> (wp *WorkerPool) <span class="function">worker</span>(id <span class="keyword">int</span>) {
    <span class="keyword">defer</span> wp.wg.<span class="function">Done</span>()
    <span class="keyword">for</span> task := <span class="keyword">range</span> wp.tasks {
        fmt.<span class="function">Printf</span>(<span class="string">"Worker %d processing task %d\n"</span>, id, task.ID)
    }
}

<span class="function">func</span> (wp *WorkerPool) <span class="function">Submit</span>(task Task) {
    wp.tasks <- task
}

<span class="function">func</span> (wp *WorkerPool) <span class="function">Stop</span>() {
    <span class="keyword">close</span>(wp.tasks)
    wp.wg.<span class="function">Wait</span>()
}

<span class="comment">// âœ… Context å–æ¶ˆæ¨¡å¼</span>
<span class="function">func</span> <span class="function">workerWithContext</span>(ctx context.Context, id <span class="keyword">int</span>) {
    <span class="keyword">for</span> {
        <span class="keyword">select</span> {
        <span class="keyword">case</span> <-ctx.<span class="function">Done</span>():
            fmt.<span class="function">Printf</span>(<span class="string">"Worker %d stopped\n"</span>, id)
            <span class="keyword">return</span>
        <span class="keyword">default</span>
            fmt.<span class="function">Printf</span>(<span class="string">"Worker %d working\n"</span>, id)
        }
    }
}

<span class="comment">// âœ… Fan-out/Fan-in æ¨¡å¼</span>
<span class="function">func</span> <span class="function">fanOut</span>(input <-<span class="keyword">chan</span> <span class="keyword">int</span>, workers <span class="keyword">int</span>) []<-<span class="keyword">chan</span> <span class="keyword">int</span> {
    outputs := <span class="function">make</span>([]<-<span class="keyword">chan</span> <span class="keyword">int</span>, workers)
    <span class="keyword">for</span> i := <span class="number">0</span>; i < workers; i++ {
        outputs[i] = <span class="function">worker</span>(input)
    }
    <span class="keyword">return</span> outputs
}

<span class="function">func</span> <span class="function">worker</span>(input <-<span class="keyword">chan</span> <span class="keyword">int</span>) <-<span class="keyword">chan</span> <span class="keyword">int</span> {
    output := <span class="function">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)
    <span class="keyword">go</span> <span class="keyword">func</span>() {
        <span class="keyword">defer</span> <span class="function">close</span>(output)
        <span class="keyword">for</span> v := <span class="keyword">range</span> input {
            output <- v * <span class="number">2</span>
        }
    }()
    <span class="keyword">return</span> output
}

<span class="function">func</span> <span class="function">fanIn</span>(inputs ...<-<span class="keyword">chan</span> <span class="keyword">int</span>) <-<span class="keyword">chan</span> <span class="keyword">int</span> {
    output := <span class="function">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)
    <span class="keyword">var</span> wg sync.WaitGroup
    
    <span class="keyword">for</span> _, input := <span class="keyword">range</span> inputs {
        wg.<span class="function">Add</span>(<span class="number">1</span>)
        <span class="keyword">go</span> <span class="keyword">func</span>(ch <-<span class="keyword">chan</span> <span class="keyword">int</span>) {
            <span class="keyword">defer</span> wg.<span class="function">Done</span>()
            <span class="keyword">for</span> v := <span class="keyword">range</span> ch {
                output <- v
            }
        }(input)
    }
    
    <span class="keyword">go</span> <span class="keyword">func</span>() {
        wg.<span class="function">Wait</span>()
        <span class="function">close</span>(output)
    }()
    
    <span class="keyword">return</span> output
}</code></pre>

            <h3>4. èµ„æºç®¡ç†</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"database/sql"</span>
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
)

<span class="comment">// âœ… ä½¿ç”¨ defer ç¡®ä¿èµ„æºé‡Šæ”¾</span>
<span class="function">func</span> <span class="function">processFile</span>(filename <span class="keyword">string</span>) <span class="keyword">error</span> {
    file, err := os.<span class="function">Open</span>(filename)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> file.<span class="function">Close</span>()
    
    <span class="comment">// å¤„ç†æ–‡ä»¶</span>
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="comment">// âœ… ä½¿ç”¨ defer å¤„ç†æ•°æ®åº“è¿æ¥</span>
<span class="function">func</span> <span class="function">queryDatabase</span>(db *sql.DB) <span class="keyword">error</span> {
    tx, err := db.<span class="function">Begin</span>()
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> <span class="keyword">func</span>() {
        <span class="keyword">if</span> p := <span class="function">recover</span>(); p != <span class="keyword">nil</span> {
            tx.<span class="function">Rollback</span>()
            <span class="function">panic</span>(p)
        } <span class="keyword">else if</span> err != <span class="keyword">nil</span> {
        tx.<span class="function">Rollback</span>()
    } <span class="keyword">else</span> {
        err = tx.<span class="function">Commit</span>()
    }
    }()
    
    <span class="comment">// æ‰§è¡ŒæŸ¥è¯¢</span>
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="comment">// âœ… ä½¿ç”¨ context æ§åˆ¶è¶…æ—¶</span>
<span class="function">func</span> <span class="function">fetchWithTimeout</span>(ctx context.Context, url <span class="keyword">string</span>) ([]<span class="keyword">byte</span>, <span class="keyword">error</span>) {
    <span class="comment">// ä½¿ç”¨ ctx æ§åˆ¶è¯·æ±‚è¶…æ—¶</span>
    <span class="keyword">return</span> <span class="keyword">nil</span>, <span class="keyword">nil</span>
}</code></pre>

            <h2 id="performance">æ€§èƒ½ä¼˜åŒ–</h2>

            <h3>1. å­—ç¬¦ä¸²å¤„ç†ä¼˜åŒ–</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"strings"</span>
)

<span class="comment">// âŒ åçš„åšæ³•ï¼šä½¿ç”¨ + æ‹¼æ¥å­—ç¬¦ä¸²</span>
<span class="function">func</span> <span class="function">badStringConcat</span>(parts []<span class="keyword">string</span>) <span class="keyword">string</span> {
    result := <span class="string">""</span>
    <span class="keyword">for</span> _, part := <span class="keyword">range</span> parts {
        result += part  <span class="comment">// æ¯æ¬¡éƒ½åˆ›å»ºæ–°å­—ç¬¦ä¸²</span>
    }
    <span class="keyword">return</span> result
}

<span class="comment">// âœ… å¥½çš„åšæ³•ï¼šä½¿ç”¨ strings.Builder</span>
<span class="function">func</span> <span class="function">goodStringConcat</span>(parts []<span class="keyword">string</span>) <span class="keyword">string</span> {
    <span class="keyword">var</span> builder strings.Builder
    builder.<span class="function">Grow</span>(<span class="number">1024</span>)  <span class="comment">// é¢„åˆ†é…ç©ºé—´</span>
    <span class="keyword">for</span> _, part := <span class="keyword">range</span> parts {
        builder.<span class="function">WriteString</span>(part)
    }
    <span class="keyword">return</span> builder.<span class="function">String</span>()
}

<span class="comment">// âœ… ä½¿ç”¨ fmt.Sprintf æ ¼å¼åŒ–</span>
<span class="function">func</span> <span class="function">formatString</span>(name <span class="keyword">string</span>, age <span class="keyword">int</span>) <span class="keyword">string</span> {
    <span class="keyword">return</span> fmt.<span class="function">Sprintf</span>(<span class="string">"Name: %s, Age: %d"</span>, name, age)
}</code></pre>

            <h3>2. åˆ‡ç‰‡å’Œæ˜ å°„ä¼˜åŒ–</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> <span class="string">"fmt"</span>

<span class="comment">// âœ… é¢„åˆ†é…åˆ‡ç‰‡å®¹é‡</span>
<span class="function">func</span> <span class="function">preallocateSlice</span>(size <span class="keyword">int</span>) []<span class="keyword">int</span> {
    slice := <span class="function">make</span>([]<span class="keyword">int</span>, <span class="number">0</span>, size)
    <span class="keyword">for</span> i := <span class="number">0</span>; i < size; i++ {
        slice = <span class="function">append</span>(slice, i)
    }
    <span class="keyword">return</span> slice
}

<span class="comment">// âœ… é¢„åˆ†é…æ˜ å°„å®¹é‡</span>
<span class="function">func</span> <span class="function">preallocateMap</span>(size <span class="keyword">int</span>) <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span> {
    m := <span class="function">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>, size)
    <span class="keyword">for</span> i := <span class="number">0</span>; i < size; i++ {
        m[fmt.<span class="function">Sprintf</span>(<span class="string">"key%d"</span>, i)] = i
    }
    <span class="keyword">return</span> m
}

<span class="comment">// âœ… é‡ç”¨åˆ‡ç‰‡</span>
<span class="function">func</span> <span class="function">reuseSlice</span>() {
    buf := <span class="function">make</span>([]<span class="keyword">byte</span>, <span class="number">0</span>, <span class="number">1024</span>)
    
    <span class="comment">// ä½¿ç”¨ buf</span>
    data := buf[:<span class="number">100</span>]
    
    <span class="comment">// é‡ç”¨</span>
    buf = buf[:<span class="number">0</span>]
    data = buf[:<span class="number">200</span>}
}</code></pre>

            <h3>3. å†…å­˜ä¼˜åŒ–</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
)

<span class="comment">// âœ… ä½¿ç”¨ sync.Pool é‡ç”¨å¯¹è±¡</span>
<span class="keyword">var</span> bufferPool = sync.<span class="function">Pool</span>{
    New: <span class="keyword">func</span>() <span class="keyword">interface</span>{} {
        <span class="keyword">return</span> <span class="function">make</span>([]<span class="keyword">byte</span>, <span class="number">0</span>, <span class="number">1024</span>)
    },
}

<span class="function">func</span> <span class="function">useBufferFromPool</span>() {
    buf := bufferPool.<span class="function">Get</span>().([]<span class="keyword">byte</span>)
    <span class="keyword">defer</span> <span class="keyword">func</span>() {
        buf = buf[:<span class="number">0</span>]
        bufferPool.<span class="function">Put</span>(buf)
    }()
    
    <span class="comment">// ä½¿ç”¨ buf</span>
}</code></pre>

            <h3>4. å‡å°‘å†…å­˜åˆ†é…</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"fmt"</span>
)

<span class="comment">// âœ… ä½¿ç”¨æŒ‡é’ˆé¿å…å€¼æ‹·è´</span>
<span class="keyword">type</span> LargeStruct <span class="keyword">struct</span> {
    Data [][<span class="number">1024</span>]<span class="keyword">byte</span>
}

<span class="function">func</span> <span class="function">processLarge</span>(data *LargeStruct) {
    <span class="comment">// å¤„ç†æ•°æ®</span>
}

<span class="comment">// âœ… é‡ç”¨ JSON è§£ç å™¨</span>
<span class="keyword">var</span> jsonDecoder = json.<span class="function">NewDecoder</span>(<span class="keyword">nil</span>)

<span class="function">func</span> <span class="function">decodeJSON</span>(data []<span class="keyword">byte</span>, v <span class="keyword">interface</span>{}) <span class="keyword">error</span> {
    decoder := json.<span class="function">NewDecoder</span>(bytes.<span class="function">NewReader</span>(data))
    <span class="keyword">return</span> decoder.<span class="function">Decode</span>(v)
}</code></pre>

            <h2 id="error">é”™è¯¯å¤„ç†</h2>

            <h3>1. é”™è¯¯åŒ…è£…</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
)

<span class="comment">// âœ… ä½¿ç”¨ fmt.Errorf åŒ…è£…é”™è¯¯</span>
<span class="function">func</span> <span class="function">readConfig</span>() <span class="keyword">error</span> {
    data, err := os.<span class="function">ReadFile</span>(<span class="string">"config.json"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> fmt.<span class="function">Errorf</span>(<span class="string">"failed to read config: %w"</span>, err)
    }
    <span class="keyword">return</span> <span class="function">parseConfig</span>(data)
}

<span class="function">func</span> <span class="function">parseConfig</span>(data []<span class="keyword">byte</span>) <span class="keyword">error</span> {
    <span class="keyword">if</span> <span class="function">len</span>(data) == <span class="number">0</span> {
        <span class="keyword">return</span> fmt.<span class="function">Errorf</span>(<span class="string">"config is empty: %w"</span>, ErrInvalidConfig)
    }
    <span class="keyword">return</span> <span class="keyword">nil</span>
}</code></pre>

            <h3>2. é”™è¯¯å€¼æ¯”è¾ƒ</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"errors"</span>
    <span class="string">"fmt"</span>
)

<span class="keyword">var</span> (
    ErrNotFound = errors.<span class="function">New</span>(<span class="string">"not found"</span>)
    ErrInvalid = errors.<span class="function">New</span>(<span class="string">"invalid input"</span>)
)

<span class="function">func</span> <span class="function">handleError</span>(err <span class="keyword">error</span>) {
    <span class="keyword">if</span> errors.<span class="function">Is</span>(err, ErrNotFound) {
        fmt.<span class="function">Println</span>(<span class="string">"Resource not found"</span>)
    } <span class="keyword">else if</span> errors.<span class="function">Is</span>(err, ErrInvalid) {
        fmt.<span class="function">Println</span>(<span class="string">"Invalid input"</span>)
    }
}</code></pre>

            <h2 id="testing">æµ‹è¯•æŠ€å·§</h2>

            <h3>1. è¡¨é©±åŠ¨æµ‹è¯•</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
)

<span class="keyword">type</span> testCase <span class="keyword">struct</span> {
    name     <span class="keyword">string</span>
    input    <span class="keyword">int</span>
    expected <span class="keyword">int</span>
}

<span class="keyword">var</span> testCases = []testCase{
    {<span class="string">"positive"</span>, <span class="number">1</span>, <span class="number">1</span>},
    {<span class="string">"zero"</span>, <span class="number">0</span>, <span class="number">0</span>},
    {<span class="string">"negative"</span>, -<span class="number">1</span>, -<span class="number">1</span>},
}

<span class="function">func</span> <span class="function">TestAbs</span>(t *testing.T) {
    <span class="keyword">for</span> _, tc := <span class="keyword">range</span> testCases {
        t.<span class="function">Run</span>(tc.name, <span class="keyword">func</span>(t *testing.T) {
            result := <span class="function">Abs</span>(tc.input)
            <span class="keyword">if</span> result != tc.expected {
                t.<span class="function">Errorf</span>(<span class="string">"expected %d, got %d"</span>, tc.expected, result)
            }
        })
    }
}</code></pre>

            <h3>2. æµ‹è¯•è¾…åŠ©å‡½æ•°</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
)

<span class="comment">// âœ… ä½¿ç”¨ setup å’Œ teardown</span>
<span class="function">func</span> <span class="function">TestWithSetup</span>(t *testing.T) {
    <span class="comment">// Setup</span>
    db := <span class="function">setupTestDB</span>(t)
    <span class="keyword">defer</span> <span class="function">teardownTestDB</span>(t, db)
    
    <span class="comment">// Test</span>
}

<span class="function">func</span> <span class="function">setupTestDB</span>(t *testing.T) *sql.DB {
    t.<span class="function">Helper</span>()
    <span class="comment">// åˆ›å»ºæµ‹è¯•æ•°æ®åº“</span>
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="function">func</span> <span class="function">teardownTestDB</span>(t *testing.T, db *sql.DB) {
    t.<span class="function">Helper</span>()
    <span class="comment">// æ¸…ç†æµ‹è¯•æ•°æ®åº“</span>
}</code></pre>

            <h3>3. åŸºå‡†æµ‹è¯•</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
)

<span class="function">func</span> <span class="function">BenchmarkStringConcat</span>(b *testing.B) {
    b.<span class="function">ResetTimer</span>()
    
    <span class="keyword">for</span> i := <span class="number">0</span>; i < b.N; i++ {
        <span class="function">concatenate</span>()
    }
}</code></pre>

            <h2 id="debug">è°ƒè¯•æŠ€å·§</h2>

            <h3>1. ä½¿ç”¨ pprof</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"log"</span>
    <span class="string">"net/http"</span>
    _ <span class="string">"net/http/pprof"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// å¯ç”¨ pprof</span>
    <span class="keyword">go</span> <span class="keyword">func</span>() {
        log.<span class="function">Println</span>(http.<span class="function">ListenAndServe</span>(<span class="string">":6060"</span>, <span class="keyword">nil</span>))
    }
    
    <span class="comment">// åº”ç”¨ç¨‹åºä»£ç </span>
}</code></pre>

            <h3>2. ä½¿ç”¨ race detector</h3>
            <pre><code><span class="comment">// è¿è¡Œæµ‹è¯•æ—¶å¯ç”¨ race detector</span>
<span class="comment">// go test -race ./...</span></code></pre>

            <h3>3. ä½¿ç”¨ trace</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"os"</span>
    <span class="string">"runtime/trace"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    f, _ := os.<span class="function">Create</span>(<span class="string">"trace.out"</span>)
    <span class="keyword">defer</span> f.<span class="function">Close</span>()
    
    trace.<span class="function">Start</span>(f, <span class="string">"trace"</span>)
    <span class="keyword">defer</span> trace.<span class="function">Stop</span>()
    
    <span class="comment">// åº”ç”¨ç¨‹åºä»£ç </span>
}</code></pre>

            <div class="note-box">
                <h3>Go è¯­è¨€æœ€ä½³å®è·µæ€»ç»“</h3>
                <ul>
                    <li><strong>é”™è¯¯å¤„ç†</strong>ï¼šç«‹å³å¤„ç†é”™è¯¯ï¼Œä½¿ç”¨ errors.Is å’Œ errors.As</li>
                    <li><strong>æ¥å£è®¾è®¡</strong>ï¼šæ¥å£åº”è¯¥å°è€Œä¸“æ³¨ï¼Œæ¥å—æ¥å£è¿”å›ç»“æ„ä½“</li>
                    <li><strong>å¹¶å‘æ¨¡å¼</strong>ï¼šä½¿ç”¨ Worker Poolã€Contextã€Fan-out/Fan-in</li>
                    <li><strong>èµ„æºç®¡ç†</strong>ï¼šä½¿ç”¨ defer ç¡®ä¿èµ„æºé‡Šæ”¾</li>
                    <li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šé¢„åˆ†é…å®¹é‡ã€ä½¿ç”¨ sync.Poolã€å‡å°‘å†…å­˜åˆ†é…</li>
                    <li><strong>æµ‹è¯•</strong>ï¼šè¡¨é©±åŠ¨æµ‹è¯•ã€setup/teardownã€åŸºå‡†æµ‹è¯•</li>
                    <li><strong>è°ƒè¯•</strong>ï¼šä½¿ç”¨ pprofã€race detectorã€trace</li>
                </ul>
            </div>

            <div class="example-box">
                <h3>å¸¸ç”¨å·¥å…·å’Œå‘½ä»¤</h3>
                <pre><code><span class="comment"># æ ¼å¼åŒ–ä»£ç </span>
<span class="keyword">go</span> fmt ./...

<span class="comment"># æ£€æŸ¥ä»£ç </span>
<span class="keyword">go</span> vet ./...

<span class="comment"># è¿è¡Œæµ‹è¯•</span>
<span class="keyword">go</span> test ./...

<span class="comment"># è¿è¡Œæµ‹è¯•å¹¶å¯ç”¨ race detector</span>
<span class="keyword">go</span> test -race ./...

<span class="comment"># è¿è¡ŒåŸºå‡†æµ‹è¯•</span>
<span class="keyword">go</span> test -bench=. -benchmem ./...

<span class="comment"># ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š</span>
<span class="keyword">go</span> test -cover ./...

<span class="comment"># ç”Ÿæˆä¾èµ–å›¾</span>
<span class="keyword">go</span> mod graph

<span class="comment"># æŸ¥çœ‹ä¾èµ–</span>
<span class="keyword">go</span> list -m all</span></code></pre>
            </div>
        </div>
    </div>
</body>
</html>