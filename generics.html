<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ³›å‹ - Go å­¦ä¹ æ•™ç¨‹</title>
    <link rel="stylesheet" href="styles.css">
    <script src="scroll.js"></script>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <h3>ğŸ“š å­¦ä¹ ç›®å½•</h3>
            <ul>
                <li><a href="index.html">ğŸ  é¦–é¡µ</a></li>
                <li>
                    <a href="introduction.html">ğŸ“– Go è¯­è¨€ç®€ä»‹</a>
                </li>
                <li>
                    <a href="basics.html">ğŸ”¤ åŸºç¡€è¯­æ³•</a>
                    <ul>
                        <li><a href="basics.html#variables">å˜é‡å£°æ˜</a></li>
                        <li><a href="basics.html#datatypes">æ•°æ®ç±»å‹</a></li>
                        <li><a href="basics.html#arrays">æ•°ç»„ä¸åˆ‡ç‰‡</a></li>
                        <li><a href="basics.html#maps">æ˜ å°„</a></li>
                        <li><a href="basics.html#go125">Go 1.25 æ–°ç‰¹æ€§</a></li>
                    </ul>
                </li>
                <li>
                    <a href="control-flow.html">ğŸ”„ æ§åˆ¶æµ</a>
                    <ul>
                        <li><a href="control-flow.html#if">if è¯­å¥</a></li>
                        <li><a href="control-flow.html#switch">switch è¯­å¥</a></li>
                        <li><a href="control-flow.html#for">for å¾ªç¯</a></li>
                        <li><a href="control-flow.html#defer">defer è¯­å¥</a></li>
                    </ul>
                </li>
                <li>
                    <a href="functions.html">âš¡ å‡½æ•°</a>
                    <ul>
                        <li><a href="functions.html#basic">åŸºæœ¬å‡½æ•°</a></li>
                        <li><a href="functions.html#multiple">å¤šè¿”å›å€¼</a></li>
                        <li><a href="functions.html#variadic">å¯å˜å‚æ•°</a></li>
                        <li><a href="functions.html#closure">é—­åŒ…</a></li>
                        <li><a href="functions.html#methods">æ–¹æ³•</a></li>
                    </ul>
                </li>
                <li>
                    <a href="structs.html">ğŸ—ï¸ ç»“æ„ä½“ä¸æ¥å£</a>
                    <ul>
                        <li><a href="structs.html#struct">ç»“æ„ä½“</a></li>
                        <li><a href="structs.html#nested">åµŒå¥—ç»“æ„ä½“</a></li>
                        <li><a href="structs.html#methods">ç»“æ„ä½“æ–¹æ³•</a></li>
                        <li><a href="structs.html#interface">æ¥å£</a></li>
                        <li><a href="structs.html#tags">ç»“æ„ä½“æ ‡ç­¾</a></li>
                    </ul>
                </li>
                <li>
                    <a href="concurrency.html">ğŸš€ å¹¶å‘ç¼–ç¨‹</a>
                    <ul>
                        <li><a href="concurrency.html#goroutine">Goroutine</a></li>
                        <li><a href="concurrency.html#channel">Channel</a></li>
                        <li><a href="concurrency.html#select">Select</a></li>
                        <li><a href="concurrency.html#mutex">äº’æ–¥é”</a></li>
                        <li><a href="concurrency.html#context">Context</a></li>
                    </ul>
                </li>
                <li>
                    <a href="generics.html" class="active">ğŸ§© æ³›å‹</a>
                    <ul>
                        <li><a href="generics.html#functions">æ³›å‹å‡½æ•°</a></li>
                        <li><a href="generics.html#types">æ³›å‹ç±»å‹</a></li>
                        <li><a href="generics.html#constraints">ç±»å‹çº¦æŸ</a></li>
                        <li><a href="generics.html#inference">ç±»å‹æ¨æ–­</a></li>
                    </ul>
                </li>
                <li>
                    <a href="reflection.html">ğŸ” åå°„</a>
                    <ul>
                        <li><a href="reflection.html#typevalue">Type å’Œ Value</a></li>
                        <li><a href="reflection.html#struct">ç»“æ„ä½“åå°„</a></li>
                        <li><a href="reflection.html#modify">ä¿®æ”¹å€¼</a></li>
                        <li><a href="reflection.html#methods">è°ƒç”¨æ–¹æ³•</a></li>
                        <li><a href="reflection.html#performance">æ€§èƒ½è€ƒè™‘</a></li>
                    </ul>
                </li>
            </ul>
        </aside>
        <div class="content">
            <a href="index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
            <h1>æ³›å‹ï¼ˆGenericsï¼‰</h1>

            <h2 id="intro">ä»€ä¹ˆæ˜¯æ³›å‹ï¼Ÿ</h2>
            <p>æ³›å‹æ˜¯ Go 1.18 å¼•å…¥çš„é‡è¦ç‰¹æ€§ï¼Œå…è®¸ç¼–å†™å¯ä»¥å¤„ç†å¤šç§ç±»å‹çš„ä»£ç ï¼Œè€Œä¸éœ€è¦ä¸ºæ¯ç§ç±»å‹é‡å¤ç¼–å†™ç›¸åŒçš„é€»è¾‘ã€‚æ³›å‹æé«˜äº†ä»£ç çš„å¤ç”¨æ€§å’Œç±»å‹å®‰å…¨æ€§ã€‚</p>

            <h2 id="functions">æ³›å‹å‡½æ•°</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> <span class="string">"fmt"</span>

<span class="comment">// æ³›å‹å‡½æ•°ï¼šä½¿ç”¨ç±»å‹å‚æ•°</span>
<span class="function">func</span> <span class="function">Min</span>[T <span class="keyword">cmp.Ordered</span>](x, y T) T {
    <span class="keyword">if</span> x < y {
        <span class="keyword">return</span> x
    }
    <span class="keyword">return</span> y
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ä½¿ç”¨æ•´æ•°</span>
    fmt.<span class="function">Println</span>(<span class="function">Min</span>(<span class="number">5</span>, <span class="number">3</span>))  <span class="comment">// 3</span>

    <span class="comment">// ä½¿ç”¨æµ®ç‚¹æ•°</span>
    fmt.<span class="function">Println</span>(<span class="function">Min</span>(<span class="number">3.14</span>, <span class="number">2.71</span>))  <span class="comment">// 2.71</span>

    <span class="comment">// ä½¿ç”¨å­—ç¬¦ä¸²</span>
    fmt.<span class="function">Println</span>(<span class="function">Min</span>(<span class="string">"apple"</span>, <span class="string">"banana"</span>))  <span class="comment">// apple</span>
}</code></pre>

            <h2 id="constraints">ç±»å‹çº¦æŸ</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> <span class="string">"fmt"</span>

<span class="comment">// è‡ªå®šä¹‰ç±»å‹çº¦æŸ</span>
<span class="keyword">type</span> Number <span class="keyword">interface</span> {
    <span class="keyword">int</span> | <span class="keyword">int64</span> | <span class="keyword">float64</span>
}

<span class="function">func</span> <span class="function">Sum</span>[T Number](numbers []T) T {
    <span class="keyword">var</span> total T
    <span class="keyword">for</span> _, num := <span class="keyword">range</span> numbers {
        total += num
    }
    <span class="keyword">return</span> total
}

<span class="function">func</span> <span class="function">main</span>() {
    ints := []<span class="keyword">int</span>{<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>}
    floats := []<span class="keyword">float64</span>{<span class="number">1.1</span>, <span class="number">2.2</span>, <span class="number">3.3</span>}

    fmt.<span class="function">Println</span>(<span class="string">"æ•´æ•°å’Œ:"</span>, <span class="function">Sum</span>(ints))
    fmt.<span class="function">Println</span>(<span class="string">"æµ®ç‚¹æ•°å’Œ:"</span>, <span class="function">Sum</span>(floats))
}</code></pre>

            <h2 id="types">æ³›å‹ç±»å‹</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> <span class="string">"fmt"</span>

<span class="comment">// æ³›å‹ç»“æ„ä½“</span>
<span class="keyword">type</span> Stack[T <span class="keyword">any</span>] <span class="keyword">struct</span> {
    items []T
}

<span class="function">func</span> (s *Stack[T]) <span class="function">Push</span>(item T) {
    s.items = <span class="function">append</span>(s.items, item)
}

<span class="function">func</span> (s *Stack[T]) <span class="function">Pop</span>() (T, <span class="keyword">bool</span>) {
    <span class="keyword">if</span> <span class="function">len</span>(s.items) == <span class="number">0</span> {
        <span class="keyword">var</span> zero T
        <span class="keyword">return</span> zero, <span class="keyword">false</span>
    }
    index := <span class="function">len</span>(s.items) - <span class="number">1</span>
    item := s.items[index]
    s.items = s.items[:index]
    <span class="keyword">return</span> item, <span class="keyword">true</span>
}

<span class="function">func</span> (s *Stack[T]) <span class="function">IsEmpty</span>() <span class="keyword">bool</span> {
    <span class="keyword">return</span> <span class="function">len</span>(s.items) == <span class="number">0</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// æ•´æ•°æ ˆ</span>
    intStack := Stack[<span class="keyword">int</span>]{}
    intStack.<span class="function">Push</span>(<span class="number">1</span>)
    intStack.<span class="function">Push</span>(<span class="number">2</span>)
    intStack.<span class="function">Push</span>(<span class="number">3</span>)

    <span class="keyword">for</span> !intStack.<span class="function">IsEmpty</span>() {
        val, _ := intStack.<span class="function">Pop</span>()
        fmt.<span class="function">Println</span>(<span class="string">"å¼¹å‡º:"</span>, val)
    }

    <span class="comment">// å­—ç¬¦ä¸²æ ˆ</span>
    strStack := Stack[<span class="keyword">string</span>]{}
    strStack.<span class="function">Push</span>(<span class="string">"Hello"</span>)
    strStack.<span class="function">Push</span>(<span class="string">"World"</span>)

    <span class="keyword">for</span> !strStack.<span class="function">IsEmpty</span>() {
        val, _ := strStack.<span class="function">Pop</span>()
        fmt.<span class="function">Println</span>(<span class="string">"å¼¹å‡º:"</span>, val)
    }
}</code></pre>

            <h2 id="interfaces">æ³›å‹æ¥å£</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> <span class="string">"fmt"</span>

<span class="comment">// æ³›å‹æ¥å£</span>
<span class="keyword">type</span> Container[T <span class="keyword">any</span>] <span class="keyword">interface</span> {
    <span class="function">Add</span>(item T)
    <span class="function">Get</span>(index <span class="keyword">int</span>) T
    <span class="function">Size</span>() <span class="keyword">int</span>
}

<span class="keyword">type</span> List[T <span class="keyword">any</span>] <span class="keyword">struct</span> {
    items []T
}

<span class="function">func</span> (l *List[T]) <span class="function">Add</span>(item T) {
    l.items = <span class="function">append</span>(l.items, item)
}

<span class="function">func</span> (l *List[T]) <span class="function">Get</span>(index <span class="keyword">int</span>) T {
    <span class="keyword">return</span> l.items[index]
}

<span class="function">func</span> (l *List[T]) <span class="function">Size</span>() <span class="keyword">int</span> {
    <span class="keyword">return</span> <span class="function">len</span>(l.items)
}

<span class="function">func</span> <span class="function">PrintContainer</span>[T <span class="keyword">any</span>](c Container[T]) {
    <span class="keyword">for</span> i := <span class="number">0</span>; i < c.<span class="function">Size</span>(); i++ {
        fmt.<span class="function">Println</span>(c.<span class="function">Get</span>(i))
    }
}

<span class="function">func</span> <span class="function">main</span>() {
    list := List[<span class="keyword">int</span>]{}
    list.<span class="function">Add</span>(<span class="number">10</span>)
    list.<span class="function">Add</span>(<span class="number">20</span>)
    list.<span class="function">Add</span>(<span class="number">30</span>)

    <span class="function">PrintContainer</span>(&list)
}</code></pre>

            <h2 id="methods">æ³›å‹æ–¹æ³•</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> <span class="string">"fmt"</span>

<span class="keyword">type</span> Processor <span class="keyword">struct</span> {
    name <span class="keyword">string</span>
}

<span class="comment">// æ³›å‹æ–¹æ³•</span>
<span class="function">func</span> (p Processor) <span class="function">Process</span>[T <span class="keyword">any</span>](items []T, fn <span class="function">func</span>(T) T) []T {
    result := <span class="function">make</span>([]T, <span class="function">len</span>(items))
    <span class="keyword">for</span> i, item := <span class="keyword">range</span> items {
        result[i] = fn(item)
    }
    <span class="keyword">return</span> result
}

<span class="function">func</span> <span class="function">main</span>() {
    processor := Processor{name: <span class="string">"MyProcessor"</span>}

    <span class="comment">// å¤„ç†æ•´æ•°</span>
    numbers := []<span class="keyword">int</span>{<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>}
    doubled := processor.<span class="function">Process</span>(numbers, <span class="function">func</span>(n <span class="keyword">int</span>) <span class="keyword">int</span> {
        <span class="keyword">return</span> n * <span class="number">2</span>
    })
    fmt.<span class="function">Println</span>(<span class="string">"åŠ å€:"</span>, doubled)

    <span class="comment">// å¤„ç†å­—ç¬¦ä¸²</span>
    words := []<span class="keyword">string</span>{<span class="string">"hello"</span>, <span class="string">"world"</span>}
    upper := processor.<span class="function">Process</span>(words, <span class="function">func</span>(s <span class="keyword">string</span>) <span class="keyword">string</span> {
        <span class="keyword">return</span> s + <span class="string">"!"</span>
    })
    fmt.<span class="function">Println</span>(<span class="string">"æ·»åŠ æ„Ÿå¹å·:"</span>, upper)
}</code></pre>

            <h2 id="inference">ç±»å‹æ¨æ–­</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> <span class="string">"fmt"</span>

<span class="function">func</span> <span class="function">Print</span>[T <span class="keyword">any</span>](value T) {
    fmt.<span class="function">Println</span>(value)
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ç±»å‹æ¨æ–­ï¼šç¼–è¯‘å™¨è‡ªåŠ¨æ¨æ–­ç±»å‹</span>
    <span class="function">Print</span>(<span class="number">42</span>)      <span class="comment">// T æ¨æ–­ä¸º int</span>
    <span class="function">Print</span>(<span class="string">"hello"</span>)  <span class="comment">// T æ¨æ–­ä¸º string</span>
    <span class="function">Print</span>(<span class="number">3.14</span>)     <span class="comment">// T æ¨æ–­ä¸º float64</span>

    <span class="comment">// æ˜¾å¼æŒ‡å®šç±»å‹</span>
    <span class="function">Print</span>[<span class="keyword">int</span>](<span class="number">100</span>)
}</code></pre>

            <h2 id="multiple">å¤šä¸ªç±»å‹å‚æ•°</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> <span class="string">"fmt"</span>

<span class="comment">// ä¸¤ä¸ªç±»å‹å‚æ•°</span>
<span class="function">func</span> <span class="function">Pair</span>[K, V <span class="keyword">any</span>](key K, value V) <span class="keyword">map</span>[K]V {
    <span class="keyword">return</span> <span class="keyword">map</span>[K]V{key: value}
}

<span class="comment">// ä¸‰ä¸ªç±»å‹å‚æ•°</span>
<span class="function">func</span> <span class="function">Transform</span>[T, U, V <span class="keyword">any</span>](t T, u U, fn <span class="function">func</span>(T, U) V) V {
    <span class="keyword">return</span> fn(t, u)
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ä½¿ç”¨ Pair</span>
    m := <span class="function">Pair</span>(<span class="string">"name"</span>, <span class="string">"Go"</span>)
    fmt.<span class="function">Println</span>(m)

    <span class="comment">// ä½¿ç”¨ Transform</span>
    result := <span class="function">Transform</span>(<span class="number">10</span>, <span class="number">5</span>, <span class="function">func</span>(a, b <span class="keyword">int</span>) <span class="keyword">int</span> {
        <span class="keyword">return</span> a + b
    })
    fmt.<span class="function">Println</span>(<span class="string">"ç»“æœ:"</span>, result)
}</code></pre>

            <h2 id="tilde">ä½¿ç”¨ ~ è¿›è¡Œç±»å‹çº¦æŸ</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> <span class="string">"fmt"</span>

<span class="comment">// ~ è¡¨ç¤ºåº•å±‚ç±»å‹</span>
<span class="keyword">type</span> Ordered <span class="keyword">interface</span> {
    ~<span class="keyword">int</span> | ~<span class="keyword">float64</span> | ~<span class="keyword">string</span>
}

<span class="keyword">type</span> MyInt <span class="keyword">int</span>
<span class="keyword">type</span> MyFloat <span class="keyword">float64</span>

<span class="function">func</span> <span class="function">Max</span>[T Ordered](a, b T) T {
    <span class="keyword">if</span> a > b {
        <span class="keyword">return</span> a
    }
    <span class="keyword">return</span> b
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// æ”¯æŒè‡ªå®šä¹‰ç±»å‹</span>
    var x, y MyInt = <span class="number">10</span>, <span class="number">20</span>
    fmt.<span class="function">Println</span>(<span class="function">Max</span>(x, y))

    var f1, f2 MyFloat = <span class="number">3.14</span>, <span class="number">2.71</span>
    fmt.<span class="function">Println</span>(<span class="function">Max</span>(f1, f2))
}</code></pre>

            <h2 id="bestpractices">æ³›å‹æœ€ä½³å®è·µ</h2>

            <div class="note-box">
                <h3>ä½•æ—¶ä½¿ç”¨æ³›å‹</h3>
                <ul>
                    <li>å½“éœ€è¦ä¸ºå¤šç§ç±»å‹å®ç°ç›¸åŒé€»è¾‘æ—¶</li>
                    <li>å½“ç±»å‹å®‰å…¨æ¯”ä»£ç ç®€æ´æ›´é‡è¦æ—¶</li>
                    <li>å½“éœ€è¦æ„å»ºé€šç”¨æ•°æ®ç»“æ„æ—¶ï¼ˆå¦‚æ ˆã€é˜Ÿåˆ—ã€æ ‘ç­‰ï¼‰</li>
                </ul>
            </div>

            <div class="example-box">
                <h3>ä½•æ—¶ä¸ä½¿ç”¨æ³›å‹</h3>
                <ul>
                    <li>å½“åªéœ€è¦å¤„ç†ä¸€ç§ç‰¹å®šç±»å‹æ—¶</li>
                    <li>å½“ä½¿ç”¨æ¥å£æ›´ç®€å•æ—¶</li>
                    <li>å½“æ³›å‹ä¼šè®©ä»£ç æ›´éš¾ç†è§£æ—¶</li>
                </ul>
            </div>

            <h2 id="example">å®é™…åº”ç”¨ç¤ºä¾‹ï¼šæ³›å‹ç¼“å­˜</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
    <span class="string">"time"</span>
)

<span class="keyword">type</span> CacheItem[T <span class="keyword">any</span>] <span class="keyword">struct</span> {
    value      T
    expiration time.Time
}

<span class="keyword">type</span> Cache[K <span class="keyword">comparable</span>, V <span class="keyword">any</span>] <span class="keyword">struct</span> {
    items <span class="keyword">map</span>[K]CacheItem[V]
    mu    sync.RWMutex
}

<span class="function">func</span> <span class="function">NewCache</span>[K <span class="keyword">comparable</span>, V <span class="keyword">any</span>() *Cache[K, V] {
    <span class="keyword">return</span> &Cache[K, V]{
        items: <span class="function">make</span>(<span class="keyword">map</span>[K]CacheItem[V]),
    }
}

<span class="function">func</span> (c *Cache[K, V]) <span class="function">Set</span>(key K, value V, ttl time.Duration) {
    c.mu.<span class="function">Lock</span>()
    <span class="keyword">defer</span> c.mu.<span class="function">Unlock</span>()

    c.items[key] = CacheItem[V]{
        value:      value,
        expiration: time.<span class="function">Now</span>().<span class="function">Add</span>(ttl),
    }
}

<span class="function">func</span> (c *Cache[K, V]) <span class="function">Get</span>(key K) (V, <span class="keyword">bool</span>) {
    c.mu.<span class="function">RLock</span>()
    <span class="keyword">defer</span> c.mu.<span class="function">RUnlock</span>()

    item, exists := c.items[key]
    <span class="keyword">if</span> !exists || time.<span class="function">Now</span>().<span class="function">After</span>(item.expiration) {
        <span class="keyword">var</span> zero V
        <span class="keyword">return</span> zero, <span class="keyword">false</span>
    }
    <span class="keyword">return</span> item.value, <span class="keyword">true</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// å­—ç¬¦ä¸²ç¼“å­˜</span>
    stringCache := <span class="function">NewCache</span>[<span class="keyword">string</span>, <span class="keyword">string</span>]()
    stringCache.<span class="function">Set</span>(<span class="string">"key1"</span>, <span class="string">"value1"</span>, <span class="number">10</span>*time.Second)
    val, ok := stringCache.<span class="function">Get</span>(<span class="string">"key1"</span>)
    fmt.<span class="function">Println</span>(<span class="string">"å­—ç¬¦ä¸²ç¼“å­˜:"</span>, val, ok)

    <span class="comment">// æ•´æ•°ç¼“å­˜</span>
    intCache := <span class="function">NewCache</span>[<span class="keyword">string</span>, <span class="keyword">int</span>]()
    intCache.<span class="function">Set</span>(<span class="string">"counter"</span>, <span class="number">42</span>, <span class="number">10</span>*time.Second)
    count, ok := intCache.<span class="function">Get</span>(<span class="string">"counter"</span>)
    fmt.<span class="function">Println</span>(<span class="string">"æ•´æ•°ç¼“å­˜:"</span>, count, ok)
}</code></pre>
        </div>
    </div>
</body>
</html>