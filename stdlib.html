<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¸¸ç”¨æ ‡å‡†åº“ - Go å­¦ä¹ æ•™ç¨‹</title>
    <link rel="stylesheet" href="styles.css?v=1.4">
    <script src="scroll.js"></script>
    </head>
<body>
    <div class="container">
        <aside class="sidebar">
        <!-- å¯¼èˆªæ å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
    </aside>
        <div class="content">
            <a href="index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
            <h1>å¸¸ç”¨æ ‡å‡†åº“</h1>
            <p class="intro">Go è¯­è¨€æ ‡å‡†åº“åŠŸèƒ½ä¸°å¯Œï¼Œè¦†ç›–äº†ç½‘ç»œã€æ–‡ä»¶ã€åŠ å¯†ã€æ–‡æœ¬å¤„ç†ç­‰å¸¸ç”¨åœºæ™¯ã€‚</p>

            <div class="feature-grid">
                <div class="feature-card">
                    <div class="icon">ğŸ“</div>
                    <h4>fmt</h4>
                    <p>æ ¼å¼åŒ– I/O</p>
                </div>
                <div class="feature-card">
                    <div class="icon">ğŸŒ</div>
                    <h4>net/http</h4>
                    <p>HTTP æœåŠ¡ä¸å®¢æˆ·ç«¯</p>
                </div>
                <div class="feature-card">
                    <div class="icon">ğŸ”„</div>
                    <h4>encoding/json</h4>
                    <p>JSON åºåˆ—åŒ–</p>
                </div>
                <div class="feature-card">
                    <div class="icon">ğŸ“…</div>
                    <h4>time</h4>
                    <p>æ—¶é—´å¤„ç†</p>
                </div>
                <div class="feature-card">
                    <div class="icon">ğŸ”</div>
                    <h4>regexp</h4>
                    <p>æ­£åˆ™è¡¨è¾¾å¼</p>
                </div>
                <div class="feature-card">
                    <div class="icon">ğŸ”’</div>
                    <h4>crypto</h4>
                    <p>åŠ å¯†åŠŸèƒ½</p>
                </div>
            </div>

            <h2 id="regexp">regexp æ­£åˆ™è¡¨è¾¾å¼</h2>
            
            <h3>åŸºç¡€åŒ¹é…</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"regexp"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼</span>
    re := regexp.<span class="function">MustCompile</span>(<span class="string">`Hello`</span>)
    
    <span class="comment">// åŒ¹é…å­—ç¬¦ä¸²</span>
    text := <span class="string">"Hello, World!"</span>
    matched := re.<span class="function">MatchString</span>(text)
    fmt.<span class="function">Println</span>(<span class="string">"Matched:"</span>, matched)
    
    <span class="comment">// æŸ¥æ‰¾åŒ¹é…</span>
    loc := re.<span class="function">FindStringIndex</span>(text)
    fmt.<span class="function">Println</span>(<span class="string">"Location:"</span>, loc)
}</code></pre>

            <h3>æ•è·ç»„</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"regexp"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ä½¿ç”¨æ•è·ç»„</span>
    re := regexp.<span class="function">MustCompile</span>(<span class="string">`(\w+)\s+(\w+)`</span>)
    
    text := <span class="string">"Hello World"</span>
    matches := re.<span class="function">FindStringSubmatch</span>(text)
    
    fmt.<span class="function">Println</span>(<span class="string">"Full match:"</span>, matches[<span class="number">0</span>])
    fmt.<span class="function">Println</span>(<span class="string">"Group 1:"</span>, matches[<span class="number">1</span>])
    fmt.<span class="function">Println</span>(<span class="string">"Group 2:"</span>, matches[<span class="number">2</span>])
}</code></pre>

            <h3>æ›¿æ¢</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"regexp"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ç®€å•æ›¿æ¢</span>
    re := regexp.<span class="function">MustCompile</span>(<span class="string">`Hello`</span>)
    result := re.<span class="function">ReplaceAllString</span>(<span class="string">"Hello World"</span>, <span class="string">"Hi"</span>)
    fmt.<span class="function">Println</span>(result)
    
    <span class="comment">// ä½¿ç”¨æ•è·ç»„æ›¿æ¢</span>
    re2 := regexp.<span class="function">MustCompile</span>(<span class="string">`(\w+)\s+(\w+)`</span>)
    result2 := re2.<span class="function">ReplaceAllString</span>(<span class="string">"Hello World"</span>, <span class="string">"$2 $1"</span>)
    fmt.<span class="function">Println</span>(result2)
    
    <span class="comment">// ä½¿ç”¨å‡½æ•°æ›¿æ¢</span>
    result3 := re2.<span class="function">ReplaceAllStringFunc</span>(<span class="string">"Hello World"</span>, <span class="keyword">func</span>(s <span class="keyword">string</span>) <span class="keyword">string</span> {
        <span class="keyword">return</span> <span class="string">"REPLACED"</span>
    })
    fmt.<span class="Function">Println</span>(result3)
}</code></pre>

            <h3>æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"regexp"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…</span>
    re := regexp.<span class="function">MustCompile</span>(<span class="string">`\d+`</span>)
    text := <span class="string">"I have 2 apples and 3 oranges"</span>
    
    matches := re.<span class="function">FindAllString</span>(text, -<span class="number">1</span>)
    fmt.<span class="function">Println</span>(<span class="string">"All matches:"</span>, matches)
    
    <span class="comment">// æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…åŠå…¶ä½ç½®</span>
    matchesWithPos := re.<span class="function">FindAllStringIndex</span>(text, -<span class="number">1</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Matches with positions:"</span>, matchesWithPos)
    
    <span class="comment">// æŸ¥æ‰¾æ‰€æœ‰å­åŒ¹é…</span>
    re2 := regexp.<span class="function">MustCompile</span>(<span class="string">`(\w+)\s+(\w+)`</span>)
    submatches := re2.<span class="function">FindAllStringSubmatch</span>(text, -<span class="number">1</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Submatches:"</span>, submatches)
}</code></pre>

            <h3>å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"regexp"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// éªŒè¯é‚®ç®±</span>
    emailRe := regexp.<span class="function">MustCompile</span>(<span class="string">`^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$`</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Valid email:"</span>, emailRe.<span class="function">MatchString</span>(<span class="string">"user@example.com"</span>))
    
    <span class="comment">// éªŒè¯ URL</span>
    urlRe := regexp.<span class="function">MustCompile</span>(<span class="string">`^https?://[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}`</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Valid URL:"</span>, urlRe.<span class="function">MatchString</span>(<span class="string">"https://example.com"</span>))
    
    <span class="comment">// éªŒè¯æ‰‹æœºå·ï¼ˆä¸­å›½ï¼‰</span>
    phoneRe := regexp.<span class="function">MustCompile</span>(<span class="string">`^1[3-9]\d{9}$`</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Valid phone:"</span>, phoneRe.<span class="function">MatchString</span>(<span class="string">"13800138000"</span>))
    
    <span class="comment">// æå– HTML æ ‡ç­¾å†…å®¹</span>
    htmlRe := regexp.<span class="function">MustCompile</span>(<span class="string">`<[^>]+>([^<]+)</[^>]+>`</span>)
    html := <span class="string">"<p>Hello</p><div>World</div>"</span>
    tags := htmlRe.<span class="function">FindAllStringSubmatch</span>(html, -<span class="number">1</span>)
    <span class="keyword">for</span> _, tag := <span class="keyword">range</span> tags {
        fmt.<span class="function">Println</span>(<span class="string">"Tag content:"</span>, tag[<span class="number">1</span>])
    }
}</code></pre>

            <h2 id="sync">sync å¹¶å‘åŸè¯­</h2>

            <h3>Mutex äº’æ–¥é”</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
)

<span class="keyword">type</span> Counter <span class="keyword">struct</span> {
    mu    sync.Mutex
    value <span class="keyword">int</span>
}

<span class="function">func</span> (c *Counter) <span class="function">Increment</span>() {
    c.mu.<span class="function">Lock</span>()
    <span class="keyword">defer</span> c.mu.<span class="function">Unlock</span>()
    c.value++
}

<span class="function">func</span> (c *Counter) <span class="function">Value</span>() <span class="keyword">int</span> {
    c.mu.<span class="function">Lock</span>()
    <span class="keyword">defer</span> c.mu.<span class="function">Unlock</span>()
    <span class="keyword">return</span> c.value
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="keyword">var</span> counter Counter
    <span class="keyword">var</span> wg sync.WaitGroup
    
    <span class="keyword">for</span> i := <span class="number">0</span>; i < <span class="number">1000</span>; i++ {
        wg.<span class="function">Add</span>(<span class="number">1</span>)
        <span class="keyword">go</span> <span class="keyword">func</span>() {
            <span class="keyword">defer</span> wg.<span class="function">Done</span>()
            counter.<span class="function">Increment</span>()
        }()
    }
    
    wg.<span class="function">Wait</span>()
    fmt.<span class="function">Println</span>(<span class="string">"Final value:"</span>, counter.<span class="function">Value</span>())
}</code></pre>

            <h3>RWMutex è¯»å†™é”</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
    <span class="string">"time"</span>
)

<span class="keyword">type</span> Cache <span class="keyword">struct</span> {
    mu    sync.RWMutex
    data  <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>
}

<span class="function">func</span> <span class="function">NewCache</span>() *Cache {
    <span class="keyword">return</span> &Cache{
        data: <span class="function">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>),
    }
}

<span class="function">func</span> (c *Cache) <span class="function">Get</span>(key <span class="keyword">string</span>) (<span class="keyword">string</span>, <span class="keyword">bool</span>) {
    c.mu.<span class="function">RLock</span>()
    <span class="keyword">defer</span> c.mu.<span class="function">RUnlock</span>()
    val, ok := c.data[key]
    <span class="keyword">return</span> val, ok
}

<span class="function">func</span> (c *Cache) <span class="function">Set</span>(key, value <span class="keyword">string</span>) {
    c.mu.<span class="function">Lock</span>()
    <span class="keyword">defer</span> c.mu.<span class="function">Unlock</span>()
    c.data[key] = value
}

<span class="function">func</span> <span class="function">main</span>() {
    cache := <span class="function">NewCache</span>()
    <span class="keyword">var</span> wg sync.WaitGroup
    
    <span class="comment">// å†™å…¥</span>
    <span class="keyword">for</span> i := <span class="number">0</span>; i < <span class="number">10</span>; i++ {
        wg.<span class="function">Add</span>(<span class="number">1</span>)
        <span class="keyword">go</span> <span class="keyword">func</span>(i <span class="keyword">int</span>) {
            <span class="keyword">defer</span> wg.<span class="function">Done</span>()
            key := fmt.<span class="function">Sprintf</span>(<span class="string">"key%d"</span>, i)
            value := fmt.<span class="function">Sprintf</span>(<span class="string">"value%d"</span>, i)
            cache.<span class="function">Set</span>(key, value)
        }(i)
    }
    
    <span class="comment">// è¯»å–</span>
    <span class="keyword">for</span> i := <span class="number">0</span>; i < <span class="number">10</span>; i++ {
        wg.<span class="function">Add</span>(<span class="number">1</span>)
        <span class="keyword">go</span> <span class="keyword">func</span>(i <span class="keyword">int</span>) {
            <span class="keyword">defer</span> wg.<span class="function">Done</span>()
            key := fmt.<span class="function">Sprintf</span>(<span class="string">"key%d"</span>, i)
            time.<span class="function">Sleep</span>(time.Millisecond)
            val, ok := cache.<span class="function">Get</span>(key)
            fmt.<span class="function">Printf</span>(<span class="string">"Get %s: %v, %v\n"</span>, key, val, ok)
        }(i)
    }
    
    wg.<span class="function">Wait</span>()
}</code></pre>

            <h3>WaitGroup ç­‰å¾…ç»„</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
)

<span class="function">func</span> <span class="function">worker</span>(id <span class="keyword">int</span>, wg *sync.WaitGroup) {
    <span class="keyword">defer</span> wg.<span class="function">Done</span>()
    fmt.<span class="function">Printf</span>(<span class="string">"Worker %d started\n"</span>, id)
    fmt.<span class="function">Printf</span>(<span class="string">"Worker %d finished\n"</span>, id)
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="keyword">var</span> wg sync.WaitGroup
    
    <span class="keyword">for</span> i := <span class="number">1</span>; i <= <span class="number">5</span>; i++ {
        wg.<span class="function">Add</span>(<span class="number">1</span>)
        <span class="keyword">go</span> <span class="function">worker</span>(i, &wg)
    }
    
    wg.<span class="function">Wait</span>()
    fmt.<span class="function">Println</span>(<span class="string">"All workers finished"</span>)
}</code></pre>

            <h3>Once å•æ¬¡æ‰§è¡Œ</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
)

<span class="keyword">var</span> (
    once     sync.Once
    instance *Singleton
)

<span class="keyword">type</span> Singleton <span class="keyword">struct</span> {
    value <span class="keyword">string</span>
}

<span class="function">func</span> <span class="function">GetInstance</span>() *Singleton {
    once.<span class="function">Do</span>(<span class="keyword">func</span>() {
        instance = &Singleton{value: <span class="string">"initialized"</span>}
        fmt.<span class="function">Println</span>(<span class="string">"Singleton initialized"</span>)
    })
    <span class="keyword">return</span> instance
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// å¤šæ¬¡è°ƒç”¨åªä¼šåˆå§‹åŒ–ä¸€æ¬¡</span>
    <span class="function">GetInstance</span>()
    <span class="function">GetInstance</span>()
    <span class="function">GetInstance</span>()
}</code></pre>

            <h3>Cond æ¡ä»¶å˜é‡</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
    <span class="string">"time"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="keyword">var</span> mu sync.Mutex
    cond := sync.<span class="function">NewCond</span>(&mu)
    ready := <span class="keyword">false</span>
    
    <span class="comment">// ç­‰å¾…è€…</span>
    <span class="keyword">go</span> <span class="keyword">func</span>() {
        mu.<span class="function">Lock</span>()
        <span class="keyword">for</span> !ready {
            fmt.<span class="function">Println</span>(<span class="string">"Waiting..."</span>)
            cond.<span class="function">Wait</span>()
        }
        fmt.<span class="function">Println</span>(<span class="string">"Ready!"</span>)
        mu.<span class="function">Unlock</span>()
    }()
    
    time.<span class="function">Sleep</span>(time.Second)
    
    <span class="comment">// é€šçŸ¥è€…</span>
    mu.<span class="function">Lock</span>()
    ready = <span class="keyword">true</span>
    fmt.<span class="function">Println</span>(<span class="string">"Signaling..."</span>)
    cond.<span class="function">Signal</span>()
    mu.<span class="function">Unlock</span>()
    
    time.<span class="function">Sleep</span>(time.Second)
}</code></pre>

            <h3>Pool å¯¹è±¡æ± </h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"bytes"</span>
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
)

<span class="keyword">var</span> bufferPool = sync.<span class="function">Pool</span>{
    New: <span class="keyword">func</span>() <span class="keyword">interface</span>{} {
        fmt.<span class="function">Println</span>(<span class="string">"Creating new buffer"</span>)
        <span class="keyword">return</span> &bytes.Buffer{}
    },
}

<span class="function">func</span> <span class="function">process</span>() {
    <span class="comment">// ä»æ± ä¸­è·å–</span>
    buf := bufferPool.<span class="function">Get</span>().(*bytes.Buffer)
    <span class="keyword">defer</span> <span class="keyword">func</span>() {
        <span class="comment">// é‡ç½®å¹¶æ”¾å›æ± ä¸­</span>
        buf.<span class="function">Reset</span>()
        bufferPool.<span class="function">Put</span>(buf)
    }()
    
    buf.<span class="function">WriteString</span>(<span class="string">"Hello, World!"</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Buffer:"</span>, buf.<span class="function">String</span>())
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="keyword">for</span> i := <span class="number">0</span>; i < <span class="number">5</span>; i++ {
        <span class="function">process</span>()
    }
}</code></pre>

            <h3>Map å¹¶å‘å®‰å…¨æ˜ å°„</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="keyword">var</span> m sync.Map
    
    <span class="comment">// å­˜å‚¨</span>
    m.<span class="function">Store</span>(<span class="string">"key1"</span>, <span class="string">"value1"</span>)
    m.<span class="function">Store</span>(<span class="string">"key2"</span>, <span class="string">"value2"</span>)
    
    <span class="comment">// åŠ è½½</span>
    <span class="keyword">if</span> val, ok := m.<span class="function">Load</span>(<span class="string">"key1"</span>); ok {
        fmt.<span class="function">Println</span>(<span class="string">"key1:"</span>, val)
    }
    
    <span class="comment">// åŠ è½½æˆ–å­˜å‚¨</span>
    actual, loaded := m.<span class="function">LoadOrStore</span>(<span class="string">"key3"</span>, <span class="string">"value3"</span>)
    fmt.<span class="function">Printf</span>(<span class="string">"key3: %v, loaded: %v\n"</span>, actual, loaded)
    
    <span class="comment">// éå†</span>
    m.<span class="function">Range</span>(<span class="keyword">func</span>(key, value <span class="keyword">interface</span>{}) <span class="keyword">bool</span> {
        fmt.<span class="function">Printf</span>(<span class="string">"%s: %s\n"</span>, key, value)
        <span class="keyword">return</span> <span class="keyword">true</span>
    })
    
    <span class="comment">// åˆ é™¤</span>
    m.<span class="function">Delete</span>(<span class="string">"key1"</span>)
}</code></pre>

            <h3>Atomic åŸå­æ“ä½œ</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync/atomic"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="keyword">var</span> counter int64
    
    <span class="comment">// åŸå­å¢åŠ </span>
    atomic.<span class="function">AddInt64</span>(&counter, <span class="number">1</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Counter:"</span>, counter)
    
    <span class="comment">// åŸå­åŠ è½½</span>
    value := atomic.<span class="function">LoadInt64</span>(&counter)
    fmt.<span class="function">Println</span>(<span class="string">"Loaded:"</span>, value)
    
    <span class="comment">// åŸå­å­˜å‚¨</span>
    atomic.<span class="function">StoreInt64</span>(&counter, <span class="number">100</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Stored:"</span>, atomic.<span class="function">LoadInt64</span>(&counter))
    
    <span class="comment">// åŸå­æ¯”è¾ƒå¹¶äº¤æ¢</span>
    swapped := atomic.<span class="function">CompareAndSwapInt64</span>(&counter, <span class="number">100</span>, <span class="number">200</span>)
    fmt.<span class="function">Printf</span>(<span class="string">"Swapped: %v, Value: %d\n"</span>, swapped, atomic.<span class="function">LoadInt64</span>(&counter))
}</code></pre>

            <h2 id="json">json æ•°æ®ç¼–ç </h2>

            <h3>åŸºæœ¬ç¼–ç å’Œè§£ç </h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"fmt"</span>
)

<span class="keyword">type</span> Person <span class="keyword">struct</span> {
    Name  <span class="keyword">string</span> <span class="string">`json:"name"`</span>
    Age   <span class="keyword">int</span>    <span class="string">`json:"age"`</span>
    Email <span class="keyword">string</span> <span class="string">`json:"email,omitempty"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ç¼–ç </span>
    person := Person{
        Name: <span class="string">"Alice"</span>,
        Age:  <span class="number">30</span>,
    }
    
    jsonData, err := json.<span class="function">Marshal</span>(person)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    fmt.<span class="function">Println</span>(<span class="string">"JSON:"</span>, <span class="keyword">string</span>(jsonData))
    
    <span class="comment">// è§£ç </span>
    <span class="keyword">var</span> decoded Person
    err = json.<span class="function">Unmarshal</span>(jsonData, &decoded)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    fmt.<span class="function">Printf</span>(<span class="string">"Decoded: %+v\n"</span>, decoded)
}</code></pre>

            <h3>å¤„ç†åµŒå¥—ç»“æ„</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"fmt"</span>
)

<span class="keyword">type</span> Address <span class="keyword">struct</span> {
    City    <span class="keyword">string</span> <span class="string">`json:"city"`</span>
    Country <span class="keyword">string</span> <span class="string">`json:"country"`</span>
}

<span class="keyword">type</span> User <span class="keyword">struct</span> {
    Name    <span class="keyword">string</span>  <span class="string">`json:"name"`</span>
    Age     <span class="keyword">int</span>     <span class="string">`json:"age"`</span>
    Address Address  <span class="string">`json:"address"`</span>
    Tags    []<span class="keyword">string</span> <span class="string">`json:"tags"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    jsonData := []<span class="keyword">byte</span>(<span class="string">`{
        "name": "Bob",
        "age": 25,
        "address": {
            "city": "Beijing",
            "country": "China"
        },
        "tags": ["developer", "golang"]
    }`</span>)
    
    <span class="keyword">var</span> user User
    err := json.<span class="function">Unmarshal</span>(jsonData, &user)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    
    fmt.<span class="function">Printf</span>(<span class="string">"User: %+v\n"</span>, user)
    fmt.<span class="function">Printf</span>(<span class="string">"Address: %+v\n"</span>, user.Address)
    fmt.<span class="function">Printf</span>(<span class="string">"Tags: %v\n"</span>, user.Tags)
}</code></pre>

            <h3>ä½¿ç”¨ map å’Œ interface</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"fmt"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// è§£ç åˆ° map</span>
    jsonData := []<span class="keyword">byte</span>(<span class="string">`{"name": "Charlie", "age": 35}`</span>)
    <span class="keyword">var</span> data <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>{}, ok := m.data[key]
    <span class="keyword">return</span> val, ok
}

<span class="function">func</span> (c *Cache) <span class="function">Set</span>(key, value <span class="keyword">string</span>) {
    c.mu.<span class="function">Lock</span>()
    <span class="keyword">defer</span> c.mu.<span class="function">Unlock</span>()
    c.data[key] = value
}

<span class="function">func</span> <span class="function">main</span>() {
    cache := <span class="function">NewCache</span>()
    <span class="keyword">var</span> wg sync.WaitGroup
    
    <span class="comment">// å†™å…¥</span>
    <span class="keyword">for</span> i := <span class="number">0</span>; i < <span class="number">10</span>; i++ {
        wg.<span class="function">Add</span>(<span class="number">1</span>)
        <span class="keyword">go</span> <span class="keyword">func</span>(i <span class="keyword">int</span>) {
            <span class="keyword">defer</span> wg.<span class="function">Done</span>()
            key := fmt.<span class="function">Sprintf</span>(<span class="string">"key%d"</span>, i)
            value := fmt.<span class="function">Sprintf</span>(<span class="string">"value%d"</span>, i)
            cache.<span class="function">Set</span>(key, value)
        }(i)
    }
    
    <span class="comment">// è¯»å–</span>
    <span class="keyword">for</span> i := <span class="number">0</span>; i < <span class="number">10</span>; i++ {
        wg.<span class="function">Add</span>(<span class="number">1</span>)
        <span class="keyword">go</span> <span class="keyword">func</span>(i <span class="keyword">int</span>) {
            <span class="keyword">defer</span> wg.<span class="function">Done</span>()
            key := fmt.<span class="function">Sprintf</span>(<span class="string">"key%d"</span>, i)
            time.<span class="function">Sleep</span>(time.Millisecond)
            val, ok := cache.<span class="function">Get</span>(key)
            fmt.<span class="function">Printf</span>(<span class="string">"Get %s: %v, %v\n"</span>, key, val, ok)
        }(i)
    }
    
    wg.<span class="function">Wait</span>()
}</code></pre>

            <h3>WaitGroup ç­‰å¾…ç»„</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
)

<span class="function">func</span> <span class="function">worker</span>(id <span class="keyword">int</span>, wg *sync.WaitGroup) {
    <span class="keyword">defer</span> wg.<span class="function">Done</span>()
    fmt.<span class="function">Printf</span>(<span class="string">"Worker %d started\n"</span>, id)
    fmt.<span class="function">Printf</span>(<span class="string">"Worker %d finished\n"</span>, id)
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="keyword">var</span> wg sync.WaitGroup
    
    <span class="keyword">for</span> i := <span class="number">1</span>; i <= <span class="number">5</span>; i++ {
        wg.<span class="function">Add</span>(<span class="number">1</span>)
        <span class="keyword">go</span> <span class="function">worker</span>(i, &wg)
    }
    
    wg.<span class="function">Wait</span>()
    fmt.<span class="function">Println</span>(<span class="string">"All workers finished"</span>)
}</code></pre>

            <h3>Once å•æ¬¡æ‰§è¡Œ</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
)

<span class="keyword">var</span> (
    once     sync.Once
    instance *Singleton
)

<span class="keyword">type</span> Singleton <span class="keyword">struct</span> {
    value <span class="keyword">string</span>
}

<span class="function">func</span> <span class="function">GetInstance</span>() *Singleton {
    once.<span class="function">Do</span>(<span class="keyword">func</span>() {
        instance = &Singleton{value: <span class="string">"initialized"</span>}
        fmt.<span class="function">Println</span>(<span class="string">"Singleton initialized"</span>)
    })
    <span class="keyword">return</span> instance
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// å¤šæ¬¡è°ƒç”¨åªä¼šåˆå§‹åŒ–ä¸€æ¬¡</span>
    <span class="function">GetInstance</span>()
    <span class="function">GetInstance</span>()
    <span class="function">GetInstance</span>()
}</code></pre>

            <h3>Cond æ¡ä»¶å˜é‡</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
    <span class="string">"time"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="keyword">var</span> mu sync.Mutex
    cond := sync.<span class="function">NewCond</span>(&mu)
    ready := <span class="keyword">false</span>
    
    <span class="comment">// ç­‰å¾…è€…</span>
    <span class="keyword">go</span> <span class="keyword">func</span>() {
        mu.<span class="function">Lock</span>()
        <span class="keyword">for</span> !ready {
            fmt.<span class="function">Println</span>(<span class="string">"Waiting..."</span>)
            cond.<span class="function">Wait</span>()
        }
        fmt.<span class="function">Println</span>(<span class="string">"Ready!"</span>)
        mu.<span class="function">Unlock</span>()
    }()
    
    time.<span class="function">Sleep</span>(time.Second)
    
    <span class="comment">// é€šçŸ¥è€…</span>
    mu.<span class="function">Lock</span>()
    ready = <span class="keyword">true</span>
    fmt.<span class="function">Println</span>(<span class="string">"Signaling..."</span>)
    cond.<span class="function">Signal</span>()
    mu.<span class="function">Unlock</span>()
    
    time.<span class="function">Sleep</span>(time.Second)
}</code></pre>

            <h3>Pool å¯¹è±¡æ± </h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"bytes"</span>
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
)

<span class="keyword">var</span> bufferPool = sync.<span class="function">Pool</span>{
    New: <span class="keyword">func</span>() <span class="keyword">interface</span>{} {
        fmt.<span class="function">Println</span>(<span class="string">"Creating new buffer"</span>)
        <span class="keyword">return</span> &bytes.Buffer{}
    },
}

<span class="function">func</span> <span class="function">process</span>() {
    <span class="comment">// ä»æ± ä¸­è·å–</span>
    buf := bufferPool.<span class="function">Get</span>().(*bytes.Buffer)
    <span class="keyword">defer</span> <span class="keyword">func</span>() {
        <span class="comment">// é‡ç½®å¹¶æ”¾å›æ± ä¸­</span>
        buf.<span class="function">Reset</span>()
        bufferPool.<span class="function">Put</span>(buf)
    }()
    
    buf.<span class="function">WriteString</span>(<span class="string">"Hello, World!"</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Buffer:"</span>, buf.<span class="function">String</span>())
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="keyword">for</span> i := <span class="number">0</span>; i < <span class="number">5</span>; i++ {
        <span class="function">process</span>()
    }
}</code></pre>

            <h3>Map å¹¶å‘å®‰å…¨æ˜ å°„</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="keyword">var</span> m sync.Map
    
    <span class="comment">// å­˜å‚¨</span>
    m.<span class="function">Store</span>(<span class="string">"key1"</span>, <span class="string">"value1"</span>)
    m.<span class="function">Store</span>(<span class="string">"key2"</span>, <span class="string">"value2"</span>)
    
    <span class="comment">// åŠ è½½</span>
    <span class="keyword">if</span> val, ok := m.<span class="function">Load</span>(<span class="string">"key1"</span>); ok {
        fmt.<span class="function">Println</span>(<span class="string">"key1:"</span>, val)
    }
    
    <span class="comment">// åŠ è½½æˆ–å­˜å‚¨</span>
    actual, loaded := m.<span class="function">LoadOrStore</span>(<span class="string">"key3"</span>, <span class="string">"value3"</span>)
    fmt.<span class="function">Printf</span>(<span class="string">"key3: %v, loaded: %v\n"</span>, actual, loaded)
    
    <span class="comment">// éå†</span>
    m.<span class="function">Range</span>(<span class="keyword">func</span>(key, value <span class="keyword">interface</span>{}) <span class="keyword">bool</span> {
        fmt.<span class="function">Printf</span>(<span class="string">"%s: %s\n"</span>, key, value)
        <span class="keyword">return</span> <span class="keyword">true</span>
    })
    
    <span class="comment">// åˆ é™¤</span>
    m.<span class="function">Delete</span>(<span class="string">"key1"</span>)
}</code></pre>

            <h3>Atomic åŸå­æ“ä½œ</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync/atomic"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="keyword">var</span> counter int64
    
    <span class="comment">// åŸå­å¢åŠ </span>
    atomic.<span class="function">AddInt64</span>(&counter, <span class="number">1</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Counter:"</span>, counter)
    
    <span class="comment">// åŸå­åŠ è½½</span>
    value := atomic.<span class="function">LoadInt64</span>(&counter)
    fmt.<span class="function">Println</span>(<span class="string">"Loaded:"</span>, value)
    
    <span class="comment">// åŸå­å­˜å‚¨</span>
    atomic.<span class="function">StoreInt64</span>(&counter, <span class="number">100</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Stored:"</span>, atomic.<span class="function">LoadInt64</span>(&counter))
    
    <span class="comment">// åŸå­æ¯”è¾ƒå¹¶äº¤æ¢</span>
    swapped := atomic.<span class="function">CompareAndSwapInt64</span>(&counter, <span class="number">100</span>, <span class="number">200</span>)
    fmt.<span class="function">Printf</span>(<span class="string">"Swapped: %v, Value: %d\n"</span>, swapped, atomic.<span class="function">LoadInt64</span>(&counter))
}</code></pre>

            <h2 id="json">json æ•°æ®ç¼–ç </h2>

            <h3>åŸºæœ¬ç¼–ç å’Œè§£ç </h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"fmt"</span>
)

<span class="keyword">type</span> Person <span class="keyword">struct</span> {
    Name  <span class="keyword">string</span> <span class="string">`json:"name"`</span>
    Age   <span class="keyword">int</span>    <span class="string">`json:"age"`</span>
    Email <span class="keyword">string</span> <span class="string">`json:"email,omitempty"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ç¼–ç </span>
    person := Person{
        Name: <span class="string">"Alice"</span>,
        Age:  <span class="number">30</span>,
    }
    
    jsonData, err := json.<span class="function">Marshal</span>(person)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    fmt.<span class="function">Println</span>(<span class="string">"JSON:"</span>, <span class="keyword">string</span>(jsonData))
    
    <span class="comment">// è§£ç </span>
    <span class="keyword">var</span> decoded Person
    err = json.<span class="function">Unmarshal</span>(jsonData, &decoded)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    fmt.<span class="function">Printf</span>(<span class="string">"Decoded: %+v\n"</span>, decoded)
}</code></pre>

            <h3>å¤„ç†åµŒå¥—ç»“æ„</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"fmt"</span>
)

<span class="keyword">type</span> Address <span class="keyword">struct</span> {
    City    <span class="keyword">string</span> <span class="string">`json:"city"`</span>
    Country <span class="keyword">string</span> <span class="string">`json:"country"`</span>
}

<span class="keyword">type</span> User <span class="keyword">struct</span> {
    Name    <span class="keyword">string</span>  <span class="string">`json:"name"`</span>
    Age     <span class="keyword">int</span>     <span class="string">`json:"age"`</span>
    Address Address  <span class="string">`json:"address"`</span>
    Tags    []<span class="keyword">string</span> <span class="string">`json:"tags"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    jsonData := []<span class="keyword">byte</span>(<span class="string">`{
        "name": "Bob",
        "age": 25,
        "address": {
            "city": "Beijing",
            "country": "China"
        },
        "tags": ["developer", "golang"]
    }`</span>)
    
    <span class="keyword">var</span> user User
    err := json.<span class="function">Unmarshal</span>(jsonData, &user)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    
    fmt.<span class="function">Printf</span>(<span class="string">"User: %+v\n"</span>, user)
    fmt.<span class="function">Printf</span>(<span class="string">"Address: %+v\n"</span>, user.Address)
    fmt.<span class="function">Printf</span>(<span class="string">"Tags: %v\n"</span>, user.Tags)
}</code></pre>

            <h3>ä½¿ç”¨ map å’Œ interface</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"fmt"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// è§£ç åˆ° map</span>
    jsonData := []<span class="keyword">byte</span>(<span class="string">`{"name": "Charlie", "age": 35}`</span>)
    <span class="keyword">var</span> data <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>{
    
    err := json.<span class="function">Unmarshal</span>(jsonData, &data)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    
    fmt.<span class="function">Printf</span>(<span class="string">"Name: %v\n"</span>, data[<span class="string">"name"</span>])
    fmt.<span class="function">Printf</span>(<span class="string">"Age: %v\n"</span>, data[<span class="string">"age"</span>])
    
    <span class="comment">// ç¼–ç  map</span>
    newMap := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>{
        <span class="string">"key1"</span>: <span class="string">"value1"</span>,
        <span class="string">"key2"</span>: <span class="number">123</span>,
        <span class="string">"key3"</span>: <span class="keyword">true</span>,
    }
    
    result, err := json.<span class="function">Marshal</span>(newMap)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    fmt.<span class="function">Println</span>(<span class="string">"Map JSON:"</span>, <span class="keyword">string</span>(result))
}</code></pre>

            <h3>JSON æµå¼å¤„ç†</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"fmt"</span>
    <span class="string">"strings"</span>
)

<span class="keyword">type</span> Item <span class="keyword">struct</span> {
    ID   <span class="keyword">int</span>    <span class="string">`json:"id"`</span>
    Name <span class="keyword">string</span> <span class="string">`json:"name"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// JSON æ•°ç»„æµ</span>
    jsonStream := <span class="string">`[{"id":1,"name":"Item1"},{"id":2,"name":"Item2"}]`</span>
    
    decoder := json.<span class="function">NewDecoder</span>(strings.<span class="function">NewReader</span>(jsonStream))
    
    <span class="comment">// è¯»å–å¼€å§‹æ•°ç»„æ ‡è®°</span>
    t, err := decoder.<span class="function">Token</span>()
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    fmt.<span class="function">Println</span>(<span class="string">"Start token:"</span>, t)
    
    <span class="comment">// è¯»å–æ•°ç»„å…ƒç´ </span>
    <span class="keyword">for</span> decoder.<span class="function">More</span>() {
        <span class="keyword">var</span> item Item
        err := decoder.<span class="function">Decode</span>(&item)
        <span class="keyword">if</span> err != <span class="keyword">nil</span> {
            fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
            <span class="keyword">return</span>
        }
        fmt.<span class="function">Printf</span>(<span class="string">"Item: %+v\n"</span>, item)
    }
    
    <span class="comment">// è¯»å–ç»“æŸæ•°ç»„æ ‡è®°</span>
    t, err = decoder.<span class="function">Token</span>()
    fmt.<span class="function">Println</span>(<span class="string">"End token:"</span>, t)
}</code></pre>

            <h3>è‡ªå®šä¹‰ JSON ç¼–ç </h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"fmt"</span>
    <span class="string">"time"</span>
)

<span class="keyword">type</span> CustomTime <span class="keyword">struct</span> {
    time.Time
}

<span class="keyword">const</span> customTimeFormat = <span class="string">"2006-01-02 15:04:05"</span>

<span class="function">func</span> (ct *CustomTime) <span class="function">UnmarshalJSON</span>(data []<span class="keyword">byte</span>) <span class="keyword">error</span> {
    <span class="keyword">var</span> s <span class="keyword">string</span>
    <span class="keyword">if</span> err := json.<span class="function">Unmarshal</span>(data, &s); err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    
    t, err := time.<span class="function">Parse</span>(customTimeFormat, s)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    
    ct.Time = t
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="function">func</span> (ct CustomTime) <span class="function">MarshalJSON</span>() ([]<span class="keyword">byte</span>, <span class="keyword">error</span>) {
    <span class="keyword">return</span> json.<span class="function">Marshal</span>(ct.<span class="function">Format</span>(customTimeFormat))
}

<span class="keyword">type</span> Event <span class="keyword">struct</span> {
    Name <span class="keyword">string</span>     <span class="string">`json:"name"`</span>
    Time CustomTime <span class="string">`json:"time"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    event := Event{
        Name: <span class="string">"Meeting"</span>,
        Time: CustomTime{time.<span class="function">Now</span>()},
    }
    
    jsonData, _ := json.<span class="function">Marshal</span>(event)
    fmt.<span class="function">Println</span>(<span class="string">"Custom JSON:"</span>, <span class="keyword">string</span>(jsonData))
    
    <span class="keyword">var</span> decoded Event
    json.<span class="function">Unmarshal</span>(jsonData, &decoded)
    fmt.<span class="function">Printf</span>(<span class="string">"Decoded: %+v\n"</span>, decoded)
}</code></pre>

            <h3>é”™è¯¯å¤„ç†</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"fmt"</span>
    <span class="string">"errors"</span>
)

<span class="keyword">type</span> User <span class="keyword">struct</span> {
    Name <span class="keyword">string</span> <span class="string">`json:"name"`</span>
    Age  <span class="keyword">int</span>    <span class="string">json:"age,required"</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// æ— æ•ˆ JSON</span>
    jsonData := []<span class="keyword">byte</span>(<span class="string">`{"name": "Test"}`</span>)
    
    <span class="keyword">var</span> user User
    err := json.<span class="function">Unmarshal</span>(jsonData, &user)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Unmarshal error:"</span>, err)
        
        <span class="keyword">var</span> syntaxErr *json.SyntaxError
        <span class="keyword">if</span> errors.<span class="function">As</span>(err, &syntaxErr) {
            fmt.<span class="function">Printf</span>(<span class="string">"Syntax error at offset %d\n"</span>, syntaxErr.Offset)
        }
        
        <span class="keyword">var</span> unmarshalErr *json.UnmarshalTypeError
        <span class="keyword">if</span> errors.<span class="function">As</span>(err, &unmarshalErr) {
            fmt.<span class="function">Printf</span>(<span class="string">"Type error: expected %s, got %s\n"</span>, 
                unmarshalErr.Type, unmarshalErr.Value)
        }
    }
}</code></pre>

            <h2 id="time">time æ—¶é—´å¤„ç†</h2>

            <h3>è·å–å½“å‰æ—¶é—´</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"time"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// è·å–å½“å‰æ—¶é—´</span>
    now := time.<span class="function">Now</span>()
    fmt.<span class="function">Println</span>(<span class="string">"Current time:"</span>, now)
    
    <span class="comment">// è·å– UTC æ—¶é—´</span>
    utc := time.<span class="function">Now</span>().<span class="function">UTC</span>()
    fmt.<span class="function">Println</span>(<span class="string">"UTC time:"</span>, utc)
}</code></pre>

            <h3>æ—¶é—´æ ¼å¼åŒ–</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"time"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    now := time.<span class="function">Now</span>()
    
    <span class="comment">// ä½¿ç”¨é¢„å®šä¹‰æ ¼å¼</span>
    fmt.<span class="function">Println</span>(<span class="string">"RFC3339:"</span>, now.<span class="function">Format</span>(time.RFC3339))
    fmt.<span class="function">Println</span>(<span class="string">"RFC1123:"</span>, now.<span class="function">Format</span>(time.RFC1123))
    
    <span class="comment">// è‡ªå®šä¹‰æ ¼å¼ï¼ˆå‚è€ƒ 2006-01-02 15:04:05ï¼‰</span>
    fmt.<span class="function">Println</span>(<span class="string">"Custom:"</span>, now.<span class="function">Format</span>(<span class="string">"2006-01-02 15:04:05"</span>))
    fmt.<span class="function">Println</span>(<span class="string">"Date only:"</span>, now.<span class="function">Format</span>(<span class="string">"2006-01-02"</span>))
    fmt.<span class="function">Println</span>(<span class="string">"Time only:"</span>, now.<span class="function">Format</span>(<span class="string">"15:04:05"</span>))
}</code></pre>

            <h3>æ—¶é—´è§£æ</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"time"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// è§£ææ—¶é—´å­—ç¬¦ä¸²</span>
    timeStr := <span class="string">"2024-01-26 15:30:45"</span>
    parsedTime, err := time.<span class="function">Parse</span>(<span class="string">"2006-01-02 15:04:05"</span>, timeStr)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    fmt.<span class="function">Println</span>(<span class="string">"Parsed time:"</span>, parsedTime)
    
    <span class="comment">// è§£æ RFC3339 æ ¼å¼</span>
    rfcTime, err := time.<span class="function">Parse</span>(time.RFC3339, <span class="string">"2024-01-26T15:30:45Z"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    fmt.<span class="function">Println</span>(<span class="string">"RFC3339 time:"</span>, rfcTime)
}</code></pre>

            <h3>æ—¶é—´è®¡ç®—</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"time"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    now := time.<span class="function">Now</span>()
    
    <span class="comment">// æ·»åŠ æ—¶é—´</span>
    future := now.<span class="function">Add</span>(<span class="number">24</span> * time.Hour)
    fmt.<span class="function">Println</span>(<span class="string">"24 hours later:"</span>, future)
    
    <span class="comment">// å‡å»æ—¶é—´</span>
    past := now.<span class="function">Add</span>(-<span class="number">24</span> * time.Hour)
    fmt.<span class="function">Println</span>(<span class="string">"24 hours ago:"</span>, past)
    
    <span class="comment">// è®¡ç®—æ—¶é—´å·®</span>
    duration := future.<span class="function">Sub</span>(now)
    fmt.<span class="function">Println</span>(<span class="string">"Duration:"</span>, duration)
    fmt.<span class="function">Println</span>(<span class="string">"Hours:"</span>, duration.<span class="function">Hours</span>())
    fmt.<span class="function">Println</span>(<span class="string">"Minutes:"</span>, duration.<span class="function">Minutes</span>())
    
    <span class="comment">// è®¡ç®—ä¸¤ä¸ªæ—¶é—´ä¹‹é—´çš„å¤©æ•°</span>
    days := duration.<span class="function">Hours</span>() / <span class="number">24</span>
    fmt.<span class="function">Println</span>(<span class="string">"Days:"</span>, days)
}</code></pre>

            <h3>å®šæ—¶å™¨å’Œ Ticker</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"time"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// Timerï¼šä¸€æ¬¡æ€§å®šæ—¶å™¨</span>
    timer := time.<span class="function">NewTimer</span>(<span class="number">2</span> * time.Second)
    <-timer.C
    fmt.<span class="function">Println</span>(<span class="string">"Timer expired"</span>)
    
    <span class="comment">// Tickerï¼šå‘¨æœŸæ€§å®šæ—¶å™¨</span>
    ticker := time.<span class="function">NewTicker</span>(<span class="number">1</span> * time.Second)
    <span class="keyword">defer</span> ticker.<span class="function">Stop</span>()
    
    <span class="keyword">for</span> i := <span class="number">0</span>; i < <span class="number">3</span>; i++ {
        <-ticker.C
        fmt.<span class="function">Printf</span>(<span class="string">"Tick %d\n"</span>, i)
    }
}</code></pre>

            <h3>æ—¶åŒºå¤„ç†</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"time"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åŠ è½½æ—¶åŒº</span>
    loc, err := time.<span class="function">LoadLocation</span>(<span class="string">"Asia/Shanghai"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    
    <span class="comment">// åœ¨æŒ‡å®šæ—¶åŒºåˆ›å»ºæ—¶é—´</span>
    now := time.<span class="function">Now</span>().<span class="function">In</span>(loc)
    fmt.<span class="function">Println</span>(<span class="string">"Shanghai time:"</span>, now)
    
    <span class="comment">// è½¬æ¢æ—¶åŒº</span>
    nyLoc, _ := time.<span class="function">LoadLocation</span>(<span class="string">"America/New_York"</span>)
    nyTime := now.<span class="function">In</span>(nyLoc)
    fmt.<span class="function">Println</span>(<span class="string">"New York time:"</span>, nyTime)
}</code></pre>

            <h2 id="io">io è¾“å…¥è¾“å‡º</h2>

            <h3>è¯»å–æ–‡ä»¶</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"io"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// æ‰“å¼€æ–‡ä»¶</span>
    file, err := os.<span class="function">Open</span>(<span class="string">"test.txt"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    <span class="keyword">defer</span> file.<span class="function">Close</span>()
    
    <span class="comment">// è¯»å–æ•´ä¸ªæ–‡ä»¶</span>
    data, err := io.<span class="function">ReadAll</span>(file)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    fmt.<span class="function">Println</span>(<span class="string">"File content:"</span>, <span class="keyword">string</span>(data))
}</code></pre>

            <h3>å†™å…¥æ–‡ä»¶</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// å†™å…¥æ–‡ä»¶ï¼ˆè¦†ç›–ï¼‰</span>
    err := os.<span class="function">WriteFile</span>(<span class="string">"output.txt"</span>, []<span class="keyword">byte</span>(<span class="string">"Hello, World!"</span>), <span class="number">0644</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    
    <span class="comment">// è¿½åŠ å†™å…¥</span>
    f, err := os.<span class="function">OpenFile</span>(<span class="string">"output.txt"</span>, os.O_APPEND|os.O_WRONLY, <span class="number">0644</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    <span class="keyword">defer</span> f.<span class="function">Close</span>()
    
    _, err = f.<span class="function">WriteString</span>(<span class="string">"\nAppended text"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
    }
}</code></pre>

            <h3>è¯»å–ç›®å½•</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// è¯»å–ç›®å½•å†…å®¹</span>
    entries, err := os.<span class="function">ReadDir</span>(<span class="string">"."</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    
    <span class="keyword">for</span> _, entry := <span class="keyword">range</span> entries {
        fmt.<span class="function">Printf</span>(<span class="string">"%s (%v)\n"</span>, entry.<span class="function">Name</span>(), entry.<span class="function">IsDir</span>())
    }
}</code></pre>

            <h3>åˆ›å»ºå’Œåˆ é™¤æ–‡ä»¶/ç›®å½•</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºç›®å½•</span>
    err := os.<span class="function">MkdirAll</span>(<span class="string">"testdir/subdir"</span>, <span class="number">0755</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
    }
    
    <span class="comment">// åˆ›å»ºæ–‡ä»¶</span>
    file, err := os.<span class="function">Create</span>(<span class="string">"testdir/test.txt"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
    }
    file.<span class="function">Close</span>()
    
    <span class="comment">// åˆ é™¤æ–‡ä»¶</span>
    os.<span class="function">Remove</span>(<span class="string">"testdir/test.txt"</span>)
    
    <span class="comment">// åˆ é™¤ç›®å½•</span>
    os.<span class="function">RemoveAll</span>(<span class="string">"testdir"</span>)
}</code></pre>

            <h3>ä½¿ç”¨ io.Copy</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"io"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">copyFile</span>(src, dst <span class="keyword">string</span>) <span class="keyword">error</span> {
    source, err := os.<span class="function">Open</span>(src)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> source.<span class="function">Close</span>()
    
    destination, err := os.<span class="function">Create</span>(dst)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> destination.<span class="function">Close</span>()
    
    _, err = io.<span class="function">Copy</span>(destination, source)
    <span class="keyword">return</span> err
}</code></pre>

            <h3>ä½¿ç”¨ io.LimitReader</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"io"</span>
    <span class="string">"strings"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    reader := strings.<span class="function">NewReader</span>(<span class="string">"Hello, World! This is a long string."</span>)
    
    <span class="comment">// é™åˆ¶è¯»å– 5 ä¸ªå­—èŠ‚</span>
    limitedReader := io.<span class="function">LimitReader</span>(reader, <span class="number">5</span>)
    
    data, _ := io.<span class="function">ReadAll</span>(limitedReader)
    fmt.<span class="function">Println</span>(<span class="string">"Limited read:"</span>, <span class="keyword">string</span>(data))
}</code></pre>

            <h2 id="bufio">bufio ç¼“å†² I/O</h2>

            <h3>ç¼“å†²è¯»å–</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"bufio"</span>
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    file, _ := os.<span class="function">Open</span>(<span class="string">"test.txt"</span>)
    <span class="keyword">defer</span> file.<span class="function">Close</span>()
    
    scanner := bufio.<span class="function">NewScanner</span>(file)
    
    <span class="comment">// é€è¡Œè¯»å–</span>
    <span class="keyword">for</span> scanner.<span class="function">Scan</span>() {
        fmt.<span class="function">Println</span>(scanner.<span class="function">Text</span>())
    }
}</code></pre>

            <h3>ç¼“å†²å†™å…¥</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"bufio"</span>
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    file, _ := os.<span class="function">Create</span>(<span class="string">"output.txt"</span>)
    <span class="keyword">defer</span> file.<span class="function">Close</span>()
    
    writer := bufio.<span class="function">NewWriter</span>(file)
    <span class="keyword">defer</span> writer.<span class="function">Flush</span>()
    
    <span class="keyword">for</span> i := <span class="number">0</span>; i < <span class="number">10</span>; i++ {
        fmt.<span class="function">Fprintln</span>(writer, <span class="string">"Line"</span>, i)
    }
}</code></pre>

            <h3>ä»æ ‡å‡†è¾“å…¥è¯»å–</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"bufio"</span>
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    scanner := bufio.<span class="function">NewScanner</span>(os.Stdin)
    
    fmt.<span class="function">Print</span>(<span class="string">"Enter your name: "</span>)
    scanner.<span class="function">Scan</span>()
    name := scanner.<span class="function">Text</span>()
    
    fmt.<span class="function">Printf</span>(<span class="string">"Hello, %s!\n"</span>, name)
}</code></pre>

            <h3>è¯»å–åˆ†éš”ç¬¦</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"bufio"</span>
    <span class="string">"fmt"</span>
    <span class="string">"strings"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    reader := strings.<span class="function">NewReader</span>(<span class="string">"apple,banana,cherry"</span>)
    scanner := bufio.<span class="function">NewScanner</span>(reader)
    
    <span class="comment">// è®¾ç½®åˆ†éš”ç¬¦</span>
    scanner.<span class="function">Split</span>(bufio.<span class="function">ScanWords</span>)
    
    <span class="keyword">for</span> scanner.<span class="function">Scan</span>() {
        fmt.<span class="function">Println</span>(scanner.<span class="function">Text</span>())
    }
}</code></pre>

            <h3>ä½¿ç”¨ bufio.Reader</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"bufio"</span>
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    file, _ := os.<span class="function">Open</span>(<span class="string">"test.txt"</span>)
    <span class="keyword">defer</span> file.<span class="function">Close</span>()
    
    reader := bufio.<span class="function">NewReader</span>(file)
    
    <span class="comment">// è¯»å–åˆ°åˆ†éš”ç¬¦</span>
    line, _ := reader.<span class="function">ReadString</span>(<span class="string">'\n'</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Line:"</span>, line)
    
    <span class="comment">// è¯»å–å­—èŠ‚</span>
    data := <span class="function">make</span>([]<span class="keyword">byte</span>, <span class="number">10</span>)
    n, _ := reader.<span class="function">Read</span>(data)
    fmt.<span class="function">Printf</span>(<span class="string">"Read %d bytes: %s\n"</span>, n, data)
}</code></pre>

            <h3>ä½¿ç”¨ bufio.Writer</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"bufio"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    file, _ := os.<span class="function">Create</span>(<span class="string">"output.txt"</span>)
    <span class="keyword">defer</span> file.<span class="function">Close</span>()
    
    writer := bufio.<span class="function">NewWriter</span>(file)
    
    <span class="comment">// å†™å…¥å­—èŠ‚</span>
    writer.<span class="function">Write</span>([]<span class="keyword">byte</span>(<span class="string">"Hello"</span>))
    
    <span class="comment">// å†™å…¥å­—ç¬¦ä¸²</span>
    writer.<span class="function">WriteString</span>(<span class="string">", World!"</span>)
    
    <span class="comment">// åˆ·æ–°ç¼“å†²åŒº</span>
    writer.<span class="function">Flush</span>()
}</code></pre>

            <h2 id="introduction">Embed ç®€ä»‹</h2>
            <p><code>embed</code> æ˜¯ Go 1.16 å¼•å…¥çš„æ ‡å‡†åº“ï¼Œç”¨äºåœ¨ç¼–è¯‘æ—¶å°†æ–‡ä»¶åµŒå…¥åˆ° Go ç¨‹åºä¸­ã€‚å®ƒæä¾›äº†ä¸€ç§ç®€å•ã€ç±»å‹å®‰å…¨çš„æ–¹å¼æ¥è®¿é—®åµŒå…¥çš„æ–‡ä»¶ï¼Œæ— éœ€åœ¨è¿è¡Œæ—¶è¯»å–æ–‡ä»¶ç³»ç»Ÿã€‚</p>

            <div class="example-box">
                <h3>Embed çš„æ ¸å¿ƒç‰¹æ€§</h3>
                <ul>
                    <li><strong>ç¼–è¯‘æ—¶åµŒå…¥</strong>ï¼šæ–‡ä»¶åœ¨ç¼–è¯‘æ—¶è¢«åµŒå…¥åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ä¸­</li>
                    <li><strong>ç±»å‹å®‰å…¨</strong>ï¼šæä¾› stringã€[]byte å’Œ fs.FS ç±»å‹</li>
                    <li><strong>è·¨å¹³å°</strong>ï¼šè‡ªåŠ¨å¤„ç†ä¸åŒæ“ä½œç³»ç»Ÿçš„è·¯å¾„åˆ†éš”ç¬¦</li>
                    <li><strong>é›¶ä¾èµ–</strong>ï¼šä¸éœ€è¦é¢å¤–çš„ä¾èµ–ç®¡ç†</li>
                    <li><strong>ç®€å•æ˜“ç”¨</strong>ï¼šé€šè¿‡ //go:embed æŒ‡ä»¤å£°æ˜</li>
                </ul>
            

<h2 id="bestpractices">æœ€ä½³å®è·µ</h2>

            <div class="example-box">
                <h3>regexp æœ€ä½³å®è·µ</h3>
                <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"regexp"</span>
    <span class="string">"sync"</span>
)

<span class="comment">// 1. é¢„ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼</span>
<span class="keyword">var</span> (
    emailRe     = regexp.<span class="function">MustCompile</span>(<span class="string">`^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$`</span>)
    phoneRe     = regexp.<span class="function">MustCompile</span>(<span class="string">`^1[3-9]\d{9}$`</span>)
    reCache     = <span class="function">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]*regexp.Regexp)
    reCacheMu   sync.RWMutex
)

<span class="comment">// 2. ç¼“å­˜æ­£åˆ™è¡¨è¾¾å¼</span>
<span class="function">func</span> <span class="function">GetRegex</span>(pattern <span class="keyword">string</span>) (*regexp.Regexp, <span class="keyword">error</span>) {
    reCacheMu.<span class="function">RLock</span>()
    re, ok := reCache[pattern]
    reCacheMu.<span class="function">RUnlock</span>()
    
    <span class="keyword">if</span> ok {
        <span class="keyword">return</span> re, <span class="keyword">nil</span>
    }
    
    re, err := regexp.<span class="function">Compile</span>(pattern)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="keyword">nil</span>, err
    }
    
    reCacheMu.<span class="function">Lock</span>()
    reCache[pattern] = re
    reCacheMu.<span class="function">Unlock</span>()
    
    <span class="keyword">return</span> re, <span class="keyword">nil</span>
}

<span class="comment">// 3. ä½¿ç”¨åŸå§‹å­—ç¬¦ä¸²é¿å…è½¬ä¹‰</span>
<span class="comment">// å¥½ï¼š`\d+`</span>
<span class="comment">// åï¼š"\d+"</span>

<span class="comment">// 4. é¿å…è´ªå©ªåŒ¹é…</span>
<span class="comment">// å¥½ï¼š`<.*?>`</span>
<span class="comment">// åï¼š`<.*>`</span>

<span class="comment">// 5. ä½¿ç”¨éæ•è·ç»„</span>
<span class="comment">// å¥½ï¼š`(?:a|b)c`</span>
<span class="comment">// åï¼š`(a|b)c`</span></code></pre>

                <h3>sync æœ€ä½³å®è·µ</h3>
                <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"sync"</span>
)

<span class="comment">// 1. é¿å…é”çš„åµŒå¥—</span>
<span class="keyword">type</span> SafeCounter <span class="keyword">struct</span> {
    mu    sync.Mutex
    value <span class="keyword">int</span>
}

<span class="function">func</span> (c *SafeCounter) <span class="function">Increment</span>() {
    c.mu.<span class="function">Lock</span>()
    <span class="keyword">defer</span> c.mu.<span class="function">Unlock</span>()
    c.value++
}

<span class="comment">// 2. ä½¿ç”¨ defer ç¡®ä¿é”é‡Šæ”¾</span>
<span class="function">func</span> (c *SafeCounter) <span class="function">Get</span>() <span class="keyword">int</span> {
    c.mu.<span class="function">Lock</span>()
    <span class="keyword">defer</span> c.mu.<span class="function">Unlock</span>()
    <span class="keyword">return</span> c.value
}

<span class="comment">// 3. è¯»å†™é”ç”¨äºè¯»å¤šå†™å°‘åœºæ™¯</span>
<span class="keyword">type</span> SafeMap <span class="keyword">struct</span> {
    mu   sync.RWMutex
    data <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>
}

<span class="function">func</span> (m *SafeMap) <span class="function">Get</span>(key <span class="keyword">string</span>) (<span class="keyword">string</span>, <span class="keyword">bool</span>) {
    m.mu.<span class="function">RLock</span>()
    <span class="keyword">defer</span> m.mu.<span class="function">RUnlock</span>()
    val, ok := m.data[key]
    <span class="keyword">return</span> val, ok
}

<span class="function">func</span> (m *SafeMap) <span class="function">Set</span>(key, value <span class="keyword">string</span>) {
    m.mu.<span class="function">Lock</span>()
    <span class="keyword">defer</span> m.mu.<span class="function">Unlock</span>()
    m.data[key] = value
}

<span class="comment">// 4. ä½¿ç”¨ sync.Pool é‡ç”¨å¯¹è±¡</span>
<span class="keyword">var</span> bufferPool = sync.<span class="function">Pool</span>{
    New: <span class="keyword">func</span>() <span class="keyword">interface</span>{} {
        <span class="keyword">return</span> <span class="function">make</span>([]<span class="keyword">byte</span>, <span class="number">0</span>, <span class="number">1024</span>)
    },
}

<span class="function">func</span> <span class="function">getBuffer</span>() []<span class="keyword">byte</span> {
    <span class="keyword">return</span> bufferPool.<span class="function">Get</span>().([]<span class="keyword">byte</span>)
}

<span class="function">func</span> <span class="function">putBuffer</span>(buf []<span class="keyword">byte</span>) {
    bufferPool.<span class="function">Put</span>(buf[:<span class="number">0</span>])
}

<span class="comment">// 5. ä½¿ç”¨ sync.Map æ›¿ä»£ map+Mutexï¼ˆç‰¹å®šåœºæ™¯ï¼‰</span>
<span class="comment">// é€‚ç”¨äºï¼šè¯»å¤šå†™å°‘ã€é”®å€¼å¯¹ç¨³å®š</span></code></pre>

                <h3>json æœ€ä½³å®è·µ</h3>
                <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
)

<span class="comment">// 1. ä½¿ç”¨ç»“æ„ä½“æ ‡ç­¾</span>
<span class="keyword">type</span> User <span class="keyword">struct</span> {
    Name     <span class="keyword">string</span> <span class="string">`json:"name"`</span>
    Age      <span class="keyword">int</span>    <span class="string">`json:"age"`</span>
    Password <span class="keyword">string</span> <span class="string">json:"-"`</span>           <span class="comment">// å¿½ç•¥</span>
    Email    <span class="keyword">string</span> <span class="string">`json:"email,omitempty"`</span> <span class="comment">// ç©ºå€¼å¿½ç•¥</span>
}

<span class="comment">// 2. ä½¿ç”¨æŒ‡é’ˆå¤„ç†å¯é€‰å­—æ®µ</span>
<span class="keyword">type</span> Config <span class="keyword">struct</span> {
    Timeout *<span class="keyword">int</span>  <span class="string">`json:"timeout,omitempty"`</span>
    Enabled *<span class="keyword">bool</span> <span class="string">`json:"enabled,omitempty"`</span>
}

<span class="comment">// 3. ä½¿ç”¨ json.RawMessage å»¶è¿Ÿè§£æ</span>
<span class="keyword">type</span> Message <span class="keyword">struct</span> {
    Type    <span class="keyword">string</span>          <span class="string">`json:"type"`</span>
    Payload json.RawMessage <span class="string">`json:"payload"`</span>
}

<span class="comment">// 4. ä½¿ç”¨ json.Number å¤„ç†å¤§æ•°å­—</span>
<span class="keyword">type</span> Data <span class="keyword">struct</span> {
    ID json.Number <span class="string">`json:"id"`</span>
}

<span class="comment">// 5. éªŒè¯ JSON ç»“æ„</span>
<span class="function">func</span> <span class="function">validateJSON</span>(data []<span class="keyword">byte</span>) <span class="keyword">bool</span> {
    <span class="keyword">var</span> v <span class="keyword">interface</span>{
    <span class="keyword">return</span> json.<span class="function">Valid</span>(data)
}

<span class="comment">// 6. ä½¿ç”¨ json.Encoder/Decoder å¤„ç†æµ</span>
<span class="comment">// é€‚ç”¨äºå¤§æ–‡ä»¶æˆ–ç½‘ç»œæµ</span>

<span class="comment">// 7. å¤„ç†è‡ªå®šä¹‰æ—¶é—´æ ¼å¼</span>
<span class="keyword">type</span> CustomTime <span class="keyword">struct</span> {
    time.Time
}

<span class="function">func</span> (ct *CustomTime) <span class="function">UnmarshalJSON</span>(b []<span class="keyword">byte</span>) <span class="keyword">error</span> {
    s := <span class="keyword">string</span>(b)
    t, err := time.<span class="function">Parse</span>(<span class="string">"2006-01-02"</span>, s)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    ct.Time = t
    <span class="keyword">return</span> <span class="keyword">nil</span>
}</code></pre>
            </div>

            <h2 id="exp">exp å®éªŒæ€§æ ‡å‡†åº“</h2>
            
            <h3>ç®€ä»‹</h3>
            <p>expï¼ˆexperimentalï¼‰æ˜¯ Go è¯­è¨€çš„å®éªŒæ€§æ ‡å‡†åº“ï¼ŒåŒ…å«äº†ä¸€äº›æ–°åŠŸèƒ½å’Œå®éªŒæ€§çš„å®ç°ã€‚è¿™äº›åº“å¯èƒ½ä¼šåœ¨æœªæ¥æˆä¸ºæ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå¯èƒ½è¢«ç§»é™¤æˆ–ä¿®æ”¹ã€‚å¸¸ç”¨çš„ exp åº“åŒ…æ‹¬ expvarï¼ˆå˜é‡ç›‘æ§ï¼‰ã€slogï¼ˆç»“æ„åŒ–æ—¥å¿—ï¼‰ç­‰ã€‚</p>
            
            <h3>expvar å˜é‡ç›‘æ§</h3>
            <p>expvar æä¾›äº†ä¸€ç§æ ‡å‡†åŒ–çš„æ–¹å¼æ¥å‘å¸ƒå’Œç›‘æ§è¿è¡Œæ—¶çš„å˜é‡ï¼Œç‰¹åˆ«é€‚åˆç”¨äºç›‘æ§å’Œè°ƒè¯•ã€‚</p>
            
            <h4>åŸºæœ¬ä½¿ç”¨</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"expvar"</span>
    <span class="string">"fmt"</span>
    <span class="string">"net/http"</span>
    <span class="string">"time"</span>
)

<span class="keyword">var</span> (
    requests    = expvar.<span class="function">NewInt</span>(<span class="string">"requests"</span>)
    errors      = expvar.<span class="function">NewInt</span>(<span class="string">"errors"</span>)
    connections = expvar.<span class="function">NewInt</span>(<span class="string">"connections"</span>)
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// æ³¨å†Œ HTTP å¤„ç†å™¨</span>
    http.<span class="function">Handle</span>(<span class="string">"/debug/vars"</span>, expvar.<span class="function">Handler</span>())
    
    <span class="comment">// æ¨¡æ‹Ÿè¯·æ±‚å¤„ç†</span>
    <span class="keyword">go</span> <span class="keyword">func</span>() {
        <span class="keyword">for</span> {
            requests.<span class="function">Add</span>(<span class="number">1</span>)
            time.<span class="function">Sleep</span>(time.Second)
        }
    }()
    
    fmt.<span class="function">Println</span>(<span class="string">"Server started on :8080"</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Visit http://localhost:8080/debug/vars to see metrics"</span>)
    http.<span class="function">ListenAndServe</span>(<span class="string">":8080"</span>, <span class="keyword">nil</span>)
}</code></pre>
            
            <h4>è‡ªå®šä¹‰å˜é‡</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"expvar"</span>
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
)

<span class="comment">// è‡ªå®šä¹‰è®¡æ•°å™¨</span>
<span class="keyword">type</span> Counter <span class="keyword">struct</span> {
    mu    sync.Mutex
    count <span class="keyword">int</span>
}

<span class="function">func</span> (c *Counter) <span class="function">String</span>() <span class="keyword">string</span> {
    c.mu.<span class="function">Lock</span>()
    <span class="keyword">defer</span> c.mu.<span class="function">Unlock</span>()
    <span class="keyword">return</span> fmt.<span class="function">Sprintf</span>(<span class="string">"%d"</span>, c.count)
}

<span class="function">func</span> (c *Counter) <span class="function">Add</span>(n <span class="keyword">int</span>) {
    c.mu.<span class="function">Lock</span>()
    <span class="keyword">defer</span> c.mu.<span class="function">Unlock</span>()
    c.count += n
}

<span class="keyword">var</span> customCounter = &Counter{}

<span class="function">func</span> <span class="function">init</span>() {
    expvar.<span class="function">Publish</span>(<span class="string">"custom_counter"</span>, customCounter)
}

<span class="function">func</span> <span class="function">main</span>() {
    customCounter.<span class="function">Add</span>(<span class="number">1</span>)
    customCounter.<span class="function">Add</span>(<span class="number">2</span>)
    
    <span class="comment">// è·å–å˜é‡å€¼</span>
    val := expvar.<span class="function">Get</span>(<span class="string">"custom_counter"</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Custom counter:"</span>, val.<span class="function">String</span>())
}</code></pre>
            
            <h4>Map ç±»å‹</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"expvar"</span>
    <span class="string">"fmt"</span>
)

<span class="keyword">var</span> (
    <span class="comment">// åˆ›å»º Map</span>
    stats = expvar.<span class="function">NewMap</span>(<span class="string">"stats"</span>)
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// æ·»åŠ é”®å€¼å¯¹</span>
    stats.<span class="function">Add</span>(<span class="string">"requests"</span>, <span class="number">100</span>)
    stats.<span class="function">Add</span>(<span class="string">"errors"</span>, <span class="number">5</span>)
    
    <span class="comment">// è®¾ç½®å€¼</span>
    stats.<span class="function">Set</span>(<span class="string">"version"</span>, expvar.<span class="function">String</span>(<span class="string">"1.0.0"</span>))
    
    <span class="comment">// è·å–å€¼</span>
    requests := stats.<span class="function">Get</span>(<span class="string">"requests"</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Requests:"</span>, requests.<span class="function">String</span>())
    
    <span class="comment">// éå†æ‰€æœ‰é”®</span>
    stats.<span class="function">Do</span>(<span class="keyword">func</span>(kv expvar.KeyValue) <span class="keyword">bool</span> {
        fmt.<span class="function">Printf</span>(<span class="string">"%s: %s\n"</span>, kv.Key, kv.Value.<span class="function">String</span>())
        <span class="keyword">return</span> <span class="keyword">true</span>
    })
}</code></pre>
            
            <h4>Float ç±»å‹</h4>
            <pre><code><span class="keyword">var</span> (
    cpuUsage = expvar.<span class="function">NewFloat</span>(<span class="string">"cpu_usage"</span>)
    memory   = expvar.<span class="function">NewFloat</span>(<span class="string">"memory_usage"</span>)
)

<span class="function">func</span> <span class="function">updateMetrics</span>() {
    cpuUsage.<span class="function">Set</span>(<span class="number">45.5</span>)
    memory.<span class="function">Set</span>(<span class="number">1024.5</span>)
}</code></pre>
            
            <h4>String ç±»å‹</h4>
            <pre><code><span class="keyword">var</span> (
    version   = expvar.<span class="function">NewString</span>(<span class="string">"version"</span>)
    buildTime = expvar.<span class="function">NewString</span>(<span class="string">"build_time"</span>)
)

<span class="function">func</span> <span class="function">init</span>() {
    version.<span class="function">Set</span>(<span class="string">"1.0.0"</span>)
    buildTime.<span class="function">Set</span>(<span class="string">"2024-01-01 00:00:00"</span>)
}</code></pre>
            
            <h4>åœ¨ Web æœåŠ¡å™¨ä¸­ä½¿ç”¨</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"expvar"</span>
    <span class="string">"fmt"</span>
    <span class="string">"net/http"</span>
    <span class="string">"time"</span>
)

<span class="keyword">var</span> (
    requestCount = expvar.<span class="function">NewInt</span>(<span class="string">"request_count"</span>)
    errors       = expvar.<span class="function">NewInt</span>(<span class="string">"errors"</span>)
    avgTime      = expvar.<span class="function">NewFloat</span>(<span class="string">"avg_time_ms"</span>)
)

<span class="function">func</span> <span class="function">handler</span>(w http.ResponseWriter, r *http.Request) {
    start := time.<span class="function">Now</span>()
    
    requestCount.<span class="function">Add</span>(<span class="number">1</span>)
    
    <span class="comment">// æ¨¡æ‹Ÿå¤„ç†</span>
    time.<span class="function">Sleep</span>(time.Millisecond * <span class="number">10</span>)
    
    <span class="comment">// è®¡ç®—å¹³å‡æ—¶é—´</span>
    elapsed := time.<span class="function">Since</span>(start).<span class="function">Milliseconds</span>()
    avgTime.<span class="function">Set</span>(<span class="function">float64</span>(elapsed))
    
    fmt.<span class="function">Fprintln</span>(w, <span class="string">"Hello, World!"</span>)
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// æ³¨å†Œ expvar å¤„ç†å™¨</span>
    http.<span class="function">Handle</span>(<span class="string">"/debug/vars"</span>, expvar.<span class="function">Handler</span>())
    
    <span class="comment">// æ³¨å†Œä¸šåŠ¡å¤„ç†å™¨</span>
    http.<span class="function">HandleFunc</span>(<span class="string">"/"</span>, handler)
    
    fmt.<span class="function">Println</span>(<span class="string">"Server started on :8080"</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Metrics: http://localhost:8080/debug/vars"</span>)
    http.<span class="function">ListenAndServe</span>(<span class="string">":8080"</span>, <span class="keyword">nil</span>)
}</code></pre>
            
            <h3>slog ç»“æ„åŒ–æ—¥å¿—</h3>
            <p>slog æ˜¯ Go 1.21+ å¼•å…¥çš„ç»“æ„åŒ–æ—¥å¿—åº“ï¼Œæä¾›äº†ç»“æ„åŒ–çš„æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œæ¯”ä¼ ç»Ÿçš„ log åŒ…æ›´å¼ºå¤§å’Œçµæ´»ã€‚</p>
            
            <h4>åŸºæœ¬ä½¿ç”¨</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"log/slog"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºé»˜è®¤ logger</span>
    logger := slog.<span class="function">New</span>(slog.<span class="function">NewTextHandler</span>(os.Stdout, <span class="keyword">nil</span>))
    
    <span class="comment">// è®°å½•ä¸åŒçº§åˆ«çš„æ—¥å¿—</span>
    logger.<span class="function">Debug</span>(<span class="string">"Debug message"</span>)
    logger.<span class="function">Info</span>(<span class="string">"Info message"</span>)
    logger.<span class="function">Warn</span>(<span class="string">"Warning message"</span>)
    logger.<span class="function">Error</span>(<span class="string">"Error message"</span>)
}</code></pre>
            
            <h4>ç»“æ„åŒ–å­—æ®µ</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"log/slog"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    logger := slog.<span class="function">New</span>(slog.<span class="function">NewJSONHandler</span>(os.Stdout, <span class="keyword">nil</span>))
    
    <span class="comment">// æ·»åŠ ç»“æ„åŒ–å­—æ®µ</span>
    logger.<span class="function">Info</span>(<span class="string">"User logged in"</span>,
        slog.<span class="function">String</span>(<span class="string">"user_id"</span>, <span class="string">"123"</span>),
        slog.<span class="function">String</span>(<span class="string">"username"</span>, <span class="string">"alice"</span>),
        slog.<span class="function">String</span>(<span class="string">"ip"</span>, <span class="string">"192.168.1.1"</span>),
    )
    
    logger.<span class="function">Error</span>(<span class="string">"Request failed"</span>,
        slog.<span class="function">String</span>(<span class="string">"path"</span>, <span class="string">"/api/users"</span>),
        slog.<span class="function">Int</span>(<span class="string">"status"</span>, <span class="number">500</span>),
        slog.<span class="function">Duration</span>(<span class="string">"duration_ms"</span>, <span class="number">150</span>),
    )
}</code></pre>
            
            <h4>è‡ªå®šä¹‰ Handler</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"encoding/json"</span>
    <span class="string">"log/slog"</span>
    <span class="string">"os"</span>
)

<span class="comment">// è‡ªå®šä¹‰ Handler</span>
<span class="keyword">type</span> CustomHandler <span class="keyword">struct</span> {
    slog.Handler
}

<span class="function">func</span> (h *CustomHandler) <span class="function">Handle</span>(ctx context.Context, r slog.Record) <span class="keyword">error</span> {
    <span class="comment">// æ·»åŠ è‡ªå®šä¹‰å­—æ®µ</span>
    r.<span class="function">AddAttrs</span>(slog.<span class="function">String</span>(<span class="string">"service"</span>, <span class="string">"myapp"</span>))
    <span class="keyword">return</span> h.Handler.<span class="function">Handle</span>(ctx, r)
}

<span class="function">func</span> <span class="function">main</span>() {
    handler := &CustomHandler{
        Handler: slog.<span class="function">NewJSONHandler</span>(os.Stdout, <span class="keyword">nil</span>),
    }
    
    logger := slog.<span class="function">New</span>(handler)
    logger.<span class="function">Info</span>(<span class="string">"Test message"</span>)
}</code></pre>
            
            <h4>æ—¥å¿—çº§åˆ«æ§åˆ¶</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"log/slog"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// è®¾ç½®æ—¥å¿—çº§åˆ«</span>
    opts := &slog.HandlerOptions{
        Level: slog.LevelInfo,
    }
    
    logger := slog.<span class="function">New</span>(slog.<span class="function">NewJSONHandler</span>(os.Stdout, opts))
    
    <span class="comment">// Debug çº§åˆ«çš„æ—¥å¿—ä¸ä¼šè¾“å‡º</span>
    logger.<span class="function">Debug</span>(<span class="string">"Debug message"</span>)
    logger.<span class="function">Info</span>(<span class="string">"Info message"</span>)
}</code></pre>
            
            <h4>ä¸Šä¸‹æ–‡æ”¯æŒ</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"log/slog"</span>
    <span class="string">"os"</span>
)

<span class="keyword">type</span> contextKey <span class="keyword">struct</span>{}

<span class="function">func</span> <span class="function">main</span>() {
    logger := slog.<span class="function">New</span>(slog.<span class="function">NewJSONHandler</span>(os.Stdout, <span class="keyword">nil</span>))
    
    <span class="comment">// åœ¨ä¸Šä¸‹æ–‡ä¸­æ·»åŠ å€¼</span>
    ctx := context.<span class="function">WithValue</span>(context.<span class="function">Background</span>(), contextKey{}, <span class="string">"request-123"</span>)
    
    <span class="comment">// ä½¿ç”¨ä¸Šä¸‹æ–‡è®°å½•æ—¥å¿—</span>
    logger.<span class="function">InfoContext</span>(ctx, <span class="string">"Processing request"</span>)
}</code></pre>
            
            <h4>åˆ†ç»„æ—¥å¿—</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"log/slog"</span>
    <span class="string">"os"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    logger := slog.<span class="function">New</span>(slog.<span class="function">NewJSONHandler</span>(os.Stdout, <span class="keyword">nil</span>))
    
    <span class="comment">// ä½¿ç”¨åˆ†ç»„</span>
    logger.<span class="function">Info</span>(<span class="string">"User action"</span>,
        slog.<span class="function">Group</span>(<span class="string">"user"</span>,
            slog.<span class="function">String</span>(<span class="string">"id"</span>, <span class="string">"123"</span>),
            slog.<span class="function">String</span>(<span class="string">"name"</span>, <span class="string">"alice"</span>),
        ),
        slog.<span class="function">Group</span>(<span class="string">"request"</span>,
            slog.<span class="function">String</span>(<span class="string">"path"</span>, <span class="string">"/api/users"</span>),
            slog.<span class="function">String</span>(<span class="string">"method"</span>, <span class="string">"GET"</span>),
        ),
    )
}</code></pre>
            
            <h4>ä¸ Gin é›†æˆ</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"log/slog"</span>
    <span class="string">"net/http"</span>
    
    <span class="string">"github.com/gin-gonic/gin"</span>
)

<span class="keyword">var</span> logger = slog.<span class="function">New</span>(slog.<span class="function">NewJSONHandler</span>(os.Stdout, <span class="keyword">nil</span>))

<span class="function">func</span> <span class="function">main</span>() {
    r := gin.<span class="function">Default</span>()
    
    <span class="comment">// è‡ªå®šä¹‰ä¸­é—´ä»¶</span>
    r.<span class="function">Use</span>(<span class="keyword">func</span>(c *gin.Context) {
        start := time.<span class="function">Now</span>()
        path := c.<span class="function">Request</span>.URL.Path
        
        c.<span class="function">Next</span>()
        
        logger.<span class="function">Info</span>(<span class="string">"Request"</span>,
            slog.<span class="function">String</span>(<span class="string">"method"</span>, c.<span class="function">Request</span>.Method),
            slog.<span class="function">String</span>(<span class="string">"path"</span>, path),
            slog.<span class="function">Int</span>(<span class="string">"status"</span>, c.<span class="function">Writer</span>().<span class="function">Status</span>()),
            slog.<span class="function">Duration</span>(<span class="string">"duration"</span>, time.<span class="function">Since</span>(start)),
        )
    })
    
    r.<span class="function">GET</span>(<span class="string">"/"</span>, <span class="keyword">func</span>(c *gin.Context) {
        c.<span class="function">String</span>(<span class="number">200</span>, <span class="string">"Hello, World!"</span>)
    })
    
    r.<span class="function">Run</span>(<span class="string">":8080"</span>)
}</code></pre>
            
            <h3>exp æœ€ä½³å®è·µ</h3>
            <div class="note-box">
                <h4>1. expvar ä½¿ç”¨å»ºè®®</h4>
                <ul>
                    <li><strong>ç›‘æ§å…³é”®æŒ‡æ ‡</strong>ï¼šç›‘æ§è¯·æ±‚è®¡æ•°ã€é”™è¯¯è®¡æ•°ã€è¿æ¥æ•°ç­‰å…³é”®æŒ‡æ ‡</li>
                    <li><strong>åŸå­æ“ä½œ</strong>ï¼šä½¿ç”¨ expvar.Int å’Œ expvar.Float ç¡®ä¿çº¿ç¨‹å®‰å…¨</li>
                    <li><strong>åˆç†å‘½å</strong>ï¼šä½¿ç”¨æœ‰æ„ä¹‰çš„å˜é‡åï¼Œä¾¿äºç†è§£</li>
                    <li><strong>å®šæœŸæ¸…ç†</strong>ï¼šé¿å…ç§¯ç´¯è¿‡å¤šçš„ç›‘æ§æ•°æ®</li>
                    <li><strong>å®‰å…¨è€ƒè™‘</strong>ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­é™åˆ¶ /debug/vars çš„è®¿é—®æƒé™</li>
                </ul>
                
                <h4>2. slog ä½¿ç”¨å»ºè®®</h4>
                <ul>
                    <li><strong>ç»“æ„åŒ–å­—æ®µ</strong>ï¼šä½¿ç”¨ç»“æ„åŒ–å­—æ®µè€Œä¸æ˜¯å­—ç¬¦ä¸²æ‹¼æ¥</li>
                    <li><strong>æ—¥å¿—çº§åˆ«</strong>ï¼šåˆç†ä½¿ç”¨ä¸åŒçº§åˆ«çš„æ—¥å¿—</li>
                    <li><strong>ä¸Šä¸‹æ–‡ä¼ é€’</strong>ï¼šä½¿ç”¨ä¸Šä¸‹æ–‡ä¼ é€’è¯·æ±‚ç›¸å…³ä¿¡æ¯</li>
                    <li><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼šé¿å…åœ¨é«˜é¢‘è·¯å¾„ä¸­è®°å½•è¿‡å¤šæ—¥å¿—</li>
                    <li><strong>æ—¥å¿—è½®è½¬</strong>ï¼šé…åˆæ—¥å¿—è½®è½¬å·¥å…·ç®¡ç†æ—¥å¿—æ–‡ä»¶</li>
                </ul>
                
                <h4>3. é›†æˆå»ºè®®</h4>
                <pre><code><span class="comment">// åœ¨åº”ç”¨å¯åŠ¨æ—¶åˆå§‹åŒ–</span>
<span class="function">func</span> <span class="function">InitMonitoring</span>() {
    <span class="comment">// æ³¨å†Œ expvar</span>
    expvar.<span class="function">Publish</span>(<span class="string">"version"</span>, expvar.<span class="function">String</span>(Version))
    expvar.<span class="function">Publish</span>(<span class="string">"build_time"</span>, expvar.<span class="function">String</span>(BuildTime))
    
    <span class="comment">// åˆå§‹åŒ– logger</span>
    opts := &slog.HandlerOptions{
        Level: slog.LevelInfo,
    }
    logger = slog.<span class="function">New</span>(slog.<span class="function">NewJSONHandler</span>(os.Stdout, opts))
}</code></pre>
            </div>

            <div class="note-box">
                <h3>æ€§èƒ½ä¼˜åŒ–å»ºè®®</h3>
                <ul>
                    <li><strong>regexp</strong>ï¼šé¢„ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼ï¼Œé¿å…é‡å¤ç¼–è¯‘</li>
                    <li><strong>sync</strong>ï¼šæ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„é”ç±»å‹ï¼Œé¿å…é”ç«äº‰</li>
                    <li><strong>json</strong>ï¼šä½¿ç”¨æµå¼å¤„ç†å¤§æ–‡ä»¶ï¼Œé¿å…å†…å­˜æº¢å‡º</li>
                    <li><strong>sync.Pool</strong>ï¼šé‡ç”¨å¤§å¯¹è±¡ï¼Œå‡å°‘ GC å‹åŠ›</li>
                    <li><strong>atomic</strong>ï¼šå¯¹ç®€å•ç±»å‹ä½¿ç”¨åŸå­æ“ä½œï¼Œé¿å…é”å¼€é”€</li>
                    <li><strong>expvar</strong>ï¼šä½¿ç”¨åŸå­æ“ä½œæ›´æ–°æŒ‡æ ‡ï¼Œé¿å…é”ç«äº‰</li>
                    <li><strong>slog</strong>ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ JSON æ ¼å¼ï¼Œä¾¿äºæ—¥å¿—åˆ†æ</li>
                </ul>
            </div>
        </div>
    </div>
<script src="code-collapse.js"></script>

</body>
    <script src="navigation.js"></script>
</html>