<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»“æ„ä½“ Embed ä½¿ç”¨ - Go å­¦ä¹ æ•™ç¨‹</title>
    <link rel="stylesheet" href="styles.css?v=1.4">
    </head>
<body>
    <div class="container">
        <aside class="sidebar">
        <!-- å¯¼èˆªæ å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
    </aside>
        <div class="content">
            <a href="structs.html" class="back-link">â† è¿”å›ç»“æ„ä½“</a>
            <h1>ç»“æ„ä½“ Embed ä½¿ç”¨</h1>
            <p class="intro">Go 1.16 å¼•å…¥çš„ embed åŒ…å…è®¸åœ¨ç¼–è¯‘æ—¶å°†é™æ€æ–‡ä»¶åµŒå…¥åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚</p>

            <div class="feature-grid">
                <div class="feature-card">
                    <div class="icon">ğŸ“</div>
                    <h4>æ–‡ä»¶åµŒå…¥</h4>
                    <p>å°†æ–‡ä»¶æ‰“åŒ…è¿›äºŒè¿›åˆ¶</p>
                </div>
                <div class="feature-card">
                    <div class="icon">ğŸ“„</div>
                    <h4>å­—ç¬¦ä¸²</h4>
                    <p>embed string</p>
                </div>
                <div class="feature-card">
                    <div class="icon">ğŸ“‚</div>
                    <h4>å­—èŠ‚åˆ‡ç‰‡</h4>
                    <p>embed []byte</p>
                </div>
                <div class="feature-card">
                    <div class="icon">ğŸ“¦</div>
                    <h4>FS æ¥å£</h4>
                    <p>embed fs.FS</p>
                </div>
            </div>

            <h2>1. åŸºæœ¬ä½¿ç”¨</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"embed"</span>
    <span class="string">"fmt"</span>
)

<span class="comment">//go:embed hello.txt</span>
<span class="keyword">var</span> content <span class="keyword">string</span>

<span class="function">func</span> <span class="function">main</span>() {
    fmt.<span class="function">Println</span>(content)
}</code></pre>

            <h2>2. åµŒå…¥å¤šä¸ªæ–‡ä»¶</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"embed"</span>
    <span class="string">"fmt"</span>
    <span class="string">"io/fs"</span>
)

<span class="comment">//go:embed config.yaml</span>
<span class="keyword">var</span> config <span class="keyword">string</span>

<span class="comment">//go:embed version.txt</span>
<span class="keyword">var</span> version <span class="keyword">string</span>

<span class="function">func</span> <span class="function">main</span>() {
    fmt.<span class="function">Println</span>(<span class="string">"é…ç½®æ–‡ä»¶:"</span>, config)
    fmt.<span class="function">Println</span>(<span class="string">"ç‰ˆæœ¬:"</span>, version)
}</code></pre>

            <h2>3. åµŒå…¥å¤šä¸ªæ–‡ä»¶ï¼ˆé€šé…ç¬¦ï¼‰</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"embed"</span>
    <span class="string">"fmt"</span>
    <span class="string">"io/fs"</span>
)

<span class="comment">//go:embed templates/*.html</span>
<span class="keyword">var</span> templates embed.FS

<span class="function">func</span> <span class="function">main</span>() {
    content, err := templates.<span class="function">ReadFile</span>(<span class="string">"templates/index.html"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"é”™è¯¯:"</span>, err)
        <span class="keyword">return</span>
    }
    fmt.<span class="function">Println</span>(<span class="keyword">string</span>(content))

    <span class="comment">// éå†æ–‡ä»¶</span>
    fs.<span class="function">WalkDir</span>(templates, <span class="string">"."</span>, <span class="keyword">func</span>(path <span class="keyword">string</span>, d fs.DirEntry, err <span class="keyword">error</span>) <span class="keyword">error</span> {
        fmt.<span class="function">Printf</span>(<span class="string">"æ–‡ä»¶: %s\n"</span>, path)
        <span class="keyword">return</span> <span class="keyword">nil</span>
    })
}</code></pre>

            <h2>4. åµŒå…¥æ•´ä¸ªç›®å½•</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"embed"</span>
    <span class="string">"fmt"</span>
    <span class="string">"io/fs"</span>
    <span class="string">"net/http"</span>
)

<span class="comment">//go:embed static/*</span>
<span class="keyword">var</span> staticFiles embed.FS

<span class="function">func</span> <span class="function">main</span>() {
    staticFS, err := fs.<span class="function">Sub</span>(staticFiles, <span class="string">"static"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"é”™è¯¯:"</span>, err)
        <span class="keyword">return</span>
    }
    http.<span class="function">Handle</span>(<span class="string">"/static/"</span>, http.<span class="function">FileServer</span>(http.FS(staticFS)))
    fmt.<span class="function">Println</span>(<span class="string">"æœåŠ¡å™¨å¯åŠ¨åœ¨ http://localhost:8080"</span>)
    http.<span class="function">ListenAndServe</span>(<span class="string">":8080"</span>, <span class="keyword">nil</span>)
}</code></pre>

            <h2>5. åµŒå…¥å¤šä¸ªæ¨¡å¼</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"embed"</span>
    <span class="string">"fmt"</span>
)

<span class="comment">//go:embed config/*.yaml</span>
<span class="comment">//go:embed templates/*.html</span>
<span class="comment">//go:embed static/*</span>
<span class="keyword">var</span> files embed.FS

<span class="function">func</span> <span class="function">main</span>() {
    config, _ := files.<span class="function">ReadFile</span>(<span class="string">"config/app.yaml"</span>)
    template, _ := files.<span class="function">ReadFile</span>(<span class="string">"templates/index.html"</span>)
    fmt.<span class="function">Println</span>(<span class="string">"é…ç½®:"</span>, <span class="keyword">string</span>(config))
    fmt.<span class="function">Println</span>(<span class="string">"æ¨¡æ¿:"</span>, <span class="keyword">string</span>(template))
}</code></pre>

            <h2>6. åµŒå…¥ä¸ºå­—èŠ‚æ•°ç»„</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"embed"</span>
    <span class="string">"fmt"</span>
)

<span class="comment">//go:embed image.png</span>
<span class="keyword">var</span> imageData []<span class="keyword">byte</span>

<span class="function">func</span> <span class="function">main</span>() {
    fmt.<span class="function">Printf</span>(<span class="string">"å›¾ç‰‡å¤§å°: %d å­—èŠ‚\n"</span>, <span class="function">len</span>(imageData))
}</code></pre>

            <h2>7. æ³¨æ„äº‹é¡¹</h2>
            <div class="warning-box">
                <h3>âš ï¸ é‡è¦æç¤º</h3>
                <ul>
                    <li><strong>æŒ‡ä»¤ä½ç½®</strong>ï¼š//go:embed æŒ‡ä»¤å¿…é¡»ç´§é‚»å˜é‡å£°æ˜ï¼Œä¸­é—´ä¸èƒ½æœ‰ç©ºè¡Œ</li>
                    <li><strong>å˜é‡ç±»å‹</strong>ï¼šå¯ä»¥æ˜¯ stringã€[]byte æˆ– embed.FS</li>
                    <li><strong>è·¯å¾„é™åˆ¶</strong>ï¼šåªèƒ½åµŒå…¥å½“å‰åŒ…æ‰€åœ¨ç›®å½•åŠå…¶å­ç›®å½•çš„æ–‡ä»¶</li>
                    <li><strong>æ–‡ä»¶å¤§å°</strong>ï¼šåµŒå…¥å¤§æ–‡ä»¶ä¼šå¢åŠ äºŒè¿›åˆ¶æ–‡ä»¶çš„å¤§å°</li>
                </ul>
            </div>

            <h2>8. æœ€ä½³å®è·µ</h2>
            <div class="info-box">
                <h3>ğŸ’¡ å»ºè®®</h3>
                <ul>
                    <li><strong>é™æ€èµ„æº</strong>ï¼šHTML æ¨¡æ¿ã€CSSã€JavaScriptã€å›¾ç‰‡ç­‰</li>
                    <li><strong>é…ç½®æ–‡ä»¶</strong>ï¼šé»˜è®¤é…ç½®ã€ç¤ºä¾‹é…ç½®ç­‰</li>
                    <li><strong>å•æ–‡ä»¶åº”ç”¨</strong>ï¼šåˆ›å»ºæ— éœ€å¤–éƒ¨ä¾èµ–çš„å¯æ‰§è¡Œæ–‡ä»¶</li>
                    <li><strong>ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šå°†åµŒå…¥çš„æ–‡ä»¶çº³å…¥ç‰ˆæœ¬æ§åˆ¶</li>
                    <li><strong>æµ‹è¯•æ•°æ®</strong>ï¼šå°†æµ‹è¯•æ•°æ®åµŒå…¥åˆ°æµ‹è¯•ä»£ç ä¸­</li>
                </ul>
            </div>
        </div>
    </div>
    <script src="navigation.js"></script>
    <script src="code-collapse.js"></script>
</body>
</html>
