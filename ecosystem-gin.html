<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gin Web 框架 - Go 学习教程</title>
    <link rel="stylesheet" href="styles.css?v=1.3">
    <script src="navigation.js"></script>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
        <!-- 导航栏将通过JavaScript动态加载 -->
    </aside>
                <div class="content">
            <a href="ecosystem.html" class="back-link">← 返回社区库</a>
            <h2 id="gin">Gin Web 框架</h2>
            
            <h3>简介</h3>
            <p>Gin 是一个用 Go 语言编写的高性能 HTTP Web 框架，具有类似 Martini 的 API，但性能更好（高达 40 倍）。它提供了路由、中间件、JSON 验证等功能，是 Go 社区最流行的 Web 框架之一。</p>
            
            <h3>安装</h3>
            <pre><code><span class="keyword">go</span> get -u github.com/gin-gonic/gin</code></pre>
            
            <h3>快速开始</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/gin-gonic/gin"</span>
    <span class="string">"net/http"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// 创建默认路由</span>
    r := gin.<span class="function">Default</span>()

    <span class="comment">// 定义路由</span>
    r.<span class="function">GET</span>(<span class="string">"/ping"</span>, <span class="keyword">func</span>(c *gin.Context) {
        c.<span class="function">JSON</span>(http.StatusOK, gin.H{
            <span class="string">"message"</span>: <span class="string">"pong"</span>,
        })
    })

    <span class="comment">// 启动服务器</span>
    r.<span class="function">Run</span>(<span class="string">":8080"</span>)
}</code></pre>
            
            <h3>路由</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/gin-gonic/gin"</span>
    <span class="string">"net/http"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    r := gin.<span class="function">Default</span>()

    <span class="comment">// GET 请求</span>
    r.<span class="function">GET</span>(<span class="string">"/users"</span>, <span class="keyword">func</span>(c *gin.Context) {
        c.<span class="function">JSON</span>(http.StatusOK, gin.H{
            <span class="string">"users"</span>: []<span class="keyword">string</span>{<span class="string">"Alice"</span>, <span class="string">"Bob"</span>},
        })
    })

    <span class="comment">// POST 请求</span>
    r.<span class="function">POST</span>(<span class="string">"/users"</span>, <span class="keyword">func</span>(c *gin.Context) {
        <span class="keyword">var</span> user <span class="keyword">struct</span> {
            Name  <span class="keyword">string</span> <span class="string">`json:"name"`</span>
            Email <span class="keyword">string</span> <span class="string">`json:"email"`</span>
        }
        
        <span class="keyword">if</span> err := c.<span class="function">ShouldBindJSON</span>(&user); err != <span class="keyword">nil</span> {
            c.<span class="function">JSON</span>(http.StatusBadRequest, gin.H{<span class="string">"error"</span>: err.<span class="function">Error</span>()})
            <span class="keyword">return</span>
        }
        
        c.<span class="function">JSON</span>(http.StatusCreated, gin.H{
            <span class="string">"message"</span>: <span class="string">"User created"</span>,
            <span class="string">"user"</span>:    user,
        })
    })

    <span class="comment">// 路径参数</span>
    r.<span class="function">GET</span>(<span class="string">"/users/:id"</span>, <span class="keyword">func</span>(c *gin.Context) {
        id := c.<span class="function">Param</span>(<span class="string">"id"</span>)
        c.<span class="function">JSON</span>(http.StatusOK, gin.H{<span class="string">"id"</span>: id})
    })

    <span class="comment">// 查询参数</span>
    r.<span class="function">GET</span>(<span class="string">"/search"</span>, <span class="keyword">func</span>(c *gin.Context) {
        query := c.<span class="function">Query</span>(<span class="string">"q"</span>)
        page := c.<span class="function">DefaultQuery</span>(<span class="string">"page"</span>, <span class="string">"1"</span>)
        c.<span class="function">JSON</span>(http.StatusOK, gin.H{
            <span class="string">"query"</span>: query,
            <span class="string">"page"</span>:  page,
        })
    })

    r.<span class="function">Run</span>(<span class="string">":8080"</span>)
}</code></pre>
            
            <h3>中间件</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/gin-gonic/gin"</span>
    <span class="string">"net/http"</span>
    <span class="string">"time"</span>
)

<span class="comment">// 自定义中间件</span>
<span class="function">func</span> <span class="function">Logger</span>() gin.HandlerFunc {
    <span class="keyword">return</span> <span class="keyword">func</span>(c *gin.Context) {
        start := time.<span class="function">Now</span>()
        
        c.<span class="function">Next</span>()
        
        latency := time.<span class="function">Since</span>(start)
        fmt.<span class="function">Printf</span>(<span class="string">"%s %s %v\n"</span>, c.<span class="function">Request</span>.Method, c.<span class="function">Request</span>.URL.Path, latency)
    }
}

<span class="comment">// 认证中间件</span>
<span class="function">func</span> <span class="function">AuthMiddleware</span>() gin.HandlerFunc {
    <span class="keyword">return</span> <span class="keyword">func</span>(c *gin.Context) {
        token := c.<span class="function">GetHeader</span>(<span class="string">"Authorization"</span>)
        
        <span class="keyword">if</span> token == <span class="string">""</span> {
            c.<span class="function">JSON</span>(http.StatusUnauthorized, gin.H{<span class="string">"error"</span>: <span class="string">"Unauthorized"</span>})
            c.<span class="function">Abort</span>()
            <span class="keyword">return</span>
        }
        
        c.<span class="function">Set</span>(<span class="string">"user_id"</span>, <span class="string">"123"</span>)
        c.<span class="function">Next</span>()
    }
}

<span class="function">func</span> <span class="function">main</span>() {
    r := gin.<span class="function">Default</span>()
    
    <span class="comment">// 全局中间件</span>
    r.<span class="function">Use</span>(<span class="function">Logger</span>())
    
    <span class="comment">// 路由组</span>
    api := r.<span class="function">Group</span>(<span class="string">"/api"</span>)
    api.<span class="function">Use</span>(<span class="function">AuthMiddleware</span>())
    
    api.<span class="function">GET</span>(<span class="string">"/profile"</span>, <span class="keyword">func</span>(c *gin.Context) {
        userID := c.<span class="function">GetString</span>(<span class="string">"user_id"</span>)
        c.<span class="function">JSON</span>(http.StatusOK, gin.H{<span class="string">"user_id"</span>: userID})
    })
    
    r.<span class="function">Run</span>(<span class="string">":8080"</span>)
}</code></pre>
            
            <h3>路由组</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/gin-gonic/gin"</span>
    <span class="string">"net/http"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    r := gin.<span class="function">Default</span>()
    
    <span class="comment">// v1 路由组</span>
    v1 := r.<span class="function">Group</span>(<span class="string">"/v1"</span>)
    {
        v1.<span class="function">GET</span>(<span class="string">"/users"</span>, <span class="keyword">func</span>(c *gin.Context) {
            c.<span class="function">String</span>(http.StatusOK, <span class="string">"v1 users"</span>)
        })
        v1.<span class="function">GET</span>(<span class="string">"/posts"</span>, <span class="keyword">func</span>(c *gin.Context) {
            c.<span class="function">String</span>(http.StatusOK, <span class="string">"v1 posts"</span>)
        })
    }
    
    <span class="comment">// v2 路由组</span>
    v2 := r.<span class="function">Group</span>(<span class="string">"/v2"</span>)
    {
        v2.<span class="function">GET</span>(<span class="string">"/users"</span>, <span class="keyword">func</span>(c *gin.Context) {
            c.<span class="function">String</span>(http.StatusOK, <span class="string">"v2 users"</span>)
        })
        v2.<span class="function">GET</span>(<span class="string">"/posts"</span>, <span class="keyword">func</span>(c *gin.Context) {
            c.<span class="function">String</span>(http.StatusOK, <span class="string">"v2 posts"</span>)
        })
    }
    
    r.<span class="function">Run</span>(<span class="string">":8080"</span>)
}</code></pre>
            
            <h3>错误处理</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/gin-gonic/gin"</span>
    <span class="string">"net/http"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    r := gin.<span class="function">Default</span>()
    
    <span class="comment">// 自定义错误处理</span>
    r.<span class="function">NoRoute</span>(<span class="keyword">func</span>(c *gin.Context) {
        c.<span class="function">JSON</span>(http.StatusNotFound, gin.H{
            <span class="string">"error"</span>: <span class="string">"Route not found"</span>,
        })
    })
    
    r.<span class="function">NoMethod</span>(<span class="keyword">func</span>(c *gin.Context) {
        c.<span class="function">JSON</span>(http.StatusMethodNotAllowed, gin.H{
            <span class="string">"error"</span>: <span class="string">"Method not allowed"</span>,
        })
    })
    
    <span class="comment">// Panic 恢复</span>
    r.<span class="function">Use</span>(gin.<span class="function">Recovery</span>())
    
    r.<span class="function">GET</span>(<span class="string">"/panic"</span>, <span class="keyword">func</span>(c *gin.Context) {
        <span class="function">panic</span>(<span class="string">"Something went wrong"</span>)
    })
    
    r.<span class="function">Run</span>(<span class="string">":8080"</span>)
}</code></pre>
            
            
        </div>
    </div>
</body>
</html>