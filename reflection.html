<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åå°„ - Go å­¦ä¹ æ•™ç¨‹</title>
    <link rel="stylesheet" href="styles.css?v=1.3">
    <script src="scroll.js"></script>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <h3>ğŸ“š å­¦ä¹ ç›®å½•</h3>
            <ul>
                <li><a href="index.html">ğŸ  é¦–é¡µ</a></li>
                
                                <li class="level-1">
                    <span class="level-badge">é˜¶æ®µä¸€ï¼šå…¥é—¨</span>
                </li>
                <li class="nav-item">
                    <a href="introduction.html"><span>ğŸ“– 1. Go è¯­è¨€ç®€ä»‹</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="introduction.html#history">Go çš„å†å²</a></li>
                        <li><a href="introduction.html#features">Go çš„ç‰¹ç‚¹</a></li>
                        <li><a href="introduction.html#install">å®‰è£…ä¸é…ç½®</a></li>
                        <li><a href="introduction.html#helloworld">Hello World</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="basics.html"><span>ğŸ”¤ 2. åŸºç¡€è¯­æ³•</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="basics.html#variables">å˜é‡å£°æ˜</a></li>
                        <li><a href="basics.html#datatypes">æ•°æ®ç±»å‹</a></li>
                        <li><a href="basics.html#operators">è¿ç®—ç¬¦</a></li>
                        <li><a href="basics.html#arrays">æ•°ç»„ä¸åˆ‡ç‰‡</a></li>
                        <li><a href="basics.html#maps">æ˜ å°„</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="control-flow.html"><span>ğŸ”„ 3. æ§åˆ¶æµ</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="control-flow.html#if">if è¯­å¥</a></li>
                        <li><a href="control-flow.html#switch">switch è¯­å¥</a></li>
                        <li><a href="control-flow.html#for">for å¾ªç¯</a></li>
                        <li><a href="control-flow.html#defer">defer è¯­å¥</a></li>
                    </ul>
                </li>
                <li class="level-1">
                    <span class="level-badge">é˜¶æ®µäºŒï¼šè¿›é˜¶</span>
                </li>
                <li class="nav-item">
                    <a href="functions.html"><span>âš¡ 4. å‡½æ•°</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="functions.html#basic">åŸºæœ¬å‡½æ•°</a></li>
                        <li><a href="functions.html#multiple">å¤šè¿”å›å€¼</a></li>
                        <li><a href="functions.html#variadic">å¯å˜å‚æ•°</a></li>
                        <li><a href="functions.html#closure">é—­åŒ…</a></li>
                        <li><a href="functions.html#methods">æ–¹æ³•</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="structs.html"><span>ğŸ—ï¸ 5. ç»“æ„ä½“ä¸æ¥å£</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="structs.html#struct">ç»“æ„ä½“</a></li>
                        <li><a href="structs.html#nested">åµŒå¥—ç»“æ„ä½“</a></li>
                        <li><a href="structs.html#methods">ç»“æ„ä½“æ–¹æ³•</a></li>
                        <li><a href="structs.html#interface">æ¥å£</a></li>
                        <li><a href="structs.html#tags">ç»“æ„ä½“æ ‡ç­¾</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="modules.html"><span>ğŸ“¦ 6. æ¨¡å—åŒ–ä¸ Go Module</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="modules.html#introduction">Go Module ç®€ä»‹</a></li>
                        <li><a href="modules.html#init">åˆå§‹åŒ– Module</a></li>
                        <li><a href="modules.html#dependency">ä¾èµ–ç®¡ç†</a></li>
                        <li><a href="modules.html#version">ç‰ˆæœ¬æ§åˆ¶</a></li>
                        <li><a href="modules.html#private">ç§æœ‰ Module</a></li>
                    </ul>
                </li>
                <li class="level-1">
                    <span class="level-badge">é˜¶æ®µä¸‰ï¼šé«˜çº§</span>
                </li>
                <li class="nav-item">
                    <a href="concurrency.html"><span>ğŸš€ 7. å¹¶å‘ç¼–ç¨‹</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="concurrency.html#goroutine">Goroutine</a></li>
                        <li><a href="concurrency.html#channel">Channel</a></li>
                        <li><a href="concurrency.html#select">Select</a></li>
                        <li><a href="concurrency.html#mutex">äº’æ–¥é”</a></li>
                        <li><a href="concurrency.html#context">Context</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="embed.html"><span>ğŸ“ 8. Embed æ ‡å‡†åº“</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="embed.html#introduction">Embed ç®€ä»‹</a></li>
                        <li><a href="embed.html#basics">åŸºç¡€ç”¨æ³•</a></li>
                        <li><a href="embed.html#filesystem">æ–‡ä»¶ç³»ç»Ÿ</a></li>
                        <li><a href="embed.html#advanced">é«˜çº§ç”¨æ³•</a></li>
                        <li><a href="embed.html#bestpractices">æœ€ä½³å®è·µ</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="stdlib.html"><span>ğŸ“š 9. å¸¸ç”¨æ ‡å‡†åº“</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="stdlib.html#regexp">regexp æ­£åˆ™è¡¨è¾¾å¼</a></li>
                        <li><a href="stdlib.html#sync">sync å¹¶å‘åŸè¯­</a></li>
                        <li><a href="stdlib.html#json">json æ•°æ®ç¼–ç </a></li>
                        <li><a href="stdlib.html#time">time æ—¶é—´å¤„ç†</a></li>
                        <li><a href="stdlib.html#io">io è¾“å…¥è¾“å‡º</a></li>
                        <li><a href="stdlib.html#bufio">bufio ç¼“å†² I/O</a></li>
                        <li><a href="stdlib.html#exp">exp å®éªŒæ€§åº“</a></li>
                        <li><a href="stdlib.html#bestpractices">æœ€ä½³å®è·µ</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="tips.html"><span>ğŸ’¡ 10. å¸¸ç”¨æŠ€å·§ä¸æœ€ä½³å®è·µ</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="tips.html#idioms">æƒ¯ç”¨æ¨¡å¼</a></li>
                        <li><a href="tips.html#performance">æ€§èƒ½ä¼˜åŒ–</a></li>
                        <li><a href="tips.html#error">é”™è¯¯å¤„ç†</a></li>
                        <li><a href="tips.html#testing">æµ‹è¯•æŠ€å·§</a></li>
                        <li><a href="tips.html#debug">è°ƒè¯•æŠ€å·§</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="ecosystem.html"><span>ğŸŒ 11. ç¤¾åŒºåº“</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="ecosystem.html#gin">Gin Web æ¡†æ¶</a></li>
                        <li><a href="ecosystem.html#gorm">GORM ORM</a></li>
                        <li><a href="ecosystem.html#viper">Viper é…ç½®</a></li>
                        <li><a href="ecosystem.html#zap">Zap æ—¥å¿—</a></li>
                        <li><a href="ecosystem.html#validator">Validator å‚æ•°æ ¡éªŒ</a></li>
                        <li><a href="ecosystem.html#cobra">Cobra å‘½ä»¤è¡Œå·¥å…·</a></li>
                        <li><a href="ecosystem.html#gomicro">Go-Micro å¾®æœåŠ¡</a></li>
                        <li><a href="ecosystem.html#etcd">Etcd åˆ†å¸ƒå¼å­˜å‚¨</a></li>
                        <li><a href="ecosystem.html#bestpractices">æœ€ä½³å®è·µ</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="generics.html"><span>ğŸ§© 12. æ³›å‹</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="generics.html#functions">æ³›å‹å‡½æ•°</a></li>
                        <li><a href="generics.html#types">æ³›å‹ç±»å‹</a></li>
                        <li><a href="generics.html#constraints">ç±»å‹çº¦æŸ</a></li>
                        <li><a href="generics.html#inference">ç±»å‹æ¨æ–­</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="reflection.html"><span>ğŸ” 13. åå°„</span><span class="nav-toggle">â–¼</span></a>
                    <ul class="nav-submenu">
                        <li><a href="reflection.html#typevalue">Type å’Œ Value</a></li>
                        <li><a href="reflection.html#struct">ç»“æ„ä½“åå°„</a></li>
                        <li><a href="reflection.html#modify">ä¿®æ”¹å€¼</a></li>
                        <li><a href="reflection.html#methods">è°ƒç”¨æ–¹æ³•</a></li>
                        <li><a href="reflection.html#performance">æ€§èƒ½è€ƒè™‘</a></li>
                    </ul>
                </li>

        </aside>
        <div class="content">
            <a href="index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
            <h1>åå°„ï¼ˆReflectionï¼‰</h1>

            <h2 id="intro">ä»€ä¹ˆæ˜¯åå°„ï¼Ÿ</h2>
            <p>åå°„æ˜¯ç¨‹åºåœ¨è¿è¡Œæ—¶æ£€æŸ¥å˜é‡ç±»å‹å’Œå€¼çš„èƒ½åŠ›ã€‚Go çš„åå°„é€šè¿‡ `reflect` åŒ…æä¾›ï¼Œå…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°è·å–ç±»å‹ä¿¡æ¯ã€è°ƒç”¨æ–¹æ³•å’Œä¿®æ”¹å€¼ã€‚</p>

            <div class="note-box">
                <h3>åå°„çš„åŸºæœ¬æ¦‚å¿µ</h3>
                <ul>
                    <li><strong>Typeï¼š</strong>è¡¨ç¤º Go çš„ç±»å‹ï¼Œå¦‚ intã€stringã€struct ç­‰</li>
                    <li><strong>Valueï¼š</strong>è¡¨ç¤º Go çš„å€¼ï¼ŒåŒ…å«ç±»å‹å’Œå®é™…å€¼</li>
                    <li><strong>Kindï¼š</strong>è¡¨ç¤ºç±»å‹çš„ç§ç±»ï¼Œå¦‚ Intã€Stringã€Struct ç­‰</li>
                </ul>
            </div>

            <h2 id="typevalue">reflect.Type å’Œ reflect.Value</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"reflect"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="keyword">var</span> x <span class="keyword">int</span> = <span class="number">42</span>

    <span class="comment">// è·å–ç±»å‹å’Œå€¼</span>
    t := reflect.<span class="function">TypeOf</span>(x)
    v := reflect.<span class="function">ValueOf</span>(x)

    fmt.<span class="function">Println</span>(<span class="string">"ç±»å‹:"</span>, t)
    fmt.<span class="function">Println</span>(<span class="string">"å€¼:"</span>, v)
    fmt.<span class="function">Println</span>(<span class="string">"ç±»å‹ç§ç±»:"</span>, t.<span class="function">Kind</span>())
    fmt.<span class="function">Println</span>(<span class="string">"å€¼çš„ç§ç±»:"</span>, v.<span class="function">Kind</span>())
}</code></pre>

            <h2 id="basic">åŸºæœ¬ç±»å‹åå°„</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"reflect"</span>
)

<span class="function">func</span> <span class="function">inspect</span>(value <span class="keyword">interface</span>{}) {
    v := reflect.<span class="function">ValueOf</span>(value)
    t := v.<span class="function">Type</span>()

    fmt.<span class="function">Printf</span>(<span class="string">"ç±»å‹: %s, ç§ç±»: %s, å€¼: %v\n"</span>, t, t.<span class="function">Kind</span>(), v)

    <span class="keyword">switch</span> v.<span class="function">Kind</span>() {
    <span class="keyword">case</span> reflect.Int, reflect.Int8, reflect.Int16, reflect.Int32, reflect.Int64:
        fmt.<span class="function">Printf</span>(<span class="string">"  æ•´æ•°å€¼: %d\n"</span>, v.<span class="function">Int</span>())
    <span class="keyword">case</span> reflect.Uint, reflect.Uint8, reflect.Uint16, reflect.Uint32, reflect.Uint64:
        fmt.<span class="function">Printf</span>(<span class="string">"  æ— ç¬¦å·æ•´æ•°å€¼: %d\n"</span>, v.<span class="function">Uint</span>())
    <span class="keyword">case</span> reflect.Float32, reflect.Float64:
        fmt.<span class="function">Printf</span>(<span class="string">"  æµ®ç‚¹æ•°å€¼: %f\n"</span>, v.<span class="function">Float</span>())
    <span class="keyword">case</span> reflect.String:
        fmt.<span class="function">Printf</span>(<span class="string">"  å­—ç¬¦ä¸²å€¼: %s, é•¿åº¦: %d\n"</span>, v.<span class="function">String</span>(), v.<span class="function">Len</span>())
    <span class="keyword">case</span> reflect.Bool:
        fmt.<span class="function">Printf</span>(<span class="string">"  å¸ƒå°”å€¼: %v\n"</span>, v.<span class="function">Bool</span>())
    }
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="function">inspect</span>(<span class="number">42</span>)
    <span class="function">inspect</span>(<span class="number">3.14</span>)
    <span class="function">inspect</span>(<span class="string">"Hello, Go!"</span>)
    <span class="function">inspect</span>(<span class="keyword">true</span>)
    <span class="function">inspect</span>(<span class="keyword">uint</span>(<span class="number">100</span>))
}</code></pre>

            <h2 id="struct">ç»“æ„ä½“åå°„</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"reflect"</span>
)

<span class="keyword">type</span> Person <span class="keyword">struct</span> {
    Name    <span class="keyword">string</span> `json:"name" db:"person_name"`
    Age     <span class="keyword">int</span>    `json:"age" db:"person_age"`
    Email   <span class="keyword">string</span> `json:"email" db:"person_email"`
    Address <span class="keyword">string</span> `json:"address,omitempty"`
}

<span class="function">func</span> <span class="function">printStructInfo</span>(s <span class="keyword">interface</span>{}) {
    v := reflect.<span class="function">ValueOf</span>(s)
    t := v.<span class="function">Type</span>()

    fmt.<span class="function">Println</span>(<span class="string">"ç»“æ„ä½“ç±»å‹:"</span>, t.<span class="function">Name</span>())
    fmt.<span class="function">Println</span>(<span class="string">"å­—æ®µæ•°é‡:"</span>, t.<span class="function">NumField</span>())

    <span class="keyword">for</span> i := <span class="number">0</span>; i < t.<span class="function">NumField</span>(); i++ {
        field := t.<span class="function">Field</span>(i)
        fieldValue := v.<span class="function">Field</span>(i)

        fmt.<span class="Function">Printf</span>(<span class="string">"  å­—æ®µ %d:\n"</span>, i)
        fmt.<span class="Function">Printf</span>(<span class="string">"    åç§°: %s\n"</span>, field.Name)
        fmt.<span class="Function">Printf</span>(<span class="string">"    ç±»å‹: %s\n"</span>, field.Type)
        fmt.<span class="Function">Printf</span>(<span class="string">"    å€¼: %v\n"</span>, fieldValue.<span class="function">Interface</span>())
        fmt.<span class="Function">Printf</span>(<span class="string">"    æ ‡ç­¾: %s\n"</span>, field.Tag)
    }
}

<span class="function">func</span> <span class="function">main</span>() {
    person := Person{
        Name:    <span class="string">"å¼ ä¸‰"</span>,
        Age:     <span class="number">25</span>,
        Email:   <span class="string">"zhangsan@example.com"</span>,
        Address: <span class="string">"åŒ—äº¬å¸‚"</span>,
    }

    <span class="function">printStructInfo</span>(person)
}</code></pre>

            <h2 id="modify">ä¿®æ”¹å€¼</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"reflect"</span>
)

<span class="function">func</span> <span class="function">modifyValue</span>(value <span class="keyword">interface</span>{}) {
    v := reflect.<span class="function">ValueOf</span>(value)

    <span class="comment">// æ£€æŸ¥æ˜¯å¦å¯è®¾ç½®</span>
    <span class="keyword">if</span> v.<span class="function">CanSet</span>() {
        <span class="keyword">switch</span> v.<span class="function">Kind</span>() {
        <span class="keyword">case</span> reflect.Int:
            v.<span class="function">SetInt</span>(<span class="number">100</span>)
        <span class="keyword">case</span> reflect.String:
            v.<span class="function">SetString</span>(<span class="string">"Modified"</span>)
        <span class="keyword">case</span> reflect.Bool:
            v.<span class="function">SetBool</span>(<span class="keyword">true</span>)
        }
    }
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ä½¿ç”¨æŒ‡é’ˆæ‰èƒ½ä¿®æ”¹å€¼</span>
    x := <span class="number">42</span>
    <span class="function">modifyValue</span>(&x)
    fmt.<span class="function">Println</span>(<span class="string">"ä¿®æ”¹å:"</span>, x)

    s := <span class="string">"Hello"</span>
    <span class="function">modifyValue</span>(&s)
    fmt.<span class="function">Println</span>(<span class="string">"ä¿®æ”¹å:"</span>, s)
}</code></pre>

            <h2 id="modifyfield">é€šè¿‡æŒ‡é’ˆä¿®æ”¹ç»“æ„ä½“å­—æ®µ</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"reflect"</span>
)

<span class="keyword">type</span> User <span class="keyword">struct</span> {
    Name  <span class="keyword">string</span>
    Age   <span class="keyword">int</span>
    Email <span class="keyword">string</span>
}

<span class="function">func</span> <span class="function">setField</span>(obj <span class="keyword">interface</span>{}, fieldName <span class="keyword">string</span>, newValue <span class="keyword">interface</span>{}) {
    v := reflect.<span class="function">ValueOf</span>(obj)

    <span class="comment">// è§£å¼•ç”¨æŒ‡é’ˆ</span>
    <span class="keyword">if</span> v.<span class="function">Kind</span>() == reflect.Ptr {
        v = v.<span class="function">Elem</span>()
    }

    <span class="comment">// è·å–å­—æ®µ</span>
    field := v.<span class="function">FieldByName</span>(fieldName)

    <span class="keyword">if</span> field.<span class="function">IsValid</span>() && field.<span class="function">CanSet</span>() {
        newVal := reflect.<span class="function">ValueOf</span>(newValue)
        <span class="keyword">if</span> newVal.<span class="function">Type</span>().<span class="function">AssignableTo</span>(field.<span class="function">Type</span>()) {
            field.<span class="function">Set</span>(newVal)
            fmt.<span class="function">Printf</span>(<span class="string">"æˆåŠŸè®¾ç½® %s = %v\n"</span>, fieldName, newValue)
        } <span class="keyword">else</span> {
            fmt.<span class="function">Printf</span>(<span class="string">"ç±»å‹ä¸åŒ¹é…: æ— æ³•å°† %v è®¾ç½®ä¸º %s\n"</span>, newVal.<span class="function">Type</span>(), field.<span class="function">Type</span>())
        }
    } <span class="keyword">else</span> {
        fmt.<span class="function">Printf</span>(<span class="string">"å­—æ®µ %s ä¸å­˜åœ¨æˆ–ä¸å¯è®¾ç½®\n"</span>, fieldName)
    }
}

<span class="function">func</span> <span class="function">main</span>() {
    user := User{
        Name:  <span class="string">"å¼ ä¸‰"</span>,
        Age:   <span class="number">25</span>,
        Email: <span class="string">"zhangsan@example.com"</span>,
    }

    fmt.<span class="function">Println</span>(<span class="string">"ä¿®æ”¹å‰:"</span>, user)

    <span class="function">setField</span>(&user, <span class="string">"Name"</span>, <span class="string">"æå››"</span>)
    <span class="function">setField</span>(&user, <span class="string">"Age"</span>, <span class="number">30</span>)
    <span class="function">setField</span>(&user, <span class="string">"Email"</span>, <span class="string">"lisi@example.com"</span>)

    fmt.<span class="function">Println</span>(<span class="string">"ä¿®æ”¹å:"</span>, user)
}</code></pre>

            <h2 id="methods">è°ƒç”¨æ–¹æ³•</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"reflect"</span>
)

<span class="keyword">type</span> Calculator <span class="keyword">struct</span> {
    result <span class="keyword">float64</span>
}

<span class="function">func</span> (c *Calculator) <span class="function">Add</span>(a, b <span class="keyword">float64</span>) <span class="keyword">float64</span> {
    c.result = a + b
    <span class="keyword">return</span> c.result
}

<span class="function">func</span> (c *Calculator) <span class="function">Subtract</span>(a, b <span class="keyword">float64</span>) <span class="keyword">float64</span> {
    c.result = a - b
    <span class="keyword">return</span> c.result
}

<span class="function">func</span> (c *Calculator) <span class="function">GetResult</span>() <span class="keyword">float64</span> {
    <span class="keyword">return</span> c.result
}

<span class="function">func</span> <span class="function">callMethod</span>(obj <span class="keyword">interface</span>{}, methodName <span class="keyword">string</span>, args ...<span class="keyword">interface</span>{}) {
    v := reflect.<span class="function">ValueOf</span>(obj)

    <span class="comment">// è§£å¼•ç”¨æŒ‡é’ˆ</span>
    <span class="keyword">if</span> v.<span class="function">Kind</span>() == reflect.Ptr {
        v = v.<span class="function">Elem</span>()
    }

    method := v.<span class="function">MethodByName</span>(methodName)

    <span class="keyword">if</span> method.<span class="function">IsValid</span>() {
        <span class="comment">// å‡†å¤‡å‚æ•°</span>
        in := <span class="function">make</span>([]reflect.Value, <span class="function">len</span>(args))
        <span class="keyword">for</span> i, arg := <span class="keyword">range</span> args {
            in[i] = reflect.<span class="function">ValueOf</span>(arg)
        }

        <span class="comment">// è°ƒç”¨æ–¹æ³•</span>
        results := method.<span class="function">Call</span>(in)

        <span class="comment">// è¾“å‡ºç»“æœ</span>
        <span class="keyword">for</span> _, result := <span class="keyword">range</span> results {
            fmt.<span class="function">Printf</span>(<span class="string">"ç»“æœ: %v\n"</span>, result.<span class="function">Interface</span>())
        }
    } <span class="keyword">else</span> {
        fmt.<span class="function">Printf</span>(<span class="string">"æ–¹æ³• %s ä¸å­˜åœ¨\n"</span>, methodName)
    }
}

<span class="function">func</span> <span class="function">main</span>() {
    calc := &Calculator{}

    <span class="function">callMethod</span>(calc, <span class="string">"Add"</span>, <span class="number">10.0</span>, <span class="number">5.0</span>)
    <span class="function">callMethod</span>(calc, <span class="string">"Subtract"</span>, <span class="number">20.0</span>, <span class="number">8.0</span>)
    <span class="function">callMethod</span>(calc, <span class="string">"GetResult"</span>)
}</code></pre>

            <h2 id="slicemap">åˆ‡ç‰‡å’Œæ˜ å°„åå°„</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"reflect"</span>
)

<span class="function">func</span> <span class="function">inspectSlice</span>(s <span class="keyword">interface</span>{}) {
    v := reflect.<span class="function">ValueOf</span>(s)

    <span class="keyword">if</span> v.<span class="function">Kind</span>() == reflect.Slice {
        fmt.<span class="function">Printf</span>(<span class="string">"åˆ‡ç‰‡é•¿åº¦: %d, å®¹é‡: %d\n"</span>, v.<span class="function">Len</span>(), v.<span class="function">Cap</span>())
        fmt.<span class="function">Println</span>(<span class="string">"å…ƒç´ :"</span>)

        <span class="keyword">for</span> i := <span class="number">0</span>; i < v.<span class="function">Len</span>(); i++ {
            fmt.<span class="function">Printf</span>(<span class="string">"  [%d]: %v\n"</span>, i, v.<span class="function">Index</span>(i).<span class="function">Interface</span>())
        }
    }
}

<span class="function">func</span> <span class="function">inspectMap</span>(m <span class="keyword">interface</span>{}) {
    v := reflect.<span class="function">ValueOf</span>(m)

    <span class="keyword">if</span> v.<span class="function">Kind</span>() == reflect.Map {
        fmt.<span class="function">Printf</span>(<span class="string">"Map é•¿åº¦: %d\n"</span>, v.<span class="function">Len</span>())
        fmt.<span class="function">Println</span>(<span class="string">"é”®å€¼å¯¹:"</span>)

        <span class="keyword">for</span> _, key := <span class="keyword">range</span> v.<span class="function">MapKeys</span>() {
            value := v.<span class="function">MapIndex</span>(key)
            fmt.<span class="function">Printf</span>(<span class="string">"  %v: %v\n"</span>, key.<span class="function">Interface</span>(), value.<span class="function">Interface</span>())
        }
    }
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ‡ç‰‡</span>
    numbers := []<span class="keyword">int</span>{<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>}
    <span class="function">inspectSlice</span>(numbers)

    <span class="comment">// æ˜ å°„</span>
    colors := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>{
        <span class="string">"red"</span>:   <span class="string">"#FF0000"</span>,
        <span class="string">"green"</span>: <span class="string">"#00FF00"</span>,
        <span class="string">"blue"</span>:  <span class="string">"#0000FF"</span>,
    }
    <span class="function">inspectMap</span>(colors)
}</code></pre>

            <h2 id="create">åŠ¨æ€åˆ›å»ºå®ä¾‹</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"reflect"</span>
)

<span class="keyword">type</span> Product <span class="keyword">struct</span> {
    Name  <span class="keyword">string</span>
    Price <span class="keyword">float64</span>
}

<span class="function">func</span> <span class="function">newInstance</span>(typ reflect.Type) <span class="keyword">interface</span>{
    <span class="comment">// åˆ›å»ºæ–°å®ä¾‹</span>
    value := reflect.<span class="function">New</span>(typ).<span class="function">Elem</span>()
    <span class="keyword">return</span> value.<span class="function">Interface</span>()
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// é€šè¿‡ç±»å‹åˆ›å»ºå®ä¾‹</span>
    productType := reflect.<span class="function">TypeOf</span>(Product{})
    newProduct := <span class="function">newInstance</span>(productType)

    fmt.<span class="function">Printf</span>(<span class="string">"æ–°å®ä¾‹ç±»å‹: %T\n"</span>, newProduct)
    fmt.<span class="function">Printf</span>(<span class="string">"æ–°å®ä¾‹å€¼: %+v\n"</span>, newProduct)
}</code></pre>

            <h2 id="json">åå°„çš„å®é™…åº”ç”¨ï¼šJSON åºåˆ—åŒ–</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"fmt"</span>
    <span class="string">"reflect"</span>
    <span class="string">"strings"</span>
)

<span class="keyword">type</span> Student <span class="keyword">struct</span> {
    ID     <span class="keyword">int</span>    `json:"id"`
    Name   <span class="keyword">string</span> `json:"name"`
    Age    <span class="keyword">int</span>    `json:"age"`
    Active <span class="keyword">bool</span>   `json:"active"`
}

<span class="function">func</span> <span class="function">toJSON</span>(obj <span class="keyword">interface</span>{}) <span class="keyword">string</span> {
    data, err := json.<span class="function">Marshal</span>(obj)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="string">""</span>
    }
    <span class="keyword">return</span> <span class="keyword">string</span>(data)
}

<span class="function">func</span> <span class="function">fromJSON</span>(jsonStr <span class="keyword">string</span>, obj <span class="keyword">interface</span>{}) {
    err := json.<span class="function">Unmarshal</span>([]<span class="keyword">byte</span>(jsonStr), obj)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"è§£æé”™è¯¯:"</span>, err)
    }
}

<span class="function">func</span> <span class="function">main</span>() {
    student := Student{
        ID:     <span class="number">1</span>,
        Name:   <span class="string">"å¼ ä¸‰"</span>,
        Age:    <span class="number">20</span>,
        Active: <span class="keyword">true</span>,
    }

    <span class="comment">// åºåˆ—åŒ–ä¸º JSON</span>
    jsonStr := <span class="function">toJSON</span>(student)
    fmt.<span class="function">Println</span>(<span class="string">"JSON:"</span>, jsonStr)

    <span class="comment">// ä» JSON ååºåˆ—åŒ–</span>
    <span class="keyword">var</span> newStudent Student
    <span class="function">fromJSON</span>(jsonStr, &newStudent)
    fmt.<span class="function">Printf</span>(<span class="string">"ååºåˆ—åŒ–: %+v\n"</span>, newStudent)
}</code></pre>

            <h2 id="performance">åå°„çš„æ€§èƒ½è€ƒè™‘</h2>

            <div class="note-box">
                <h3>åå°„çš„æ€§èƒ½å¼€é”€</h3>
                <ul>
                    <li>åå°„æ¯”ç›´æ¥è°ƒç”¨æ…¢å¾ˆå¤š</li>
                    <li>åå°„æ“ä½œä¼šç»•è¿‡ç¼–è¯‘å™¨çš„ç±»å‹æ£€æŸ¥</li>
                    <li>åå°„ä»£ç æ›´éš¾è°ƒè¯•å’Œç»´æŠ¤</li>
                </ul>
            </div>

            <div class="example-box">
                <h3>æœ€ä½³å®è·µ</h3>
                <ul>
                    <li>åªåœ¨å¿…è¦æ—¶ä½¿ç”¨åå°„ï¼ˆå¦‚åºåˆ—åŒ–ã€ORMã€ä¾èµ–æ³¨å…¥ç­‰ï¼‰</li>
                    <li>ç¼“å­˜åå°„ç»“æœä»¥æé«˜æ€§èƒ½</li>
                    <li>è€ƒè™‘ä½¿ç”¨ä»£ç ç”Ÿæˆæ›¿ä»£åå°„</li>
                    <li>åœ¨æ€§èƒ½å…³é”®è·¯å¾„ä¸Šé¿å…ä½¿ç”¨åå°„</li>
                </ul>
            </div>

            <h2 id="interface">åå°„ä¸æ¥å£</h2>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"reflect"</span>
)

<span class="keyword">type</span> Writer <span class="keyword">interface</span> {
    <span class="function">Write</span>(data <span class="keyword">string</span>) <span class="keyword">error</span>
}

<span class="keyword">type</span> File <span class="keyword">struct</span> {
    name <span class="keyword">string</span>
}

<span class="function">func</span> (f *File) <span class="function">Write</span>(data <span class="keyword">string</span>) <span class="keyword">error</span> {
    fmt.<span class="function">Printf</span>(<span class="string">"å†™å…¥æ–‡ä»¶ %s: %s\n"</span>, f.name, data)
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="function">func</span> <span class="function">checkInterface</span>(obj <span class="keyword">interface</span>{}) {
    v := reflect.<span class="function">ValueOf</span>(obj)
    t := v.<span class="function">Type</span>()

    <span class="comment">// æ£€æŸ¥æ˜¯å¦å®ç°äº†æ¥å£</span>
    writerType := reflect.<span class="function">TypeOf</span>((*Writer)(<span class="keyword">nil</span>)).<span class="function">Elem</span>()
    <span class="keyword">if</span> t.<span class="function">Implements</span>(writerType) {
        fmt.<span class="function">Println</span>(<span class="string">"å®ç°äº† Writer æ¥å£"</span>)

        <span class="comment">// è°ƒç”¨æ¥å£æ–¹æ³•</span>
        method := v.<span class="function">MethodByName</span>(<span class="string">"Write"</span>)
        results := method.<span class="function">Call</span>([]reflect.Value{reflect.<span class="function">ValueOf</span>(<span class="string">"Hello, Reflection!"</span>)})
        fmt.<span class="function">Println</span>(<span class="string">"æ–¹æ³•è¿”å›:"</span>, results[<span class="number">0</span>].<span class="function">Interface</span>())
    } <span class="keyword">else</span> {
        fmt.<span class="function">Println</span>(<span class="string">"æœªå®ç° Writer æ¥å£"</span>)
    }
}

<span class="function">func</span> <span class="function">main</span>() {
    file := &File{name: <span class="string">"test.txt"</span>}
    <span class="function">checkInterface</span>(file)

    <span class="keyword">var</span> x <span class="keyword">int</span> = <span class="number">42</span>
    <span class="function">checkInterface</span>(x)
}</code></pre>
        </div>
    </div>
</body>
</html>