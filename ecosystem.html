<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¤¾åŒºåº“ - Go å­¦ä¹ æ•™ç¨‹</title>
    <link rel="stylesheet" href="styles.css?v=1.4">
    <script src="scroll.js"></script>
    </head>
<body>
    <div class="container">
        <aside class="sidebar">
        <!-- å¯¼èˆªæ å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
    </aside>
        <div class="content">
            <a href="index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
            <h1>ç¤¾åŒºåº“</h1>
            <p class="intro">Go è¯­è¨€æ‹¥æœ‰æ´»è·ƒçš„ç¤¾åŒºå’Œä¸°å¯Œçš„ç¬¬ä¸‰æ–¹åº“ï¼Œæ¶µç›– Web å¼€å‘ã€æ•°æ®åº“ã€äº‘åŸç”Ÿç­‰é¢†åŸŸã€‚</p>

            <div class="feature-grid">
                <div class="feature-card">
                    <div class="icon">ğŸŒ</div>
                    <h4>Web æ¡†æ¶</h4>
                    <p>Ginã€Echoã€Fiber</p>
                </div>
                <div class="feature-card">
                    <div class="icon">ğŸ—„ï¸</div>
                    <h4>ORM</h4>
                    <p>GORMã€XORM</p>
                </div>
                <div class="feature-card">
                    <div class="icon">âš™ï¸</div>
                    <h4>é…ç½®</h4>
                    <p>Viper</p>
                </div>
                <div class="feature-card">
                    <div class="icon">ğŸ“</div>
                    <h4>æ—¥å¿—</h4>
                    <p>Zapã€logrus</p>
                </div>
                <div class="feature-card">
                    <div class="icon">ğŸ§ª</div>
                    <h4>æµ‹è¯•</h4>
                    <p>Testifyã€gomock</p>
                </div>
                <div class="feature-card">
                    <div class="icon">â˜ï¸</div>
                    <h4>äº‘åŸç”Ÿ</h4>
                    <p>gRPCã€K8s å®¢æˆ·ç«¯</p>
                </div>
            </div>
            
            <p>Go è¯­è¨€æ‹¥æœ‰æ´»è·ƒçš„ç¤¾åŒºå’Œä¸°å¯Œçš„ç¬¬ä¸‰æ–¹åº“ã€‚æœ¬ç« å°†ä»‹ç» Go ç”Ÿæ€ä¸­æœ€æµè¡Œçš„å‡ ä¸ªåº“ï¼šGinï¼ˆWeb æ¡†æ¶ï¼‰ã€GORMï¼ˆORMï¼‰ã€Viperï¼ˆé…ç½®ï¼‰å’Œ Zapï¼ˆæ—¥å¿—ï¼‰ã€‚</p>

            <h2 id="gin">Gin Web æ¡†æ¶</h2>
            
            <h3>ç®€ä»‹</h3>
            <p>Gin æ˜¯ä¸€ä¸ªç”¨ Go è¯­è¨€ç¼–å†™çš„é«˜æ€§èƒ½ HTTP Web æ¡†æ¶ï¼Œå…·æœ‰ç±»ä¼¼ Martini çš„ APIï¼Œä½†æ€§èƒ½æ›´å¥½ï¼ˆé«˜è¾¾ 40 å€ï¼‰ã€‚å®ƒæä¾›äº†è·¯ç”±ã€ä¸­é—´ä»¶ã€JSON éªŒè¯ç­‰åŠŸèƒ½ï¼Œæ˜¯ Go ç¤¾åŒºæœ€æµè¡Œçš„ Web æ¡†æ¶ä¹‹ä¸€ã€‚</p>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get -u github.com/gin-gonic/gin</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/gin-gonic/gin"</span>
    <span class="string">"net/http"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºé»˜è®¤è·¯ç”±</span>
    r := gin.<span class="function">Default</span>()

    <span class="comment">// å®šä¹‰è·¯ç”±</span>
    r.<span class="function">GET</span>(<span class="string">"/ping"</span>, <span class="keyword">func</span>(c *gin.Context) {
        c.<span class="function">JSON</span>(http.StatusOK, gin.H{
            <span class="string">"message"</span>: <span class="string">"pong"</span>,
        })
    })

    <span class="comment">// å¯åŠ¨æœåŠ¡å™¨</span>
    r.<span class="function">Run</span>(<span class="string">":8080"</span>)
}</code></pre>
            
            <h3>è·¯ç”±</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/gin-gonic/gin"</span>
    <span class="string">"net/http"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    r := gin.<span class="function">Default</span>()

    <span class="comment">// GET è¯·æ±‚</span>
    r.<span class="function">GET</span>(<span class="string">"/users"</span>, <span class="keyword">func</span>(c *gin.Context) {
        c.<span class="function">JSON</span>(http.StatusOK, gin.H{
            <span class="string">"users"</span>: []<span class="keyword">string</span>{<span class="string">"Alice"</span>, <span class="string">"Bob"</span>},
        })
    })

    <span class="comment">// POST è¯·æ±‚</span>
    r.<span class="function">POST</span>(<span class="string">"/users"</span>, <span class="keyword">func</span>(c *gin.Context) {
        <span class="keyword">var</span> user <span class="keyword">struct</span> {
            Name  <span class="keyword">string</span> <span class="string">`json:"name"`</span>
            Email <span class="keyword">string</span> <span class="string">`json:"email"`</span>
        }
        
        <span class="keyword">if</span> err := c.<span class="function">ShouldBindJSON</span>(&user); err != <span class="keyword">nil</span> {
            c.<span class="function">JSON</span>(http.StatusBadRequest, gin.H{<span class="string">"error"</span>: err.<span class="function">Error</span>()})
            <span class="keyword">return</span>
        }
        
        c.<span class="function">JSON</span>(http.StatusCreated, gin.H{
            <span class="string">"message"</span>: <span class="string">"User created"</span>,
            <span class="string">"user"</span>:    user,
        })
    })

    <span class="comment">// è·¯å¾„å‚æ•°</span>
    r.<span class="function">GET</span>(<span class="string">"/users/:id"</span>, <span class="keyword">func</span>(c *gin.Context) {
        id := c.<span class="function">Param</span>(<span class="string">"id"</span>)
        c.<span class="function">JSON</span>(http.StatusOK, gin.H{<span class="string">"id"</span>: id})
    })

    <span class="comment">// æŸ¥è¯¢å‚æ•°</span>
    r.<span class="function">GET</span>(<span class="string">"/search"</span>, <span class="keyword">func</span>(c *gin.Context) {
        query := c.<span class="function">Query</span>(<span class="string">"q"</span>)
        page := c.<span class="function">DefaultQuery</span>(<span class="string">"page"</span>, <span class="string">"1"</span>)
        c.<span class="function">JSON</span>(http.StatusOK, gin.H{
            <span class="string">"query"</span>: query,
            <span class="string">"page"</span>:  page,
        })
    })

    r.<span class="function">Run</span>(<span class="string">":8080"</span>)
}</code></pre>
            
            <h3>ä¸­é—´ä»¶</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/gin-gonic/gin"</span>
    <span class="string">"net/http"</span>
    <span class="string">"time"</span>
)

<span class="comment">// è‡ªå®šä¹‰ä¸­é—´ä»¶</span>
<span class="function">func</span> <span class="function">Logger</span>() gin.HandlerFunc {
    <span class="keyword">return</span> <span class="keyword">func</span>(c *gin.Context) {
        start := time.<span class="function">Now</span>()
        
        c.<span class="function">Next</span>()
        
        latency := time.<span class="function">Since</span>(start)
        fmt.<span class="function">Printf</span>(<span class="string">"%s %s %v\n"</span>, c.<span class="function">Request</span>.Method, c.<span class="function">Request</span>.URL.Path, latency)
    }
}

<span class="comment">// è®¤è¯ä¸­é—´ä»¶</span>
<span class="function">func</span> <span class="function">AuthMiddleware</span>() gin.HandlerFunc {
    <span class="keyword">return</span> <span class="keyword">func</span>(c *gin.Context) {
        token := c.<span class="function">GetHeader</span>(<span class="string">"Authorization"</span>)
        
        <span class="keyword">if</span> token == <span class="string">""</span> {
            c.<span class="function">JSON</span>(http.StatusUnauthorized, gin.H{<span class="string">"error"</span>: <span class="string">"Unauthorized"</span>})
            c.<span class="function">Abort</span>()
            <span class="keyword">return</span>
        }
        
        c.<span class="function">Set</span>(<span class="string">"user_id"</span>, <span class="string">"123"</span>)
        c.<span class="function">Next</span>()
    }
}

<span class="function">func</span> <span class="function">main</span>() {
    r := gin.<span class="function">Default</span>()
    
    <span class="comment">// å…¨å±€ä¸­é—´ä»¶</span>
    r.<span class="function">Use</span>(<span class="function">Logger</span>())
    
    <span class="comment">// è·¯ç”±ç»„</span>
    api := r.<span class="function">Group</span>(<span class="string">"/api"</span>)
    api.<span class="function">Use</span>(<span class="function">AuthMiddleware</span>())
    
    api.<span class="function">GET</span>(<span class="string">"/profile"</span>, <span class="keyword">func</span>(c *gin.Context) {
        userID := c.<span class="function">GetString</span>(<span class="string">"user_id"</span>)
        c.<span class="function">JSON</span>(http.StatusOK, gin.H{<span class="string">"user_id"</span>: userID})
    })
    
    r.<span class="function">Run</span>(<span class="string">":8080"</span>)
}</code></pre>
            
            <h3>è·¯ç”±ç»„</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/gin-gonic/gin"</span>
    <span class="string">"net/http"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    r := gin.<span class="function">Default</span>()
    
    <span class="comment">// v1 è·¯ç”±ç»„</span>
    v1 := r.<span class="function">Group</span>(<span class="string">"/v1"</span>)
    {
        v1.<span class="function">GET</span>(<span class="string">"/users"</span>, <span class="keyword">func</span>(c *gin.Context) {
            c.<span class="function">String</span>(http.StatusOK, <span class="string">"v1 users"</span>)
        })
        v1.<span class="function">GET</span>(<span class="string">"/posts"</span>, <span class="keyword">func</span>(c *gin.Context) {
            c.<span class="function">String</span>(http.StatusOK, <span class="string">"v1 posts"</span>)
        })
    }
    
    <span class="comment">// v2 è·¯ç”±ç»„</span>
    v2 := r.<span class="function">Group</span>(<span class="string">"/v2"</span>)
    {
        v2.<span class="function">GET</span>(<span class="string">"/users"</span>, <span class="keyword">func</span>(c *gin.Context) {
            c.<span class="function">String</span>(http.StatusOK, <span class="string">"v2 users"</span>)
        })
        v2.<span class="function">GET</span>(<span class="string">"/posts"</span>, <span class="keyword">func</span>(c *gin.Context) {
            c.<span class="function">String</span>(http.StatusOK, <span class="string">"v2 posts"</span>)
        })
    }
    
    r.<span class="function">Run</span>(<span class="string">":8080"</span>)
}</code></pre>
            
            <h3>é”™è¯¯å¤„ç†</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/gin-gonic/gin"</span>
    <span class="string">"net/http"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    r := gin.<span class="function">Default</span>()
    
    <span class="comment">// è‡ªå®šä¹‰é”™è¯¯å¤„ç†</span>
    r.<span class="function">NoRoute</span>(<span class="keyword">func</span>(c *gin.Context) {
        c.<span class="function">JSON</span>(http.StatusNotFound, gin.H{
            <span class="string">"error"</span>: <span class="string">"Route not found"</span>,
        })
    })
    
    r.<span class="function">NoMethod</span>(<span class="keyword">func</span>(c *gin.Context) {
        c.<span class="function">JSON</span>(http.StatusMethodNotAllowed, gin.H{
            <span class="string">"error"</span>: <span class="string">"Method not allowed"</span>,
        })
    })
    
    <span class="comment">// Panic æ¢å¤</span>
    r.<span class="function">Use</span>(gin.<span class="function">Recovery</span>())
    
    r.<span class="function">GET</span>(<span class="string">"/panic"</span>, <span class="keyword">func</span>(c *gin.Context) {
        <span class="function">panic</span>(<span class="string">"Something went wrong"</span>)
    })
    
    r.<span class="function">Run</span>(<span class="string">":8080"</span>)
}</code></pre>
            
            <h2 id="gorm">GORM ORM</h2>
            
            <h3>ç®€ä»‹</h3>
            <p>GORM æ˜¯ Go è¯­è¨€ä¸­æœ€æµè¡Œçš„ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰åº“ï¼Œæä¾›äº†å‹å¥½çš„ APIï¼Œæ”¯æŒå¤šç§æ•°æ®åº“ï¼ˆMySQLã€PostgreSQLã€SQLiteã€SQL Server ç­‰ï¼‰ï¼Œå¹¶åŒ…å«è‡ªåŠ¨è¿ç§»ã€å…³è”ã€é’©å­ç­‰åŠŸèƒ½ã€‚</p>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get -u gorm.io/gorm
<span class="keyword">go</span> get -u gorm.io/driver/mysql</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"gorm.io/driver/mysql"</span>
    <span class="string">"gorm.io/gorm"</span>
)

<span class="keyword">type</span> User <span class="keyword">struct</span> {
    ID       <span class="keyword">uint</span>   <span class="string">`gorm:"primaryKey"`</span>
    Name     <span class="keyword">string</span> <span class="string">`gorm:"size:255;not null"`</span>
    Email    <span class="keyword">string</span> <span class="string">`gorm:"size:255;uniqueIndex;not null"`</span>
    Age      <span class="keyword">int</span>    <span class="string">`gorm:"default:0"`</span>
    CreatedAt time.Time
    UpdatedAt time.Time
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// è¿æ¥æ•°æ®åº“</span>
    dsn := <span class="string">"user:password@tcp(127.0.0.1:3306)/dbname?charset=utf8mb4&parseTime=True&loc=Local"</span>
    db, err := gorm.<span class="function">Open</span>(mysql.<span class="function">Open</span>(dsn), &gorm.Config{})
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="function">panic</span>(<span class="string">"Failed to connect database"</span>)
    }
    
    <span class="comment">// è‡ªåŠ¨è¿ç§»</span>
    db.<span class="function">AutoMigrate</span>(&User{})
    
    <span class="comment">// åˆ›å»ºè®°å½•</span>
    user := User{Name: <span class="string">"Alice"</span>, Email: <span class="string">"alice@example.com"</span>, Age: <span class="number">25</span>}
    result := db.<span class="function">Create</span>(&user)
    fmt.<span class="function">Println</span>(<span class="string">"Created user ID:"</span>, user.ID)
    fmt.<span class="function">Println</span>(<span class="string">"Rows affected:"</span>, result.RowsAffected)
}</code></pre>
            
            <h3>åˆ›å»ºè®°å½•</h3>
            <pre><code><span class="comment">// åˆ›å»ºå•æ¡è®°å½•</span>
user := User{Name: <span class="string">"Bob"</span>, Email: <span class="string">"bob@example.com"</span>, Age: <span class="number">30</span>}
db.<span class="function">Create</span>(&user)

<span class="comment">// åˆ›å»ºå¤šæ¡è®°å½•</span>
users := []User{
    {Name: <span class="string">"Charlie"</span>, Email: <span class="string">"charlie@example.com"</span>, Age: <span class="number">28</span>},
    {Name: <span class="string">"David"</span>, Email: <span class="string">"david@example.com"</span>, Age: <span class="number">32</span>},
}
db.<span class="function">Create</span>(&users)

<span class="comment">// ä½¿ç”¨ Select æŒ‡å®šå­—æ®µ</span>
db.<span class="function">Select</span>(<span class="string">"Name"</span>, <span class="string">"Email"</span>).<span class="function">Create</span>(&user)

<span class="comment">// ä½¿ç”¨ Omit å¿½ç•¥å­—æ®µ</span>
db.<span class="function">Omit</span>(<span class="string">"Age"</span>).<span class="function">Create</span>(&user)</code></pre>
            
            <h3>æŸ¥è¯¢è®°å½•</h3>
            <pre><code><span class="comment">// æŸ¥è¯¢ç¬¬ä¸€æ¡è®°å½•</span>
<span class="keyword">var</span> user User
db.<span class="function">First</span>(&user)
<span class="comment">// SELECT * FROM users ORDER BY id LIMIT 1;</span>

<span class="comment">// æ ¹æ®ä¸»é”®æŸ¥è¯¢</span>
db.<span class="function">First</span>(&user, <span class="number">1</span>)
<span class="comment">// SELECT * FROM users WHERE id = 1;</span>

<span class="comment">// æŸ¥è¯¢æ‰€æœ‰è®°å½•</span>
<span class="keyword">var</span> users []User
db.<span class="function">Find</span>(&users)
<span class="comment">// SELECT * FROM users;</span>

<span class="comment">// æ¡ä»¶æŸ¥è¯¢</span>
db.<span class="function">Where</span>(<span class="string">"name = ?"</span>, <span class="string">"Alice"</span>).<span class="function">First</span>(&user)
db.<span class="function">Where</span>(<span class="string">"age > ?"</span>, <span class="number">25</span>).<span class="function">Find</span>(&users)
db.<span class="function">Where</span>(<span class="string">"name LIKE ?"</span>, <span class="string">"%A%"</span>).<span class="function">Find</span>(&users)

<span class="comment">// å¤šæ¡ä»¶</span>
db.<span class="function">Where</span>(<span class="string">"name = ? AND age > ?"</span>, <span class="string">"Alice"</span>, <span class="number">20</span>).<span class="function">First</span>(&user)

<span class="comment">// ä½¿ç”¨ Map</span>
db.<span class="function">Where</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>{}{<span class="string">"name"</span>: <span class="string">"Alice"</span>, <span class="string">"age"</span>: <span class="number">25</span>}).<span class="function">First</span>(&user)

<span class="comment">// ä½¿ç”¨ Struct</span>
db.<span class="function">Where</span>(User{Name: <span class="string">"Alice"</span>, Age: <span class="number">25</span>}).<span class="function">First</span>(&user)

<span class="comment">// Or æ¡ä»¶</span>
db.<span class="function">Where</span>(<span class="string">"name = ?"</span>, <span class="string">"Alice"</span>).<span class="function">Or</span>(<span class="string">"name = ?"</span>, <span class="string">"Bob"</span>).<span class="function">Find</span>(&users)

<span class="comment">// Not æ¡ä»¶</span>
db.<span class="function">Not</span>(<span class="string">"name = ?"</span>, <span class="string">"Alice"</span>).<span class="function">Find</span>(&users)

<span class="comment">// æ’åº</span>
db.<span class="function">Order</span>(<span class="string">"age desc"</span>).<span class="function">Find</span>(&users)

<span class="comment">// é™åˆ¶å’Œåç§»</span>
db.<span class="function">Limit</span>(<span class="number">10</span>).<span class="function">Offset</span>(<span class="number">20</span>).<span class="function">Find</span>(&users)

<span class="comment">// ç»Ÿè®¡</span>
<span class="keyword">var</span> count <span class="keyword">int64</span>
db.<span class="function">Model</span>(&User{}).<span class="function">Count</span>(&count)

<span class="comment">// é€‰æ‹©ç‰¹å®šå­—æ®µ</span>
db.<span class="function">Select</span>(<span class="string">"name"</span>, <span class="string">"email"</span>).<span class="function">Find</span>(&users)</code></pre>
            
            <h3>æ›´æ–°è®°å½•</h3>
            <pre><code><span class="comment">// æ›´æ–°å•ä¸ªå­—æ®µ</span>
db.<span class="function">Model</span>(&user).<span class="function">Update</span>(<span class="string">"age"</span>, <span class="number">26</span>)

<span class="comment">// æ›´æ–°å¤šä¸ªå­—æ®µ</span>
db.<span class="function">Model</span>(&user).<span class="function">Updates</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>{}{
    <span class="string">"name"</span>: <span class="string">"Alice Updated"</span>,
    <span class="string">"age"</span>:  <span class="number">26</span>,
})

<span class="comment">// ä½¿ç”¨ Struct æ›´æ–°</span>
db.<span class="function">Model</span>(&user).<span class="function">Updates</span>(User{Name: <span class="string">"Alice Updated"</span>, Age: <span class="number">26</span>})

<span class="comment">// åªæ›´æ–°éé›¶å­—æ®µ</span>
db.<span class="function">Model</span>(&user).<span class="function">Updates</span>(User{Name: <span class="string">"Alice"</span>})

<span class="comment">// æ›´æ–°æ‰€æœ‰å­—æ®µï¼ˆåŒ…æ‹¬é›¶å€¼ï¼‰</span>
db.<span class="function">Model</span>(&user).<span class="function">Select</span>(<span class="string">"*"</span>).<span class="function">Updates</span>(User{Name: <span class="string">""</span>, Age: <span class="number">0</span>})

<span class="comment">// æ¡ä»¶æ›´æ–°</span>
db.<span class="function">Model</span>(&User{}).<span class="function">Where</span>(<span class="string">"age > ?"</span>, <span class="number">20</span>).<span class="function">Update</span>(<span class="string">"status"</span>, <span class="string">"active"</span>)

<span class="comment">// æ‰¹é‡æ›´æ–°</span>
db.<span class="function">Model</span>(&User{}).<span class="function">Where</span>(<span class="string">"age > ?"</span>, <span class="number">20</span>).<span class="function">Updates</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>{}{<span class="string">"status"</span>: <span class="string">"active"</span>})</code></pre>
            
            <h3>åˆ é™¤è®°å½•</h3>
            <pre><code><span class="comment">// åˆ é™¤è®°å½•</span>
db.<span class="function">Delete</span>(&user)
<span class="comment">// DELETE FROM users WHERE id = 1;</span>

<span class="comment">// æ ¹æ®ä¸»é”®åˆ é™¤</span>
db.<span class="function">Delete</span>(&User{}, <span class="number">1</span>)

<span class="comment">// æ‰¹é‡åˆ é™¤</span>
db.<span class="function">Where</span>(<span class="string">"age < ?"</span>, <span class="number">18</span>).<span class="function">Delete</span>(&User{})

<span class="comment">// è½¯åˆ é™¤</span>
<span class="keyword">type</span> User <span class="keyword">struct</span> {
    ID        <span class="keyword">uint</span>
    Name      <span class="keyword">string</span>
    DeletedAt gorm.DeletedAt <span class="string">`gorm:"index"`</span>
}
<span class="comment">// è½¯åˆ é™¤ä¸ä¼šçœŸæ­£åˆ é™¤è®°å½•ï¼Œè€Œæ˜¯è®¾ç½® deleted_at å­—æ®µ</span>

<span class="comment">// æ°¸ä¹…åˆ é™¤</span>
db.<span class="function">Unscoped</span>().<span class="function">Delete</span>(&user)</code></pre>
            
            <h3>å…³è”</h3>
            <pre><code><span class="keyword">type</span> User <span class="keyword">struct</span> {
    gorm.Model
    Name   <span class="keyword">string</span>
    Posts  []Post
}

<span class="keyword">type</span> Post <span class="keyword">struct</span> {
    gorm.Model
    Title   <span class="keyword">string</span>
    UserID  <span class="keyword">uint</span>
    User    User
}

<span class="comment">// é¢„åŠ è½½å…³è”</span>
<span class="keyword">var</span> users []User
db.<span class="function">Preload</span>(<span class="string">"Posts"</span>).<span class="function">Find</span>(&users)

<span class="comment">// åˆ›å»ºå…³è”</span>
user := User{Name: <span class="string">"Alice"</span>}
db.<span class="function">Create</span>(&user)
db.<span class="function">Model</span>(&user).<span class="function">Association</span>(<span class="string">"Posts"</span>).<span class="function">Append</span>([]Post{
    {Title: <span class="string">"Post 1"</span>},
    {Title: <span class="string">"Post 2"</span>},
})

<span class="comment">// æŸ¥æ‰¾å…³è”</span>
<span class="keyword">var</span> posts []Post
db.<span class="function">Model</span>(&user).<span class="function">Association</span>(<span class="string">"Posts"</span>).<span class="function">Find</span>(&posts)

<span class="comment">// æ›¿æ¢å…³è”</span>
db.<span class="function">Model</span>(&user).<span class="function">Association</span>(<span class="string">"Posts"</span>).<span class="function">Replace</span>([]Post{
    {Title: <span class="string">"New Post 1"</span>},
})

<span class="comment">// åˆ é™¤å…³è”</span>
db.<span class="function">Model</span>(&user).<span class="function">Association</span>(<span class="string">"Posts"</span>).<span class="function">Delete</span>(posts)

<span class="comment">// æ¸…ç©ºå…³è”</span>
db.<span class="function">Model</span>(&user).<span class="function">Association</span>(<span class="string">"Posts"</span>).<span class="function">Clear</span>()</code></pre>
            
            <h3>é’©å­</h3>
            <pre><code><span class="keyword">type</span> User <span class="keyword">struct</span> {
    gorm.Model
    Name  <span class="keyword">string</span>
    Email <span class="keyword">string</span>
}

<span class="comment">// åˆ›å»ºå‰é’©å­</span>
<span class="function">func</span> (u *User) <span class="function">BeforeCreate</span>(tx *gorm.DB) <span class="keyword">error</span> {
    fmt.<span class="function">Println</span>(<span class="string">"Before create:"</span>, u.Name)
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="comment">// åˆ›å»ºåé’©å­</span>
<span class="function">func</span> (u *User) <span class="function">AfterCreate</span>(tx *gorm.DB) <span class="keyword">error</span> {
    fmt.<span class="function">Println</span>(<span class="string">"After create:"</span>, u.ID)
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="comment">// æ›´æ–°å‰é’©å­</span>
<span class="function">func</span> (u *User) <span class="function">BeforeUpdate</span>(tx *gorm.DB) <span class="keyword">error</span> {
    fmt.<span class="function">Println</span>(<span class="string">"Before update:"</span>, u.Name)
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="comment">// æŸ¥è¯¢å‰é’©å­</span>
<span class="function">func</span> (u *User) <span class="function">AfterFind</span>(tx *gorm.DB) <span class="keyword">error</span> {
    fmt.<span class="function">Println</span>(<span class="string">"After find:"</span>, u.Name)
    <span class="keyword">return</span> <span class="keyword">nil</span>
}</code></pre>
            
            <h3>äº‹åŠ¡</h3>
            <pre><code><span class="comment">// è‡ªåŠ¨äº‹åŠ¡</span>
err := db.<span class="function">Transaction</span>(<span class="keyword">func</span>(tx *gorm.DB) <span class="keyword">error</span> {
    <span class="comment">// åˆ›å»ºç”¨æˆ·</span>
    <span class="keyword">if</span> err := tx.<span class="function">Create</span>(&User{Name: <span class="string">"Alice"</span>}).Error; err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    
    <span class="comment">// åˆ›å»ºè®¢å•</span>
    <span class="keyword">if</span> err := tx.<span class="function">Create</span>(&Order{UserID: <span class="number">1</span>}).Error; err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    
    <span class="keyword">return</span> <span class="keyword">nil</span>
})

<span class="comment">// æ‰‹åŠ¨äº‹åŠ¡</span>
tx := db.<span class="function">Begin</span>()

<span class="keyword">if</span> err := tx.<span class="function">Create</span>(&User{Name: <span class="string">"Bob"</span>}).Error; err != <span class="keyword">nil</span> {
    tx.<span class="function">Rollback</span>()
}

<span class="keyword">if</span> err := tx.<span class="function">Commit</span>().Error; err != <span class="keyword">nil</span> {
    tx.<span class="function">Rollback</span>()
}</code></pre>
            
            <h2 id="viper">Viper é…ç½®</h2>
            
            <h3>ç®€ä»‹</h3>
            <p>Viper æ˜¯ Go è¯­è¨€çš„é…ç½®ç®¡ç†åº“ï¼Œæ”¯æŒå¤šç§é…ç½®æ ¼å¼ï¼ˆJSONã€TOMLã€YAMLã€HCLã€envfile ç­‰ï¼‰ï¼Œå¯ä»¥ä»æ–‡ä»¶ã€ç¯å¢ƒå˜é‡ã€å‘½ä»¤è¡Œå‚æ•°ç­‰å¤šç§æ¥æºè¯»å–é…ç½®ï¼Œå¹¶æ”¯æŒé…ç½®çƒ­é‡è½½ã€‚</p>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get github.com/spf13/viper</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/spf13/viper"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    v := viper.<span class="function">New</span>()
    
    <span class="comment">// è®¾ç½®é…ç½®æ–‡ä»¶åå’Œè·¯å¾„</span>
    v.<span class="function">SetConfigName</span>(<span class="string">"config"</span>)
    v.<span class="function">SetConfigType</span>(<span class="string">"yaml"</span>)
    v.<span class="function">AddConfigPath</span>(<span class="string">"./"</span>)
    
    <span class="comment">// è¯»å–é…ç½®æ–‡ä»¶</span>
    <span class="keyword">if</span> err := v.<span class="function">ReadInConfig</span>(); err != <span class="keyword">nil</span> {
        <span class="function">panic</span>(fmt.<span class="function">Errorf</span>(<span class="string">"Failed to read config file: %s"</span>, err))
    }
    
    <span class="comment">// è·å–é…ç½®å€¼</span>
    fmt.<span class="function">Println</span>(<span class="string">"Server Port:"</span>, v.<span class="function">GetString</span>(<span class="string">"server.port"</span>))
    fmt.<span class="function">Println</span>(<span class="string">"Database Host:"</span>, v.<span class="function">GetString</span>(<span class="string">"database.host"</span>))
}</code></pre>
            
            <h3>é…ç½®æ–‡ä»¶ç¤ºä¾‹</h3>
            <pre><code><span class="comment"># config.yaml</span>
server:
  port: <span class="number">8080</span>
  host: localhost

database:
  host: localhost
  port: <span class="number">3306</span>
  name: mydb
  user: root
  password: secret

logging:
  level: info
  format: json</code></pre>
            
            <h3>è¯»å–é…ç½®</h3>
            <pre><code><span class="comment">// è·å–å­—ç¬¦ä¸²</span>
port := v.<span class="function">GetString</span>(<span class="string">"server.port"</span>)

<span class="comment">// è·å–æ•´æ•°</span>
port := v.<span class="function">GetInt</span>(<span class="string">"server.port"</span>)

<span class="comment">// è·å–å¸ƒå°”å€¼</span>
debug := v.<span class="function">GetBool</span>(<span class="string">"debug"</span>)

<span class="comment">// è·å–æµ®ç‚¹æ•°</span>
timeout := v.<span class="function">GetFloat64</span>(<span class="string">"timeout"</span>)

<span class="comment">// è·å–æ—¶é—´</span>
duration := v.<span class="function">GetDuration</span>(<span class="string">"timeout"</span>)

<span class="comment">// è·å–å­—ç¬¦ä¸²åˆ‡ç‰‡</span>
hosts := v.<span class="function">GetStringSlice</span>(<span class="string">"servers.hosts"</span>)

<span class="comment">// è·å–æ‰€æœ‰é…ç½®</span>
all := v.<span class="function">AllSettings</span>()

<span class="comment">// æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨</span>
<span class="keyword">if</span> v.<span class="function">IsSet</span>(<span class="string">"server.port"</span>) {
    port := v.<span class="function">GetString</span>(<span class="string">"server.port"</span>)
}

<span class="comment">// è·å–å­é…ç½®</span>
server := v.<span class="function">Sub</span>(<span class="string">"server"</span>)
port := server.<span class="function">GetString</span>(<span class="string">"port"</span>)</code></pre>
            
            <h3>ç¯å¢ƒå˜é‡</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/spf13/viper"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    v := viper.<span class="function">New</span>()
    
    <span class="comment">// ç»‘å®šç¯å¢ƒå˜é‡</span>
    v.<span class="function">BindEnv</span>(<span class="string">"server.port"</span>, <span class="string">"SERVER_PORT"</span>)
    v.<span class="function">BindEnv</span>(<span class="string">"database.host"</span>, <span class="string">"DB_HOST"</span>)
    
    <span class="comment">// è‡ªåŠ¨ç»‘å®šç¯å¢ƒå˜é‡ï¼ˆä½¿ç”¨å‰ç¼€ï¼‰</span>
    v.<span class="function">SetEnvPrefix</span>(<span class="string">"APP"</span>)
    v.<span class="function">AutomaticEnv</span>()
    <span class="comment">// APP_SERVER_PORT -> server.port</span>
    
    <span class="comment">// è®¾ç½®é»˜è®¤å€¼</span>
    v.<span class="function">SetDefault</span>(<span class="string">"server.port"</span>, <span class="number">8080</span>)
    v.<span class="function">SetDefault</span>(<span class="string">"debug"</span>, <span class="keyword">false</span>)
    
    <span class="comment">// è¯»å–ç¯å¢ƒå˜é‡</span>
    port := v.<span class="function">GetString</span>(<span class="string">"server.port"</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Port:"</span>, port)
}</code></pre>
            
            <h3>å‘½ä»¤è¡Œå‚æ•°</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/spf13/cobra"</span>
    <span class="string">"github.com/spf13/viper"</span>
)

<span class="keyword">var</span> rootCmd = &cobra.Command{
    <span class="function">Run</span>: <span class="keyword">func</span>(cmd *cobra.Command, args []<span class="keyword">string</span>) {
        port := viper.<span class="function">GetInt</span>(<span class="string">"port"</span>)
        fmt.<span class="function">Println</span>(<span class="string">"Port:"</span>, port)
    },
}

<span class="function">func</span> <span class="function">init</span>() {
    rootCmd.<span class="function">PersistentFlags</span>().<span class="function">Int</span>(<span class="string">"port"</span>, <span class="number">8080</span>, <span class="string">"Server port"</span>)
    viper.<span class="function">BindPFlag</span>(<span class="string">"port"</span>, rootCmd.<span class="function">PersistentFlags</span>().<span class="function">Lookup</span>(<span class="string">"port"</span>))
}

<span class="function">func</span> <span class="function">main</span>() {
    cobra.<span class="function">Execute</span>()
}</code></pre>
            
            <h3>é…ç½®çƒ­é‡è½½</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"log"</span>
    <span class="string">"github.com/fsnotify/fsnotify"</span>
    <span class="string">"github.com/spf13/viper"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    v := viper.<span class="function">New</span>()
    v.<span class="function">SetConfigName</span>(<span class="string">"config"</span>)
    v.<span class="function">SetConfigType</span>(<span class="string">"yaml"</span>)
    v.<span class="function">AddConfigPath</span>(<span class="string">"./"</span>)
    
    <span class="keyword">if</span> err := v.<span class="function">ReadInConfig</span>(); err != <span class="keyword">nil</span> {
        <span class="function">panic</span>(err)
    }
    
    <span class="comment">// ç›‘å¬é…ç½®æ–‡ä»¶å˜åŒ–</span>
    v.<span class="function">OnConfigChange</span>(<span class="keyword">func</span>(e fsnotify.Event) {
        fmt.<span class="function">Printf</span>(<span class="string">"Config file changed: %s\n"</span>, e.Name)
        log.<span class="function">Println</span>(<span class="string">"Reloading config..."</span>)
    })
    
    v.<span class="function">WatchConfig</span>()
    
    <span class="comment">// ä¸»å¾ªç¯</span>
    <span class="keyword">select</span> {}
}</code></pre>
            
            <h3>å¤šé…ç½®æº</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/spf13/viper"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    v := viper.<span class="function">New</span>()
    
    <span class="comment">// 1. è®¾ç½®é»˜è®¤å€¼</span>
    v.<span class="function">SetDefault</span>(<span class="string">"server.port"</span>, <span class="number">8080</span>)
    
    <span class="comment">// 2. è¯»å–é…ç½®æ–‡ä»¶</span>
    v.<span class="function">SetConfigName</span>(<span class="string">"config"</span>)
    v.<span class="function">SetConfigType</span>(<span class="string">"yaml"</span>)
    v.<span class="function">AddConfigPath</span>(<span class="string">"./"</span>)
    v.<span class="function">ReadInConfig</span>()
    
    <span class="comment">// 3. è¯»å–ç¯å¢ƒå˜é‡</span>
    v.<span class="function">SetEnvPrefix</span>(<span class="string">"APP"</span>)
    v.<span class="function">AutomaticEnv</span>()
    
    <span class="comment">// 4. è¯»å–å‘½ä»¤è¡Œå‚æ•°</span>
    <span class="comment">// ä½¿ç”¨ cobra ç»‘å®š</span>
    
    <span class="comment">// ä¼˜å…ˆçº§ï¼šå‘½ä»¤è¡Œå‚æ•° > ç¯å¢ƒå˜é‡ > é…ç½®æ–‡ä»¶ > é»˜è®¤å€¼</span>
    port := v.<span class="function">GetInt</span>(<span class="string">"server.port"</span>)
    fmt.<span class="function">Println</span>(<span class="string">"Port:"</span>, port)
}</code></pre>
            
            <h2 id="zap">Zap æ—¥å¿—</h2>
            
            <h3>ç®€ä»‹</h3>
            <p>Zap æ˜¯ Uber å¼€å‘çš„é«˜æ€§èƒ½ã€ç»“æ„åŒ–æ—¥å¿—åº“ï¼Œä¸“ä¸º Go è¯­è¨€è®¾è®¡ã€‚å®ƒæä¾›äº†é›¶å†…å­˜åˆ†é…çš„æ—¥å¿—è®°å½•å’Œç»“æ„åŒ–æ—¥å¿—æ”¯æŒï¼Œæ€§èƒ½è¿œè¶…æ ‡å‡†åº“çš„ log åŒ…å’Œå…¶ä»–æ—¥å¿—åº“ã€‚</p>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get -u go.uber.org/zap
<span class="keyword">go</span> get -u go.uber.org/zap/zapcore</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"go.uber.org/zap"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºå¼€å‘ç¯å¢ƒ logger</span>
    logger, _ := zap.<span class="function">NewDevelopment</span>()
    <span class="keyword">defer</span> logger.<span class="function">Sync</span>()
    
    <span class="comment">// è®°å½•æ—¥å¿—</span>
    logger.<span class="function">Info</span>(<span class="string">"Hello, World!"</span>)
    logger.<span class="function">Debug</span>(<span class="string">"Debug message"</span>)
    logger.<span class="function">Warn</span>(<span class="string">"Warning message"</span>)
    logger.<span class="function">Error</span>(<span class="string">"Error message"</span>)
}</code></pre>
            
            <h3>ç”Ÿäº§ç¯å¢ƒ Logger</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"go.uber.org/zap"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºç”Ÿäº§ç¯å¢ƒ logger</span>
    logger, _ := zap.<span class="function">NewProduction</span>()
    <span class="keyword">defer</span> logger.<span class="function">Sync</span>()
    
    <span class="comment">// è®°å½•æ—¥å¿—</span>
    logger.<span class="function">Info</span>(<span class="string">"Server started"</span>,
        zap.<span class="function">String</span>(<span class="string">"host"</span>, <span class="string">"localhost"</span>),
        zap.<span class="function">Int</span>(<span class="string">"port"</span>, <span class="number">8080</span>),
    )
}</code></pre>
            
            <h3>è‡ªå®šä¹‰ Logger</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"os"</span>
    
    <span class="string">"go.uber.org/zap"</span>
    <span class="string">"go.uber.org/zap/zapcore"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// è‡ªå®šä¹‰é…ç½®</span>
    config := zap.Config{
        Level:            zap.NewAtomicLevelAt(zapcore.InfoLevel),
        Development:      <span class="keyword">false</span>,
        Encoding:         <span class="string">"json"</span>,
        EncoderConfig: zapcore.EncoderConfig{
            TimeKey:        <span class="string">"timestamp"</span>,
            LevelKey:       <span class="string">"level"</span>,
            NameKey:        <span class="string">"logger"</span>,
            CallerKey:      <span class="string">"caller"</span>,
            MessageKey:     <span class="string">"msg"</span>,
            StacktraceKey:  <span class="string">"stacktrace"</span>,
            LineEnding:     zapcore.DefaultLineEnding,
            EncodeLevel:    zapcore.LowercaseLevelEncoder,
            EncodeTime:     zapcore.ISO8601TimeEncoder,
            EncodeDuration: zapcore.SecondsDurationEncoder,
            EncodeCaller:   zapcore.ShortCallerEncoder,
        },
        OutputPaths:      []<span class="keyword">string</span>{<span class="string">"stdout"</span>},
        ErrorOutputPaths: []<span class="keyword">string</span>{<span class="string">"stderr"</span>},
    }
    
    logger, _ := config.<span class="function">Build</span>()
    <span class="keyword">defer</span> logger.<span class="function">Sync</span>()
    
    logger.<span class="function">Info</span>(<span class="string">"Custom logger initialized"</span>)
}</code></pre>
            
            <h3>ç»“æ„åŒ–æ—¥å¿—</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"go.uber.org/zap"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    logger, _ := zap.<span class="function">NewProduction</span>()
    <span class="keyword">defer</span> logger.<span class="function">Sync</span>()
    
    <span class="comment">// æ·»åŠ å­—æ®µ</span>
    logger.<span class="function">Info</span>(<span class="string">"User logged in"</span>,
        zap.<span class="function">String</span>(<span class="string">"user_id"</span>, <span class="string">"123"</span>),
        zap.<span class="function">String</span>(<span class="string">"username"</span>, <span class="string">"alice"</span>),
        zap.<span class="function">String</span>(<span class="string">"ip"</span>, <span class="string">"192.168.1.1"</span>),
    )
    
    <span class="comment">// ä½¿ç”¨ç»“æ„åŒ–å¯¹è±¡</span>
    <span class="keyword">type</span> User <span class="keyword">struct</span> {
        ID    <span class="keyword">string</span>
        Name  <span class="keyword">string</span>
        Email <span class="keyword">string</span>
    }
    
    user := User{ID: <span class="string">"123"</span>, Name: <span class="string">"Alice"</span>, Email: <span class="string">"alice@example.com"</span>}
    logger.<span class="function">Info</span>(<span class="string">"User created"</span>, zap.<span class="function">Any</span>(<span class="string">"user"</span>, user))
}</code></pre>
            
            <h3>æ—¥å¿—çº§åˆ«</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"go.uber.org/zap"</span>
    <span class="string">"go.uber.org/zap/zapcore"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// è®¾ç½®æ—¥å¿—çº§åˆ«</span>
    config := zap.NewProductionConfig()
    config.Level = zap.NewAtomicLevelAt(zapcore.DebugLevel)
    
    logger, _ := config.<span class="function">Build</span>(zap.<span class="function">AddCaller</span>())
    <span class="keyword">defer</span> logger.<span class="function">Sync</span>()
    
    <span class="comment">// ä¸åŒçº§åˆ«çš„æ—¥å¿—</span>
    logger.<span class="function">Debug</span>(<span class="string">"Debug information"</span>)
    logger.<span class="function">Info</span>(<span class="string">"Information"</span>)
    logger.<span class="function">Warn</span>(<span class="string">"Warning"</span>)
    logger.<span class="function">Error</span>(<span class="string">"Error occurred"</span>)
    
    <span class="comment">// Fatal ä¼šè°ƒç”¨ os.Exit(1)</span>
    <span class="comment">// logger.Fatal("Fatal error")</span>
    
    <span class="comment">// Panic ä¼šè°ƒç”¨ panic()</span>
    <span class="comment">// logger.Panic("Panic situation")</span>
}</code></pre>
            
            <h3>è¾“å‡ºåˆ°æ–‡ä»¶</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"go.uber.org/zap"</span>
    <span class="string">"go.uber.org/zap/zapcore"</span>
    <span class="string">"gopkg.in/natefinch/lumberjack.v2"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// æ—¥å¿—è½®è½¬é…ç½®</span>
    writer := &lumberjack.Logger{
        Filename:   <span class="string">"logs/app.log"</span>,
        MaxSize:    <span class="number">100</span>, <span class="comment">// MB</span>
        MaxBackups: <span class="number">3</span>,
        MaxAge:     <span class="number">28</span>,   <span class="comment">// days</span>
        Compress:   <span class="keyword">true</span>,
    }
    
    <span class="comment">// åˆ›å»º core</span>
    core := zapcore.<span class="function">NewCore</span>(
        zapcore.<span class="function">NewJSONEncoder</span>(zap.NewProductionEncoderConfig()),
        zapcore.<span class="function">AddSync</span>(writer),
        zapcore.InfoLevel,
    )
    
    logger := zap.<span class="function">New</span>(core, zap.<span class="function">AddCaller</span>())
    <span class="keyword">defer</span> logger.<span class="function">Sync</span>()
    
    logger.<span class="function">Info</span>(<span class="string">"Logging to file"</span>)
}</code></pre>
            
            <h3>åŒæ—¶è¾“å‡ºåˆ°å¤šä¸ªåœ°æ–¹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"os"</span>
    <span class="string">"go.uber.org/zap"</span>
    <span class="string">"go.uber.org/zap/zapcore"</span>
    <span class="string">"gopkg.in/natefinch/lumberjack.v2"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// æ–‡ä»¶è¾“å‡º</span>
    fileWriter := &lumberjack.Logger{
        Filename:   <span class="string">"logs/app.log"</span>,
        MaxSize:    <span class="number">100</span>,
        MaxBackups: <span class="number">3</span>,
        MaxAge:     <span class="number">28</span>,
        Compress:   <span class="keyword">true</span>,
    }
    
    <span class="comment">// æ§åˆ¶å°è¾“å‡º</span>
    consoleWriter := zapcore.<span class="function">AddSync</span>(os.Stdout)
    
    <span class="comment">// åˆ›å»º encoder</span>
    encoderConfig := zap.NewProductionEncoderConfig()
    encoderConfig.EncodeTime = zapcore.ISO8601TimeEncoder
    encoder := zapcore.<span class="function">NewJSONEncoder</span>(encoderConfig)
    
    <span class="comment">// åˆ›å»º core</span>
    core := zapcore.<span class="function">NewTee</span>(
        zapcore.<span class="function">NewCore</span>(encoder, zapcore.<span class="function">AddSync</span>(fileWriter), zapcore.InfoLevel),
        zapcore.<span class="function">NewCore</span>(encoder, consoleWriter, zapcore.DebugLevel),
    )
    
    logger := zap.<span class="function">New</span>(core, zap.<span class="function">AddCaller</span>())
    <span class="keyword">defer</span> logger.<span class="function">Sync</span>()
    
    logger.<span class="function">Info</span>(<span class="string">"Logging to both file and console"</span>)
}</code></pre>
            
            <h3>Sugar Logger</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"go.uber.org/zap"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    logger, _ := zap.<span class="function">NewProduction</span>()
    <span class="keyword">defer</span> logger.<span class="function">Sync</span>()
    
    <span class="comment">// Sugar logger æä¾›æ›´æ–¹ä¾¿çš„ API</span>
    sugar := logger.<span class="function">Sugar</span>()
    
    <span class="comment">// Printf é£æ ¼</span>
    sugar.<span class="function">Infof</span>(<span class="string">"User %s logged in from %s"</span>, <span class="string">"alice"</span>, <span class="string">"192.168.1.1"</span>)
    
    <span class="comment">// æƒ¯ç”¨é£æ ¼</span>
    sugar.<span class="function">Infow</span>(<span class="string">"User logged in"</span>,
        <span class="string">"user"</span>, <span class="string">"alice"</span>,
        <span class="string">"ip"</span>, <span class="string">"192.168.1.1"</span>,
    )
    
    <span class="comment">// ç®€å•é£æ ¼</span>
    sugar.<span class="function">Info</span>(<span class="string">"Simple log message"</span>, <span class="string">"arg1"</span>, <span class="string">"arg2"</span>)
}</code></pre>
            
            <h3>é”™è¯¯å¤„ç†</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"errors"</span>
    <span class="string">"go.uber.org/zap"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    logger, _ := zap.<span class="function">NewProduction</span>()
    <span class="keyword">defer</span> logger.<span class="function">Sync</span>()
    
    <span class="comment">// è®°å½•é”™è¯¯</span>
    err := errors.<span class="function">New</span>(<span class="string">"something went wrong"</span>)
    logger.<span class="function">Error</span>(<span class="string">"Operation failed"</span>,
        zap.<span class="function">Error</span>(err),
        zap.<span class="function">String</span>(<span class="string">"operation"</span>, <span class="string">"create_user"</span>),
    )
    
    <span class="comment">// è®°å½•å †æ ˆ</span>
    logger.<span class="function">Error</span>(<span class="string">"Error with stack"</span>,
        zap.<span class="function">Error</span>(err),
        zap.<span class="function">Stack</span>(<span class="string">"stack"</span>),
    )
}</code></pre>
            
            <h2 id="bestpractices">æœ€ä½³å®è·µ</h2>
            
            <h3>Gin æœ€ä½³å®è·µ</h3>
            <div class="note-box">
                <h4>1. é¡¹ç›®ç»“æ„</h4>
                <pre><code>project/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ server/
â”‚       â””â”€â”€ main.go
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ handler/
â”‚   â”œâ”€â”€ service/
â”‚   â”œâ”€â”€ repository/
â”‚   â””â”€â”€ model/
â”œâ”€â”€ pkg/
â”œâ”€â”€ configs/
â””â”€â”€ go.mod</code></pre>
                
                <h4>2. ä½¿ç”¨ä¾èµ–æ³¨å…¥</h4>
                <pre><code><span class="keyword">type</span> Server <span class="keyword">struct</span> {
    router *gin.Engine
    userHandler *UserHandler
}

<span class="function">func</span> <span class="function">NewServer</span>(userHandler *UserHandler) *Server {
    s := &Server{
        router: gin.<span class="function">Default</span>(),
        userHandler: userHandler,
    }
    s.<span class="function">setupRoutes</span>()
    <span class="keyword">return</span> s
}</code></pre>
                
                <h4>3. ç»Ÿä¸€é”™è¯¯å¤„ç†</h4>
                <pre><code><span class="keyword">type</span> ErrorResponse <span class="keyword">struct</span> {
    Error   <span class="keyword">string</span> <span class="string">`json:"error"`</span>
    Code    <span class="keyword">int</span>    <span class="string">`json:"code"`</span>
    Message <span class="keyword">string</span> <span class="string">`json:"message"`</span>
}

<span class="function">func</span> <span class="function">HandleError</span>(c *gin.Context, err <span class="keyword">error</span>) {
    <span class="keyword">if</span> errors.<span class="function">Is</span>(err, ErrNotFound) {
        c.<span class="function">JSON</span>(http.StatusNotFound, ErrorResponse{
            Error:   <span class="string">"not_found"</span>,
            Code:    <span class="number">404</span>,
            Message: err.<span class="function">Error</span>(),
        })
        <span class="keyword">return</span>
    }
    c.<span class="function">JSON</span>(http.StatusInternalServerError, ErrorResponse{
        Error:   <span class="string">"internal_error"</span>,
        Code:    <span class="number">500</span>,
        Message: <span class="string">"Internal server error"</span>,
    })
}</code></pre>
                
                <h4>4. ä½¿ç”¨ Context ä¼ é€’è¯·æ±‚ä½œç”¨åŸŸæ•°æ®</h4>
                <pre><code><span class="comment">// åœ¨ä¸­é—´ä»¶ä¸­è®¾ç½®</span>
c.<span class="function">Set</span>(<span class="string">"user_id"</span>, userID)

<span class="comment">// åœ¨ handler ä¸­è·å–</span>
userID := c.<span class="function">GetString</span>(<span class="string">"user_id"</span>)</code></pre>
            </div>
            
            <h3>GORM æœ€ä½³å®è·µ</h3>
            <div class="note-box">
                <h4>1. ä½¿ç”¨æ¨¡å‹å±‚æŠ½è±¡</h4>
                <pre><code><span class="keyword">type</span> Repository <span class="keyword">interface</span> {
    <span class="function">Create</span>(user *User) <span class="keyword">error</span>
    <span class="function">FindByID</span>(id <span class="keyword">uint</span>) (*User, <span class="keyword">error</span>)
    <span class="function">Update</span>(user *User) <span class="keyword">error</span>
    <span class="function">Delete</span>(id <span class="keyword">uint</span>) <span class="keyword">error</span>
}

<span class="keyword">type</span> UserRepository <span class="keyword">struct</span> {
    db *gorm.DB
}

<span class="function">func</span> (r *UserRepository) <span class="function">FindByID</span>(id <span class="keyword">uint</span>) (*User, <span class="keyword">error</span>) {
    <span class="keyword">var</span> user User
    err := r.db.<span class="function">First</span>(&user, id).Error
    <span class="keyword">return</span> &user, err
}</code></pre>
                
                <h4>2. ä½¿ç”¨äº‹åŠ¡ç®¡ç†</h4>
                <pre><code><span class="keyword">func</span> (s *UserService) <span class="function">CreateUserWithOrder</span>(user *User, order *Order) <span class="keyword">error</span> {
    <span class="keyword">return</span> s.db.<span class="function">Transaction</span>(<span class="keyword">func</span>(tx *gorm.DB) <span class="keyword">error</span> {
        <span class="keyword">if</span> err := tx.<span class="function">Create</span>(user).Error; err != <span class="keyword">nil</span> {
            <span class="keyword">return</span> err
        }
        order.UserID = user.ID
        <span class="keyword">return</span> tx.<span class="function">Create</span>(order).Error
    })
}</code></pre>
                
                <h4>3. ä½¿ç”¨è½¯åˆ é™¤</h4>
                <pre><code><span class="keyword">type</span> BaseModel <span class="keyword">struct</span> {
    ID        <span class="keyword">uint</span>
    CreatedAt time.Time
    UpdatedAt time.Time
    DeletedAt gorm.DeletedAt <span class="string">`gorm:"index"`</span>
}

<span class="keyword">type</span> User <span class="keyword">struct</span> {
    BaseModel
    Name  <span class="keyword">string</span>
    Email <span class="keyword">string</span>
}</code></pre>
                
                <h4>4. ä½¿ç”¨é¢„åŠ è½½é¿å… N+1 æŸ¥è¯¢</h4>
                <pre><code><span class="comment">// é”™è¯¯ï¼šN+1 æŸ¥è¯¢</span>
<span class="keyword">var</span> users []User
db.<span class="function">Find</span>(&users)
<span class="keyword">for</span> _, user := <span class="keyword">range</span> users {
    db.<span class="function">Where</span>(<span class="string">"user_id = ?"</span>, user.ID).<span class="function">Find</span>(&user.Posts)
}

<span class="comment">// æ­£ç¡®ï¼šä½¿ç”¨é¢„åŠ è½½</span>
db.<span class="function">Preload</span>(<span class="string">"Posts"</span>).<span class="function">Find</span>(&users)</code></pre>
            </div>
            
            <h3>Viper æœ€ä½³å®è·µ</h3>
            <div class="note-box">
                <h4>1. é…ç½®ä¼˜å…ˆçº§</h4>
                <pre><code><span class="comment">// ä¼˜å…ˆçº§ä»é«˜åˆ°ä½</span>
<span class="comment">// 1. å‘½ä»¤è¡Œå‚æ•°</span>
<span class="comment">// 2. ç¯å¢ƒå˜é‡</span>
<span class="comment">// 3. é…ç½®æ–‡ä»¶</span>
<span class="comment">// 4. é»˜è®¤å€¼</span></code></pre>
                
                <h4>2. ä½¿ç”¨é…ç½®éªŒè¯</h4>
                <pre><code><span class="keyword">func</span> <span class="function">ValidateConfig</span>(v *viper.Viper) <span class="keyword">error</span> {
    <span class="keyword">if</span> !v.<span class="function">IsSet</span>(<span class="string">"server.port"</span>) {
        <span class="keyword">return</span> errors.<span class="function">New</span>(<span class="string">"server.port is required"</span>)
    }
    <span class="keyword">if</span> !v.<span class="function">IsSet</span>(<span class="string">"database.host"</span>) {
        <span class="keyword">return</span> errors.<span class="function">New</span>(<span class="string">"database.host is required"</span>)
    }
    <span class="keyword">return</span> <span class="keyword">nil</span>
}</code></pre>
                
                <h4>3. æ•æ„Ÿä¿¡æ¯ä½¿ç”¨ç¯å¢ƒå˜é‡</h4>
                <pre><code><span class="comment">// config.yaml</span>
database:
  host: localhost
  port: <span class="number">3306</span>
  name: mydb
  user: root
  password: ${DB_PASSWORD}  <span class="comment">// ä»ç¯å¢ƒå˜é‡è¯»å–</span></code></pre>
            </div>
            
            <h3>Zap æœ€ä½³å®è·µ</h3>
            <div class="note-box">
                <h4>1. ä½¿ç”¨å…¨å±€ Logger</h4>
                <pre><code><span class="keyword">var</span> logger *zap.Logger

<span class="function">func</span> <span class="function">InitLogger</span>(config *Config) <span class="keyword">error</span> {
    <span class="keyword">var</span> err <span class="keyword">error</span>
    logger, err = config.<span class="function">BuildLogger</span>()
    <span class="keyword">return</span> err
}

<span class="function">func</span> <span class="function">GetLogger</span>() *zap.Logger {
    <span class="keyword">return</span> logger
}</code></pre>
                
                <h4>2. ä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—</h4>
                <pre><code><span class="comment">// å¥½çš„å®è·µ</span>
logger.<span class="function">Info</span>(<span class="string">"User logged in"</span>,
    zap.<span class="function">String</span>(<span class="string">"user_id"</span>, userID),
    zap.<span class="function">String</span>(<span class="string">"ip"</span>, ip),
)

<span class="comment">// ä¸å¥½çš„å®è·µ</span>
logger.<span class="function">Info</span>(fmt.<span class="function">Sprintf</span>(<span class="string">"User %s logged in from %s"</span>, userID, ip))</code></pre>
                
                <h4>3. æ—¥å¿—çº§åˆ«æ§åˆ¶</h4>
                <pre><code><span class="comment">// å¼€å‘ç¯å¢ƒ</span>
config.Level = zap.NewAtomicLevelAt(zapcore.DebugLevel)

<span class="comment">// ç”Ÿäº§ç¯å¢ƒ</span>
config.Level = zap.NewAtomicLevelAt(zapcore.InfoLevel)</code></pre>
                
                <h4>4. æ—¥å¿—è½®è½¬</h4>
                <pre><code><span class="comment">// ä½¿ç”¨ lumberjack è¿›è¡Œæ—¥å¿—è½®è½¬</span>
writer := &lumberjack.Logger{
    Filename:   <span class="string">"logs/app.log"</span>,
    MaxSize:    <span class="number">100</span>, <span class="comment">// MB</span>
    MaxBackups: <span class="number">3</span>,
    MaxAge:     <span class="number">28</span>,   <span class="comment">// days</span>
    Compress:   <span class="keyword">true</span>,
}</code></pre>
            </div>
            
            <h3>é›†æˆç¤ºä¾‹</h3>
            <div class="note-box">
                <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/gin-gonic/gin"</span>
    <span class="string">"github.com/spf13/viper"</span>
    <span class="string">"go.uber.org/zap"</span>
    <span class="string">"gorm.io/driver/mysql"</span>
    <span class="string">"gorm.io/gorm"</span>
)

<span class="keyword">type</span> App <span class="keyword">struct</span> {
    Router *gin.Engine
    DB     *gorm.DB
    Config *viper.Viper
    Logger *zap.Logger
}

<span class="function">func</span> <span class="function">NewApp</span>() *App {
    <span class="comment">// åˆå§‹åŒ–é…ç½®</span>
    config := viper.<span class="function">New</span>()
    config.<span class="function">SetConfigName</span>(<span class="string">"config"</span>)
    config.<span class="function">SetConfigType</span>(<span class="string">"yaml"</span>)
    config.<span class="function">AddConfigPath</span>(<span class="string">"./"</span>)
    config.<span class="function">ReadInConfig</span>()
    
    <span class="comment">// åˆå§‹åŒ–æ—¥å¿—</span>
    logger, _ := zap.<span class="function">NewProduction</span>()
    
    <span class="comment">// åˆå§‹åŒ–æ•°æ®åº“</span>
    dsn := config.<span class="function">GetString</span>(<span class="string">"database.dsn"</span>)
    db, _ := gorm.<span class="function">Open</span>(mysql.<span class="function">Open</span>(dsn), &gorm.Config{})
    
    <span class="comment">// åˆå§‹åŒ–è·¯ç”±</span>
    router := gin.<span class="function">Default</span>()
    
    <span class="keyword">return</span> &App{
        Router: router,
        DB:     db,
        Config: config,
        Logger: logger,
    }
}

<span class="function">func</span> (a *App) <span class="function">Run</span>() {
    port := a.Config.<span class="function">GetString</span>(<span class="string">"server.port"</span>)
    a.Logger.<span class="function">Info</span>(<span class="string">"Starting server"</span>, zap.<span class="function">String</span>(<span class="string">"port"</span>, port))
    a.Router.<span class="function">Run</span>(<span class="string">":"</span> + port)
}

<span class="function">func</span> <span class="function">main</span>() {
    app := <span class="function">NewApp</span>()
    app.<span class="function">Run</span>()
}</code></pre>
            </div>
            
            <h2 id="validator">Validator å‚æ•°æ ¡éªŒ</h2>
            
            <h3>ç®€ä»‹</h3>
            <p>Validator æ˜¯ Go è¯­è¨€ä¸­æœ€æµè¡Œçš„å‚æ•°æ ¡éªŒåº“ï¼ŒåŸºäºç»“æ„ä½“æ ‡ç­¾å®ç°ï¼Œæ”¯æŒå¤šç§æ ¡éªŒè§„åˆ™ï¼Œå¯ä»¥è½»æ¾é›†æˆåˆ° Gin ç­‰ Web æ¡†æ¶ä¸­ã€‚å®ƒæ”¯æŒè‡ªå®šä¹‰æ ¡éªŒè§„åˆ™ã€å›½é™…åŒ–é”™è¯¯æ¶ˆæ¯ç­‰åŠŸèƒ½ã€‚</p>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get -u github.com/go-playground/validator/v10</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/go-playground/validator/v10"</span>
)

<span class="keyword">type</span> User <span class="keyword">struct</span> {
    Name  <span class="keyword">string</span> <span class="string">`validate:"required,min=3,max=32"`</span>
    Email <span class="keyword">string</span> <span class="string">`validate:"required,email"`</span>
    Age   <span class="keyword">int</span>    <span class="string">`validate:"required,gte=0,lte=130"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    validate := validator.<span class="function">New</span>()
    
    user := User{
        Name:  <span class="string">"Alice"</span>,
        Email: <span class="string">"alice@example.com"</span>,
        Age:   <span class="number">25</span>,
    }
    
    err := validate.<span class="function">Struct</span>(user)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Validation failed:"</span>, err)
        <span class="keyword">return</span>
    }
    
    fmt.<span class="function">Println</span>(<span class="string">"Validation passed!"</span>)
}</code></pre>
            
            <h3>å¸¸ç”¨æ ¡éªŒè§„åˆ™</h3>
            <pre><code><span class="keyword">type</span> User <span class="keyword">struct</span> {
    <span class="comment">// å¿…å¡«å­—æ®µ</span>
    Name <span class="keyword">string</span> <span class="string">`validate:"required"`</span>
    
    <span class="comment">// å­—ç¬¦ä¸²é•¿åº¦</span>
    Username <span class="keyword">string</span> <span class="string">`validate:"min=3,max=20"`</span>
    
    <span class="comment">// é‚®ç®±æ ¼å¼</span>
    Email <span class="keyword">string</span> <span class="string">`validate:"email"`</span>
    
    <span class="comment">// URL æ ¼å¼</span>
    Website <span class="keyword">string</span> <span class="string">`validate:"url"`</span>
    
    <span class="comment">// æ•°å€¼èŒƒå›´</span>
    Age <span class="keyword">int</span> <span class="string">`validate:"gte=0,lte=130"`</span>
    
    <span class="comment">// å¤§äºç­‰äº (gte)ã€å¤§äº (gt)ã€å°äºç­‰äº (lte)ã€å°äº (lt)</span>
    Price <span class="keyword">float64</span> <span class="string">`validate:"gt=0"`</span>
    
    <span class="comment">// æ­£åˆ™è¡¨è¾¾å¼</span>
    Phone <span class="keyword">string</span> <span class="string">`validate:"required,^1[3-9]\\d{9}$"`</span>
    
    <span class="comment">// æšä¸¾å€¼</span>
    Gender <span class="keyword">string</span> <span class="string">`validate:"oneof=male female other"`</span>
    
    <span class="comment">// å­—ç¬¦ä¸²åŒ…å«</span>
    Password <span class="keyword">string</span> <span class="string">`validate:"containsany=!@#$%"`</span>
    
    <span class="comment">// å”¯ä¸€æ€§ï¼ˆéœ€è¦è‡ªå®šä¹‰æ ¡éªŒï¼‰</span>
    Username <span class="keyword">string</span> <span class="string">`validate:"unique"`</span>
    
    <span class="comment">// å¯é€‰å­—æ®µ</span>
    Nickname <span class="keyword">string</span> <span class="string">`validate:"omitempty,min=2"`</span>
    
    <span class="comment">// æ’é™¤æŸäº›å€¼</span>
    Role <span class="keyword">string</span> <span class="string">`validate:"nefield=Password"`</span>
    
    <span class="comment">// å­—æ®µç›¸ç­‰</span>
    ConfirmPassword <span class="keyword">string</span> <span class="string">`validate:"eqfield=Password"`</span>
    
    <span class="comment">// å­—æ®µä¸ç­‰</span>
    NewEmail <span class="keyword">string</span> <span class="string">`validate:"nefield=OldEmail"`</span>
}</code></pre>
            
            <h3>é”™è¯¯å¤„ç†</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/go-playground/validator/v10"</span>
)

<span class="function">func</span> <span class="function">handleValidationError</span>(err <span class="keyword">error</span>) {
    <span class="comment">// ç±»å‹æ–­è¨€</span>
    validationErrors, ok := err.(validator.ValidationErrors)
    <span class="keyword">if</span> !ok {
        fmt.<span class="function">Println</span>(<span class="string">"Unknown error:"</span>, err)
        <span class="keyword">return</span>
    }
    
    <span class="comment">// éå†æ‰€æœ‰é”™è¯¯</span>
    <span class="keyword">for</span>, e := <span class="keyword">range</span> validationErrors {
        fmt.<span class="function">Printf</span>(<span class="string">"Field: %s, Tag: %s, Param: %s\n"</span>, e.<span class="function">Field</span>(), e.<span class="function">Tag</span>(), e.<span class="function">Param</span>())
    }
}

<span class="comment">// è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯</span>
<span class="keyword">type</span> ErrorResponse <span class="keyword">struct</span> {
    Field   <span class="keyword">string</span> <span class="string">`json:"field"`</span>
    Message <span class="keyword">string</span> <span class="string">`json:"message"`</span>
}

<span class="function">func</span> <span class="function">getValidationErrors</span>(err <span class="keyword">error</span>) []ErrorResponse {
    <span class="keyword">var</span> errors []ErrorResponse
    
    validationErrors := err.(validator.ValidationErrors)
    <span class="keyword">for</span>, e := <span class="keyword">range</span> validationErrors {
        errors = <span class="function">append</span>(errors, ErrorResponse{
            Field:   e.<span class="function">Field</span>(),
            Message: <span class="function">getErrorMessage</span>(e),
        })
    }
    
    <span class="keyword">return</span> errors
}

<span class="function">func</span> <span class="function">getErrorMessage</span>(e validator.FieldError) <span class="keyword">string</span> {
    <span class="keyword">switch</span> e.<span class="function">Tag</span>() {
    <span class="keyword">case</span> <span class="string">"required"</span>:
        <span class="keyword">return</span> fmt.<span class="function">Sprintf</span>(<span class="string">"%s is required"</span>, e.<span class="function">Field</span>())
    <span class="keyword">case</span> <span class="string">"email"</span>:
        <span class="keyword">return</span> fmt.<span class="function">Sprintf</span>(<span class="string">"%s must be a valid email"</span>, e.<span class="function">Field</span>())
    <span class="keyword">case</span> <span class="string">"min"</span>:
        <span class="keyword">return</span> fmt.<span class="function">Sprintf</span>(<span class="string">"%s must be at least %s characters"</span>, e.<span class="function">Field</span>(), e.<span class="function">Param</span>())
    <span class="keyword">case</span> <span class="string">"max"</span>:
        <span class="keyword">return</span> fmt.<span class="function">Sprintf</span>(<span class="string">"%s must be at most %s characters"</span>, e.<span class="function">Field</span>(), e.<span class="function">Param</span>())
    <span class="keyword">default</span>:
        <span class="keyword">return</span> fmt.<span class="function">Sprintf</span>(<span class="string">"%s is invalid"</span>, e.<span class="function">Field</span>())
    }
}</code></pre>
            
            <h3>è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/go-playground/validator/v10"</span>
    <span class="string">"regexp"</span>
)

<span class="comment">// è‡ªå®šä¹‰æ ¡éªŒï¼šæ‰‹æœºå·</span>
<span class="function">func</span> <span class="function">validateMobile</span>(fl validator.FieldLevel) <span class="keyword">bool</span> {
    mobile := fl.<span class="function">Field</span>().<span class="function">String</span>()
    matched, _ := regexp.<span class="function">MatchString</span>(<span class="string">`^1[3-9]\d{9}$`</span>, mobile)
    <span class="keyword">return</span> matched
}

<span class="comment">// è‡ªå®šä¹‰æ ¡éªŒï¼šç”¨æˆ·åå”¯ä¸€æ€§</span>
<span class="function">func</span> <span class="function">validateUsernameUnique</span>(fl validator.FieldLevel) <span class="keyword">bool</span> {
    username := fl.<span class="function">Field</span>().<span class="function">String</span>()
    <span class="comment">// è¿™é‡Œåº”è¯¥æŸ¥è¯¢æ•°æ®åº“æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨</span>
    <span class="comment">// ç®€åŒ–ç¤ºä¾‹ï¼šå‡è®¾ç”¨æˆ·åä¸èƒ½æ˜¯ "admin"</span>
    <span class="keyword">return</span> username != <span class="string">"admin"</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    validate := validator.<span class="function">New</span>()
    
    <span class="comment">// æ³¨å†Œè‡ªå®šä¹‰æ ¡éªŒ</span>
    validate.<span class="function">RegisterValidation</span>(<span class="string">"mobile"</span>, <span class="function">validateMobile</span>)
    validate.<span class="function">RegisterValidation</span>(<span class="string">"username_unique"</span>, <span class="function">validateUsernameUnique</span>)
    
    <span class="keyword">type</span> User <span class="keyword">struct</span> {
        Username <span class="keyword">string</span> <span class="string">`validate:"required,username_unique"`</span>
        Mobile   <span class="keyword">string</span> <span class="string">`validate:"required,mobile"`</span>
    }
    
    user := User{
        Username: <span class="string">"admin"</span>,
        Mobile:   <span class="string">"13800138000"</span>,
    }
    
    err := validate.<span class="function">Struct</span>(user)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Validation failed:"</span>, err)
    }
}</code></pre>
            
            <h3>ä¸ Gin é›†æˆ</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/gin-gonic/gin"</span>
    <span class="string">"github.com/go-playground/validator/v10"</span>
    <span class="string">"net/http"</span>
)

<span class="keyword">type</span> CreateUserRequest <span class="keyword">struct</span> {
    Name     <span class="keyword">string</span> <span class="string">`json:"name" validate:"required,min=3,max=32"`</span>
    Email    <span class="keyword">string</span> <span class="string">`json:"email" validate:"required,email"`</span>
    Password <span class="keyword">string</span> <span class="string">`json:"password" validate:"required,min=8"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    r := gin.<span class="function">Default</span>()
    
    <span class="comment">// è·å– Gin çš„ validator</span>
    <span class="keyword">if</span> v, ok := binding.Validator.<span class="function">Engine</span>().(*validator.Validate); ok {
        <span class="comment">// æ³¨å†Œè‡ªå®šä¹‰æ ¡éªŒ</span>
        v.<span class="function">RegisterValidation</span>(<span class="string">"mobile"</span>, <span class="function">validateMobile</span>)
    }
    
    r.<span class="function">POST</span>(<span class="string">"/users"</span>, <span class="keyword">func</span>(c *gin.Context) {
        <span class="keyword">var</span> req CreateUserRequest
        
        <span class="comment">// ç»‘å®šå’Œæ ¡éªŒ</span>
        <span class="keyword">if</span> err := c.<span class="function">ShouldBindJSON</span>(&req); err != <span class="keyword">nil</span> {
            c.<span class="function">JSON</span>(http.StatusBadRequest, gin.H{
                <span class="string">"error"</span>: <span class="function">getValidationErrors</span>(err),
            })
            <span class="keyword">return</span>
        }
        
        c.<span class="function">JSON</span>(http.StatusCreated, gin.H{
            <span class="string">"message"</span>: <span class="string">"User created"</span>,
            <span class="string">"user"</span>:    req,
        })
    })
    
    r.<span class="function">Run</span>(<span class="string">":8080"</span>)
}</code></pre>
            
            <h3>ç»“æ„ä½“åµŒå¥—æ ¡éªŒ</h3>
            <pre><code><span class="keyword">type</span> Address <span class="keyword">struct</span> {
    Street  <span class="keyword">string</span> <span class="string">`validate:"required"`</span>
    City    <span class="keyword">string</span> <span class="string">`validate:"required"`</span>
    ZipCode <span class="keyword">string</span> <span class="string">`validate:"required,len=6"`</span>
}

<span class="keyword">type</span> User <span class="keyword">struct</span> {
    Name    <span class="keyword">string</span>  <span class="string">`validate:"required"`</span>
    Address Address  <span class="string">`validate:"required,dive"`</span>  <span class="comment">// dive è¡¨ç¤ºæ ¡éªŒåµŒå¥—ç»“æ„ä½“</span>
}</code></pre>
            
            <h3>æ•°ç»„/åˆ‡ç‰‡æ ¡éªŒ</h3>
            <pre><code><span class="keyword">type</span> Order <span class="keyword">struct</span> {
    Items []Item <span class="string">`validate:"required,min=1,dive"`</span>  <span class="comment">// æ ¡éªŒæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ </span>
}

<span class="keyword">type</span> Item <span class="keyword">struct</span> {
    Name  <span class="keyword">string</span>  <span class="string">`validate:"required"`</span>
    Price <span class="keyword">float64</span> <span class="string">`validate:"required,gt=0"`</span>
}</code></pre>
            
            <h2 id="cobra">Cobra å‘½ä»¤è¡Œå·¥å…·</h2>
            
            <h3>ç®€ä»‹</h3>
            <p>Cobra æ˜¯ Go è¯­è¨€ä¸­æœ€æµè¡Œçš„å‘½ä»¤è¡Œåº”ç”¨æ¡†æ¶ï¼Œè¢«å¹¿æ³›ç”¨äºè®¸å¤šçŸ¥åé¡¹ç›®ï¼ˆå¦‚ Dockerã€Kubernetesã€Hugo ç­‰ï¼‰ã€‚å®ƒæä¾›äº†å¼ºå¤§çš„å‘½ä»¤è§£æã€å­å‘½ä»¤æ”¯æŒã€è‡ªåŠ¨ç”Ÿæˆå¸®åŠ©æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚</p>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get -u github.com/spf13/cobra
<span class="keyword">go</span> get -u github.com/spf13/pflag</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/spf13/cobra"</span>
)

<span class="keyword">func</span> <span class="function">main</span>() {
    <span class="keyword">var</span> name <span class="keyword">string</span>
    
    rootCmd := &cobra.Command{
        Use:   <span class="string">"myapp"</span>,
        Short: <span class="string">"My application"</span>,
        Long:  <span class="string">"A longer description of my application"</span>,
        Run: <span class="keyword">func</span>(cmd *cobra.Command, args []<span class="keyword">string</span>) {
            fmt.<span class="function">Printf</span>(<span class="string">"Hello, %s!\n"</span>, name)
        },
    }
    
    rootCmd.<span class="function">Flags</span>().<span class="function">StringVarP</span>(&name, <span class="string">"name"</span>, <span class="string">"n"</span>, <span class="string">"World"</span>, <span class="string">"Name to greet"</span>)
    
    rootCmd.<span class="function">Execute</span>()
}</code></pre>
            
            <h3>å­å‘½ä»¤</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/spf13/cobra"</span>
)

<span class="keyword">func</span> <span class="function">main</span>() {
    rootCmd := &cobra.Command{
        Use:   <span class="string">"myapp"</span>,
        Short: <span class="string">"My application"</span>,
    }
    
    <span class="comment">// æ·»åŠ å­å‘½ä»¤</span>
    rootCmd.<span class="function">AddCommand</span>(<span class="function">createCommand</span>())
    rootCmd.<span class="function">AddCommand</span>(<span class="function">listCommand</span>())
    rootCmd.<span class="function">AddCommand</span>(<span class="function">deleteCommand</span>())
    
    rootCmd.<span class="function">Execute</span>()
}

<span class="function">func</span> <span class="function">createCommand</span>() *cobra.Command {
    <span class="keyword">return</span> &cobra.Command{
        Use:   <span class="string">"create"</span>,
        Short: <span class="string">"Create a new resource"</span>,
        Run: <span class="keyword">func</span>(cmd *cobra.Command, args []<span class="keyword">string</span>) {
            fmt.<span class="function">Println</span>(<span class="string">"Creating resource..."</span>)
        },
    }
}

<span class="function">func</span> <span class="function">listCommand</span>() *cobra.Command {
    <span class="keyword">return</span> &cobra.Command{
        Use:   <span class="string">"list"</span>,
        Short: <span class="string">"List all resources"</span>,
        Run: <span class="keyword">func</span>(cmd *cobra.Command, args []<span class="keyword">string</span>) {
            fmt.<span class="function">Println</span>(<span class="string">"Listing resources..."</span>)
        },
    }
}

<span class="function">func</span> <span class="function">deleteCommand</span>() *cobra.Command {
    <span class="keyword">return</span> &cobra.Command{
        Use:   <span class="string">"delete [id]"</span>,
        Short: <span class="string">"Delete a resource"</span>,
        Args:  cobra.ExactArgs(<span class="number">1</span>),
        Run: <span class="keyword">func</span>(cmd *cobra.Command, args []<span class="keyword">string</span>) {
            fmt.<span class="function">Printf</span>(<span class="string">"Deleting resource: %s\n"</span>, args[<span class="number">0</span>])
        },
    }
}</code></pre>
            
            <h3>å‚æ•°éªŒè¯</h3>
            <pre><code><span class="keyword">func</span> <span class="function">createCommand</span>() *cobra.Command {
    <span class="keyword">var</span> name <span class="keyword">string</span>
    <span class="keyword">var</span> age <span class="keyword">int</span>
    
    cmd := &cobra.Command{
        Use:   <span class="string">"create"</span>,
        Short: <span class="string">"Create a new user"</span>,
        Run: <span class="keyword">func</span>(cmd *cobra.Command, args []<span class="keyword">string</span>) {
            <span class="comment">// éªŒè¯å‚æ•°</span>
            <span class="keyword">if</span> name == <span class="string">""</span> {
                fmt.<span class="function">Println</span>(<span class="string">"Error: name is required"</span>)
                <span class="keyword">return</span>
            }
            <span class="keyword">if</span> age <= <span class="number">0</span> {
                fmt.<span class="function">Println</span>(<span class="string">"Error: age must be positive"</span>)
                <span class="keyword">return</span>
            }
            
            fmt.<span class="function">Printf</span>(<span class="string">"Creating user: %s, age: %d\n"</span>, name, age)
        },
    }
    
    cmd.<span class="function">Flags</span>().<span class="function">StringVarP</span>(&name, <span class="string">"name"</span>, <span class="string">"n"</span>, <span class="string">""</span>, <span class="string">"User name"</span>)
    cmd.<span class="function">Flags</span>().<span class="function">IntVarP</span>(&age, <span class="string">"age"</span>, <span class="string">"a"</span>, <span class="number">0</span>, <span class="string">"User age"</span>)
    
    <span class="comment">// æ ‡è®°ä¸ºå¿…å¡«</span>
    cmd.<span class="function">MarkFlagRequired</span>(<span class="string">"name"</span>)
    
    <span class="keyword">return</span> cmd
}</code></pre>
            
            <h3>æŒä¹…åŒ–æ ‡å¿—</h3>
            <pre><code><span class="keyword">func</span> <span class="function">main</span>() {
    <span class="keyword">var</span> verbose <span class="keyword">bool</span>
    <span class="keyword">var</span> config <span class="keyword">string</span>
    
    rootCmd := &cobra.Command{
        Use:   <span class="string">"myapp"</span>,
        Short: <span class="string">"My application"</span>,
        PersistentPreRun: <span class="keyword">func</span>(cmd *cobra.Command, args []<span class="keyword">string</span>) {
            <span class="keyword">if</span> verbose {
                fmt.<span class="function">Println</span>(<span class="string">"Verbose mode enabled"</span>)
            }
            fmt.<span class="function">Printf</span>(<span class="string">"Using config: %s\n"</span>, config)
        },
    }
    
    <span class="comment">// æŒä¹…åŒ–æ ‡å¿—ï¼šæ‰€æœ‰å­å‘½ä»¤éƒ½å¯ä»¥ä½¿ç”¨</span>
    rootCmd.<span class="function">PersistentFlags</span>().<span class="function">BoolVarP</span>(&verbose, <span class="string">"verbose"</span>, <span class="string">"v"</span>, <span class="keyword">false</span>, <span class="string">"Verbose output"</span>)
    rootCmd.<span class="function">PersistentFlags</span>().<span class="function">StringVarP</span>(&config, <span class="string">"config"</span>, <span class="string">"c"</span>, <span class="string">"config.yaml"</span>, <span class="string">"Config file"</span>)
    
    rootCmd.<span class="function">AddCommand</span>(<span class="function">createCommand</span>())
    rootCmd.<span class="function">Execute</span>()
}</code></pre>
            
            <h3>é…ç½®æ–‡ä»¶é›†æˆ</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/spf13/cobra"</span>
    <span class="string">"github.com/spf13/viper"</span>
)

<span class="keyword">func</span> <span class="function">main</span>() {
    rootCmd := &cobra.Command{
        Use:   <span class="string">"myapp"</span>,
        Short: <span class="string">"My application"</span>,
        PersistentPreRun: <span class="keyword">func</span>(cmd *cobra.Command, args []<span class="keyword">string</span>) {
            <span class="comment">// åˆå§‹åŒ– Viper</span>
            viper.<span class="function">SetConfigName</span>(<span class="string">"config"</span>)
            viper.<span class="function">SetConfigType</span>(<span class="string">"yaml"</span>)
            viper.<span class="function">AddConfigPath</span>(<span class="string">"./"</span>)
            
            <span class="keyword">if</span> err := viper.<span class="function">ReadInConfig</span>(); err != <span class="keyword">nil</span> {
                fmt.<span class="function">Println</span>(<span class="string">"Using default config"</span>)
            }
            
            <span class="comment">// ç»‘å®šå‘½ä»¤è¡Œæ ‡å¿—</span>
            viper.<span class="function">BindPFlag</span>(<span class="string">"port"</span>, cmd.<span class="function">PersistentFlags</span>().<span class="function">Lookup</span>(<span class="string">"port"</span>))
        },
    }
    
    rootCmd.<span class="function">PersistentFlags</span>().<span class="function">IntP</span>(<span class="string">"port"</span>, <span class="string">"p"</span>, <span class="number">8080</span>, <span class="string">"Server port"</span>)
    
    rootCmd.<span class="function">AddCommand</span>(<span class="function">serveCommand</span>())
    rootCmd.<span class="function">Execute</span>()
}

<span class="function">func</span> <span class="function">serveCommand</span>() *cobra.Command {
    <span class="keyword">return</span> &cobra.Command{
        Use:   <span class="string">"serve"</span>,
        Short: <span class="string">"Start the server"</span>,
        Run: <span class="keyword">func</span>(cmd *cobra.Command, args []<span class="keyword">string</span>) {
            port := viper.<span class="function">GetInt</span>(<span class="string">"port"</span>)
            fmt.<span class="function">Printf</span>(<span class="string">"Starting server on port %d\n"</span>, port)
        },
    }
}</code></pre>
            
            <h3>è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/spf13/cobra"</span>
    <span class="string">"github.com/spf13/cobra/doc"</span>
)

<span class="keyword">func</span> <span class="function">main</span>() {
    rootCmd := &cobra.Command{
        Use:   <span class="string">"myapp"</span>,
        Short: <span class="string">"My application"</span>,
        Run: <span class="keyword">func</span>(cmd *cobra.Command, args []<span class="keyword">string</span>) {
            fmt.<span class="function">Println</span>(<span class="string">"Hello, World!"</span>)
        },
    }
    
    rootCmd.<span class="function">AddCommand</span>(&cobra.Command{
        Use:   <span class="string">"version"</span>,
        Short: <span class="string">"Print version"</span>,
        Run: <span class="keyword">func</span>(cmd *cobra.Command, args []<span class="keyword">string</span>) {
            fmt.<span class="function">Println</span>(<span class="string">"Version 1.0.0"</span>)
        },
    })
    
    <span class="comment">// ç”Ÿæˆ Markdown æ–‡æ¡£</span>
    doc.<span class="function">GenMarkdownTree</span>(rootCmd, <span class="string">"./docs"</span>)
    
    <span class="comment">// ç”Ÿæˆ Man é¡µé¢</span>
    doc.<span class="function">GenManTree</span>(rootCmd, &doc.GenManHeader{
        Section: <span class="string">"1"</span>,
    }, <span class="string">"./man"</span>)
    
    <span class="comment">// ç”Ÿæˆ ReStructuredText</span>
    doc.<span class="function">GenReSTTree</span>(rootCmd, <span class="string">"./rst"</span>)
}</code></pre>
            
            <h3>Shell è‡ªåŠ¨è¡¥å…¨</h3>
            <pre><code><span class="keyword">func</span> <span class="function">main</span>() {
    rootCmd := &cobra.Command{
        Use:   <span class="string">"myapp"</span>,
        Short: <span class="string">"My application"</span>,
    }
    
    <span class="comment">// ç”Ÿæˆ Bash è¡¥å…¨</span>
    rootCmd.<span class="function">GenBashCompletionFile</span>(<span class="string">"/etc/bash_completion.d/myapp"</span>)
    
    <span class="comment">// ç”Ÿæˆ Zsh è¡¥å…¨</span>
    rootCmd.<span class="function">GenZshCompletionFile</span>(<span class="string">"/usr/local/share/zsh/site-functions/_myapp"</span>)
    
    <span class="comment">// ç”Ÿæˆ Fish è¡¥å…¨</span>
    rootCmd.<span class="function">GenFishCompletionFile</span>(<span class="string">"/usr/share/fish/vendor_completions.d/myapp.fish"</span>)
    
    rootCmd.<span class="function">Execute</span>()
}</code></pre>
            
            <h2 id="gomicro">Go-Micro å¾®æœåŠ¡æ¡†æ¶</h2>
            
            <h3>ç®€ä»‹</h3>
            <p>Go-Micro æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºå¾®æœåŠ¡çš„ Go è¯­è¨€æ¡†æ¶ï¼Œæä¾›æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€æ¶ˆæ¯ç¼–ç ã€RPC é€šä¿¡ç­‰åŠŸèƒ½ã€‚å®ƒæ”¯æŒå¤šç§ä¼ è¾“åè®®ã€ç¼–ç æ ¼å¼å’ŒæœåŠ¡å‘ç°æœºåˆ¶ï¼Œæ˜¯æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿçš„ç†æƒ³é€‰æ‹©ã€‚</p>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get -u github.com/micro/go-micro/v2
<span class="keyword">go</span> get -u github.com/micro/go-micro/v2/api</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"github.com/micro/go-micro/v2"</span>
    proto <span class="string">"github.com/micro/go-micro/v2/examples/greeter/proto"</span>
)

<span class="keyword">type</span> Greeter <span class="keyword">struct</span> {}

<span class="function">func</span> (g *Greeter) <span class="function">Hello</span>(ctx context.Context, req *proto.HelloRequest, rsp *proto.HelloResponse) <span class="keyword">error</span> {
    rsp.Greeting = <span class="string">"Hello "</span> + req.Name
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºæœåŠ¡</span>
    service := micro.<span class="function">NewService</span>(
        micro.<span class="function">Name</span>(<span class="string">"greeter"</span>),
        micro.<span class="function">Version</span>(<span class="string">"latest"</span>),
    )
    
    <span class="comment">// åˆå§‹åŒ–æœåŠ¡</span>
    service.<span class="function">Init</span>()
    
    <span class="comment">// æ³¨å†Œå¤„ç†å™¨</span>
    proto.<span class="function">RegisterGreeterHandler</span>(service.<span class="function">Server</span>(), &Greeter{})
    
    <span class="comment">// è¿è¡ŒæœåŠ¡</span>
    <span class="keyword">if</span> err := service.<span class="function">Run</span>(); err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(err)
    }
}</code></pre>
            
            <h3>æœåŠ¡å‘ç°</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"fmt"</span>
    <span class="string">"time"</span>
    
    <span class="string">"github.com/micro/go-micro/v2"</span>
    <span class="string">"github.com/micro/go-micro/v2/client"</span>
    <span class="string">"github.com/micro/go-micro/v2/registry"</span>
    <span class="string">"github.com/micro/go-micro/v2/registry/etcd"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ä½¿ç”¨ Etcd ä½œä¸ºæ³¨å†Œä¸­å¿ƒ</span>
    reg := etcd.<span class="function">NewRegistry</span>(registry.<span class="function">Addrs</span>(<span class="string">"127.0.0.1:2379"</span>))
    
    <span class="comment">// åˆ›å»ºæœåŠ¡</span>
    service := micro.<span class="function">NewService</span>(
        micro.<span class="function">Registry</span>(reg),
        micro.<span class="function">Name</span>(<span class="string">"greeter"</span>),
    )
    
    service.<span class="function">Init</span>()
    
    <span class="comment">// åˆ›å»ºå®¢æˆ·ç«¯</span>
    cli := service.<span class="function">Client</span>()
    
    <span class="comment">// è°ƒç”¨æœåŠ¡</span>
    rsp := &HelloResponse{}
    err := cli.<span class="function">Call</span>(
        context.<span class="function">Background</span>(),
        client.NewRequest(<span class="string">"greeter"</span>, <span class="string">"Greeter.Hello"</span>, &HelloRequest{Name: <span class="string">"World"</span>}),
        rsp,
        client.<span class="function">WithRetries</span>(<span class="number">3</span>),
        client.<span class="function">WithRequestTimeout</span>(time.Second * <span class="number">5</span>),
    )
    
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Error:"</span>, err)
        <span class="keyword">return</span>
    }
    
    fmt.<span class="function">Println</span>(<span class="string">"Response:"</span>, rsp.Greeting)
}</code></pre>
            
            <h3>æœåŠ¡é—´é€šä¿¡</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"github.com/micro/go-micro/v2"</span>
)

<span class="comment">// å®šä¹‰æœåŠ¡æ¥å£</span>
<span class="keyword">type</span> UserService <span class="keyword">interface</span> {
    <span class="function">GetUser</span>(ctx context.Context, req *GetUserRequest, rsp *GetUserResponse) <span class="keyword">error</span>
}

<span class="comment">// æœåŠ¡ Aï¼šç”¨æˆ·æœåŠ¡</span>
<span class="keyword">type</span> UserHandler <span class="keyword">struct</span> {}

<span class="function">func</span> (h *UserHandler) <span class="function">GetUser</span>(ctx context.Context, req *GetUserRequest, rsp *GetUserResponse) <span class="keyword">error</span> {
    <span class="comment">// è·å–ç”¨æˆ·ä¿¡æ¯</span>
    rsp.User = &User{ID: req.Id, Name: <span class="string">"Alice"</span>}
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="comment">// æœåŠ¡ Bï¼šè®¢å•æœåŠ¡</span>
<span class="keyword">type</span> OrderHandler <span class="keyword">struct</span> {
    userService UserService
}

<span class="function">func</span> (h *OrderHandler) <span class="function">CreateOrder</span>(ctx context.Context, req *CreateOrderRequest, rsp *CreateOrderResponse) <span class="keyword">error</span> {
    <span class="comment">// è°ƒç”¨ç”¨æˆ·æœåŠ¡</span>
    userReq := &GetUserRequest{Id: req.UserId}
    userRsp := &GetUserResponse{}
    err := h.userService.<span class="function">GetUser</span>(ctx, userReq, userRsp)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    
    <span class="comment">// åˆ›å»ºè®¢å•</span>
    rsp.Order = &Order{ID: <span class="string">"1"</span>, User: userRsp.User}
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºæœåŠ¡</span>
    service := micro.<span class="function">NewService</span>(
        micro.<span class="function">Name</span>(<span class="string">"order"</span>),
    )
    
    service.<span class="function">Init</span>()
    
    <span class="comment">// åˆ›å»ºç”¨æˆ·æœåŠ¡å®¢æˆ·ç«¯</span>
    userService := micro.<span class="function">NewService</span>(
        micro.<span class="function">Name</span>(<span class="string">"order"</span>),  <span class="comment">// ä½¿ç”¨å½“å‰æœåŠ¡çš„å®¢æˆ·ç«¯</span>
    )
    
    <span class="comment">// æ³¨å†Œè®¢å•æœåŠ¡</span>
    micro.<span class="function">RegisterHandler</span>(service.<span class="function">Server</span>(), &OrderHandler{
        userService: userService.<span class="function">Client</span>(),
    })
    
    service.<span class="function">Run</span>()
}</code></pre>
            
            <h3>æ¶ˆæ¯å‘å¸ƒè®¢é˜…</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"fmt"</span>
    <span class="string">"time"</span>
    
    <span class="string">"github.com/micro/go-micro/v2"</span>
    <span class="string">"github.com/micro/go-micro/v2/broker"</span>
    <span class="string">"github.com/micro/go-micro/v2/broker/nats"</span>
)

<span class="comment">// å‘å¸ƒè€…</span>
<span class="function">func</span> <span class="function">publisher</span>() {
    <span class="comment">// åˆ›å»º Broker</span>
    b := nats.<span class="function">NewBroker</span>(broker.<span class="function">Addrs</span>(<span class="string">"127.0.0.1:4222"</span>))
    
    <span class="keyword">if</span> err := b.<span class="function">Connect</span>(); err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Broker connect error:"</span>, err)
        <span class="keyword">return</span>
    }
    
    <span class="comment">// å‘å¸ƒæ¶ˆæ¯</span>
    msg := &broker.Message{
        Header: <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>{
            <span class="string">"Content-Type"</span>: <span class="string">"application/json"</span>,
        },
        Body: []<span class="keyword">byte</span>(<span class="string">`{"event":"user.created","user_id":"123"}`</span>),
    }
    
    <span class="keyword">if</span> err := b.<span class="function">Publish</span>(<span class="string">"user.created"</span>, msg); err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(<span class="string">"Publish error:"</span>, err)
    }
}

<span class="comment">// è®¢é˜…è€…</span>
<span class="function">func</span> <span class="function">subscriber</span>() {
    <span class="comment">// åˆ›å»ºæœåŠ¡</span>
    service := micro.<span class="function">NewService</span>(
        micro.<span class="function">Broker</span>(nats.<span class="function">NewBroker</span>(broker.<span class="function">Addrs</span>(<span class="string">"127.0.0.1:4222"</span>))),
    )
    
    service.<span class="function">Init</span>()
    
    <span class="comment">// è®¢é˜…æ¶ˆæ¯</span>
    micro.<span class="function">RegisterSubscriber</span>(<span class="string">"user.created"</span>, service.<span class="function">Server</span>(), <span class="keyword">func</span>(ctx context.Context, msg *broker.Message) <span class="keyword">error</span> {
        fmt.<span class="function">Printf</span>(<span class="string">"Received message: %s\n"</span>, string(msg.Body))
        <span class="keyword">return</span> <span class="keyword">nil</span>
    })
    
    service.<span class="function">Run</span>()
}</code></pre>
            
            <h3>ä¸­é—´ä»¶</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"fmt"</span>
    <span class="string">"time"</span>
    
    <span class="string">"github.com/micro/go-micro/v2"</span>
    <span class="string">"github.com/micro/go-micro/v2/server"</span>
)

<span class="comment">// æ—¥å¿—ä¸­é—´ä»¶</span>
<span class="function">func</span> <span class="function">logWrapper</span>(fn server.HandlerFunc) server.HandlerFunc {
    <span class="keyword">return</span> <span class="keyword">func</span>(ctx context.Context, req server.Request, rsp interface{}) <span class="keyword">error</span> {
        fmt.<span class="function">Printf</span>(<span class="string">"[Request] %s %s\n"</span>, req.<span class="function">Method</span>(), req.<span class="function">Endpoint</span>())
        err := fn(ctx, req, rsp)
        fmt.<span class="function">Printf</span>(<span class="string">"[Response] %s\n"</span>, err)
        <span class="keyword">return</span> err
    }
}

<span class="comment">// è®¤è¯ä¸­é—´ä»¶</span>
<span class="function">func</span> <span class="function">authWrapper</span>(fn server.HandlerFunc) server.HandlerFunc {
    <span class="keyword">return</span> <span class="keyword">func</span>(ctx context.Context, req server.Request, rsp interface{}) <span class="keyword">error</span> {
        <span class="comment">// æ£€æŸ¥è®¤è¯ä»¤ç‰Œ</span>
        token := req.<span class="function">Header</span>().<span class="function">Get</span>(<span class="string">"Authorization"</span>)
        <span class="keyword">if</span> token == <span class="string">""</span> {
            <span class="keyword">return</span> fmt.<span class="function">Errorf</span>(<span class="string">"Unauthorized"</span>)
        }
        
        <span class="keyword">return</span> fn(ctx, req, rsp)
    }
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºæœåŠ¡</span>
    service := micro.<span class="function">NewService</span>(
        micro.<span class="function">Name</span>(<span class="string">"greeter"</span>),
        micro.<span class="function">WrapHandler</span>(logWrapper),
        micro.<span class="function">WrapHandler</span>(authWrapper),
    )
    
    service.<span class="function">Init</span>()
    service.<span class="function">Run</span>()
}</code></pre>
            
            <h2 id="etcd">Etcd åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨</h2>
            
            <h3>ç®€ä»‹</h3>
            <p>Etcd æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€å¯é çš„é”®å€¼å­˜å‚¨ç³»ç»Ÿï¼Œç”¨äºé…ç½®ç®¡ç†å’ŒæœåŠ¡å‘ç°ã€‚å®ƒä½¿ç”¨ Raft ç®—æ³•ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Œæ”¯æŒå¼ºä¸€è‡´æ€§è¯»å†™ã€äº‹åŠ¡ã€ç§Ÿçº¦ç­‰åŠŸèƒ½ï¼Œæ˜¯ Kubernetes ç­‰é¡¹ç›®çš„æ ¸å¿ƒç»„ä»¶ã€‚</p>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get -u go.etcd.io/etcd/client/v3</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"fmt"</span>
    <span class="string">"time"</span>
    
    <span class="string">"go.etcd.io/etcd/client/v3"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºå®¢æˆ·ç«¯</span>
    cli, err := clientv3.<span class="function">New</span>(clientv3.Config{
        Endpoints:   []<span class="keyword">string</span>{<span class="string">"127.0.0.1:2379"</span>},
        DialTimeout: <span class="number">5</span> * time.Second,
    })
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="function">panic</span>(err)
    }
    <span class="keyword">defer</span> cli.<span class="function">Close</span>()
    
    <span class="comment">// è®¾ç½®é”®å€¼</span>
    ctx, cancel := context.<span class="function">WithTimeout</span>(context.<span class="function">Background</span>(), <span class="number">5</span>*time.Second)
    resp, err := cli.<span class="function">Put</span>(ctx, <span class="string">"key"</span>, <span class="string">"value"</span>)
    cancel()
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="function">panic</span>(err)
    }
    fmt.<span class="function">Println</span>(<span class="string">"Revision:"</span>, resp.Header.Revision)
    
    <span class="comment">// è·å–é”®å€¼</span>
    ctx, cancel = context.<span class="function">WithTimeout</span>(context.<span class="function">Background</span>(), <span class="number">5</span>*time.Second)
    resp, err = cli.<span class="function">Get</span>(ctx, <span class="string">"key"</span>)
    cancel()
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="function">panic</span>(err)
    }
    
    <span class="keyword">for</span> _, ev := <span class="keyword">range</span> resp.Kvs {
        fmt.<span class="function">Printf</span>(<span class="string">"%s : %s\n"</span>, ev.Key, ev.Value)
    }
}</code></pre>
            
            <h3>é”®å€¼æ“ä½œ</h3>
            <pre><code><span class="comment">// è®¾ç½®é”®å€¼</span>
resp, err := cli.<span class="function">Put</span>(ctx, <span class="string">"key"</span>, <span class="string">"value"</span>)

<span class="comment">// è·å–å•ä¸ªé”®</span>
resp, err := cli.<span class="function">Get</span>(ctx, <span class="string">"key"</span>)

<span class="comment">// è·å–å¤šä¸ªé”®ï¼ˆå‰ç¼€åŒ¹é…ï¼‰</span>
resp, err := cli.<span class="function">Get</span>(ctx, <span class="string">"prefix"</span>, clientv3.<span class="function">WithPrefix</span>())

<span class="comment">// è·å–æ‰€æœ‰é”®</span>
resp, err := cli.<span class="function">Get</span>(ctx, <span class="string">""</span>, clientv3.<span class="function">WithFromKey</span>(), clientv3.<span class="function">WithLimit</span>(<span class="number">100</span>))

<span class="comment">// åˆ é™¤é”®</span>
resp, err := cli.<span class="function">Delete</span>(ctx, <span class="string">"key"</span>)

<span class="comment">// åˆ é™¤å¤šä¸ªé”®ï¼ˆå‰ç¼€åŒ¹é…ï¼‰</span>
resp, err := cli.<span class="function">Delete</span>(ctx, <span class="string">"prefix"</span>, clientv3.<span class="function">WithPrefix</span>())

<span class="comment">// åˆ é™¤æ‰€æœ‰é”®</span>
resp, err := cli.<span class="function">Delete</span>(ctx, <span class="string">""</span>, clientv3.<span class="function">WithPrefix</span>())</code></pre>
            
            <h3>ç§Ÿçº¦ï¼ˆLeaseï¼‰</h3>
            <pre><code><span class="comment">// åˆ›å»ºç§Ÿçº¦ï¼ˆ10ç§’è¿‡æœŸï¼‰</span>
lease, err := cli.<span class="function">Grant</span>(ctx, <span class="number">10</span>)
<span class="keyword">if</span> err != <span class="keyword">nil</span> {
    <span class="function">panic</span>(err)
}

<span class="comment">// ç»‘å®šç§Ÿçº¦åˆ°é”®</span>
resp, err := cli.<span class="function">Put</span>(ctx, <span class="string">"key"</span>, <span class="string">"value"</span>, clientv3.<span class="function">WithLease</span>(lease.ID))

<span class="comment">// ç»­ç§Ÿ</span>
keepAlive, err := cli.<span class="function">KeepAlive</span>(ctx, lease.ID)
<span class="keyword">for</span> ka := <span class="keyword">range</span> keepAlive {
    fmt.<span class="function">Printf</span>(<span class="string">"TTL: %d\n"</span>, ka.TTL)
}

<span class="comment">// æ’¤é”€ç§Ÿçº¦</span>
_, err = cli.<span class="function">Revoke</span>(ctx, lease.ID)</code></pre>
            
            <h3>äº‹åŠ¡</h3>
            <pre><code><span class="comment">// äº‹åŠ¡æ“ä½œ</span>
txn := cli.<span class="function">Txn</span>(ctx)

<span class="comment">// If æ¡ä»¶</span>
txn.<span class="function">If</span>(
    clientv3.<span class="function">Compare</span>(clientv3.<span class="function">Value</span>(<span class="string">"key"</span>), <span class="string">"="</span>, <span class="string">"value"</span>),
).
<span class="function">Then</span>(
    clientv3.<span class="function">OpPut</span>(<span class="string">"key"</span>, <span class="string">"new_value"</span>),
).
<span class="function">Else</span>(
    clientv3.<span class="function">OpPut</span>(<span class="string">"key"</span>, <span class="string">"default_value"</span>),
).
<span class="function">Commit</span>()

<span class="comment">// äº‹åŠ¡ç¤ºä¾‹ï¼šåˆ†å¸ƒå¼é”</span>
<span class="function">func</span> <span class="function">acquireLock</span>(cli *clientv3.Client, key <span class="keyword">string</span>, ttl <span class="keyword">int64</span>) (<span class="keyword">bool</span>, error) {
    <span class="comment">// åˆ›å»ºç§Ÿçº¦</span>
    lease, err := cli.<span class="function">Grant</span>(context.<span class="function">Background</span>(), ttl)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="keyword">false</span>, err
    }
    
    <span class="comment">// äº‹åŠ¡ï¼šå¦‚æœé”®ä¸å­˜åœ¨ï¼Œåˆ™è®¾ç½®</span>
    txn := cli.<span class="function">Txn</span>(context.<span class="function">Background</span>())
    txn.<span class="function">If</span>(
        clientv3.<span class="function">Compare</span>(clientv3.<span class="function">CreateRevision</span>(key), <span class="string">"="</span>, <span class="number">0</span>),
    ).
    <span class="function">Then</span>(
        clientv3.<span class="function">OpPut</span>(key, <span class="string">"locked"</span>, clientv3.<span class="function">WithLease</span>(lease.ID)),
    ).
    <span class="function">Commit</span>()
    
    <span class="keyword">return</span> txn.<span class="function">Succeeded</span>(), <span class="keyword">nil</span>
}</code></pre>
            
            <h3>ç›‘å¬å˜åŒ–</h3>
            <pre><code><span class="comment">// ç›‘å¬å•ä¸ªé”®</span>
watchChan := cli.<span class="function">Watch</span>(ctx, <span class="string">"key"</span>)
<span class="keyword">for</span> watchResp := <span class="keyword">range</span> watchChan {
    <span class="keyword">for</span> _, event := <span class="keyword">range</span> watchResp.Events {
        fmt.<span class="function">Printf</span>(<span class="string">"Type: %s, Key: %s, Value: %s\n"</span>, 
            event.Type, event.Kv.Key, event.Kv.Value)
    }
}

<span class="comment">// ç›‘å¬å‰ç¼€</span>
watchChan = cli.<span class="function">Watch</span>(ctx, <span class="string">"prefix"</span>, clientv3.<span class="function">WithPrefix</span>())
<span class="keyword">for</span> watchResp := <span class="keyword">range</span> watchChan {
    <span class="keyword">for</span> _, event := <span class="keyword">range</span> watchResp.Events {
        fmt.<span class="function">Printf</span>(<span class="string">"Type: %s, Key: %s, Value: %s\n"</span>, 
            event.Type, event.Kv.Key, event.Kv.Value)
    }
}

<span class="comment">// ä»æŒ‡å®šç‰ˆæœ¬å¼€å§‹ç›‘å¬</span>
watchChan = cli.<span class="function">Watch</span>(ctx, <span class="string">"key"</span>, clientv3.<span class="function">WithRev</span>(<span class="number">100</span>))</code></pre>
            
            <h3>æœåŠ¡å‘ç°</h3>
            <pre><code><span class="comment">// æ³¨å†ŒæœåŠ¡</span>
<span class="function">func</span> <span class="function">registerService</span>(cli *clientv3.Client, serviceID, address <span class="keyword">string</span>, ttl <span class="keyword">int64</span>) (<span class="keyword">string</span>, error) {
    <span class="comment">// åˆ›å»ºç§Ÿçº¦</span>
    lease, err := cli.<span class="function">Grant</span>(context.<span class="function">Background</span>(), ttl)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="string">""</span>, err
    }
    
    <span class="comment">// æ³¨å†ŒæœåŠ¡</span>
    key := fmt.<span class="function">Sprintf</span>(<span class="string">"/services/%s"</span>, serviceID)
    _, err = cli.<span class="function">Put</span>(context.<span class="function">Background</span>(), key, address, clientv3.<span class="function">WithLease</span>(lease.ID))
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="string">""</span>, err
    }
    
    <span class="comment">// ç»­ç§Ÿ</span>
    keepAlive, err := cli.<span class="function">KeepAlive</span>(context.<span class="function">Background</span>(), lease.ID)
    <span class="keyword">go</span> <span class="keyword">func</span>() {
        <span class="keyword">for</span> <span class="keyword">range</span> keepAlive {
            <span class="comment">// ä¿æŒç»­ç§Ÿ</span>
        }
    }()
    
    <span class="keyword">return</span> fmt.<span class="function">Sprintf</span>(<span class="string">"%d"</span>, lease.ID), <span class="keyword">nil</span>
}

<span class="comment">// å‘ç°æœåŠ¡</span>
<span class="function">func</span> <span class="function">discoverService</span>(cli *clientv3.Client, serviceID <span class="keyword">string</span>) (<span class="keyword">string</span>, error) {
    key := fmt.<span class="function">Sprintf</span>(<span class="string">"/services/%s"</span>, serviceID)
    resp, err := cli.<span class="function">Get</span>(context.<span class="function">Background</span>(), key)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="string">""</span>, err
    }
    
    <span class="keyword">if</span> <span class="function">len</span>(resp.Kvs) == <span class="number">0</span> {
        <span class="keyword">return</span> <span class="string">""</span>, fmt.<span class="function">Errorf</span>(<span class="string">"service not found"</span>)
    }
    
    <span class="keyword">return</span> string(resp.Kvs[<span class="number">0</span>].Value), <span class="keyword">nil</span>
}</code></pre>
            
            <h3>é…ç½®ç®¡ç†</h3>
            <pre><code><span class="comment">// ç›‘å¬é…ç½®å˜åŒ–</span>
<span class="function">func</span> <span class="function">watchConfig</span>(cli *clientv3.Client, key <span class="keyword">string</span>) {
    watchChan := cli.<span class="function">Watch</span>(context.<span class="function">Background</span>(), key)
    <span class="keyword">for</span> watchResp := <span class="keyword">range</span> watchChan {
        <span class="keyword">for</span> _, event := <span class="keyword">range</span> watchResp.Events {
            <span class="keyword">switch</span> event.Type {
            <span class="keyword">case</span> clientv3.EventTypePut:
                fmt.<span class="function">Printf</span>(<span class="string">"Config updated: %s\n"</span>, event.Kv.Value)
                <span class="comment">// é‡æ–°åŠ è½½é…ç½®</span>
            <span class="keyword">case</span> clientv3.EventTypeDelete:
                fmt.<span class="function">Println</span>(<span class="string">"Config deleted"</span>)
            }
        }
    }
}

<span class="comment">// è·å–é…ç½®</span>
<span class="function">func</span> <span class="function">getConfig</span>(cli *clientv3.Client, key <span class="keyword">string</span>) (<span class="keyword">string</span>, error) {
    resp, err := cli.<span class="function">Get</span>(context.<span class="function">Background</span>(), key)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="string">""</span>, err
    }
    
    <span class="keyword">if</span> <span class="function">len</span>(resp.Kvs) == <span class="number">0</span> {
        <span class="keyword">return</span> <span class="string">""</span>, fmt.<span class="function">Errorf</span>(<span class="string">"config not found"</span>)
    }
    
    <span class="keyword">return</span> string(resp.Kvs[<span class="number">0</span>].Value), <span class="keyword">nil</span>
}</code></pre>
            
            <h2 id="bestpractices">æœ€ä½³å®è·µ</h2>
            
            <h3>Validator æœ€ä½³å®è·µ</h3>
            <div class="note-box">
                <h4>1. ç»Ÿä¸€é”™è¯¯å¤„ç†</h4>
                <pre><code><span class="keyword">type</span> ValidationError <span class="keyword">struct</span> {
    Field   <span class="keyword">string</span> <span class="string">`json:"field"`</span>
    Message <span class="keyword">string</span> <span class="string">`json:"message"`</span>
}

<span class="function">func</span> <span class="function">HandleValidationError</span>(err <span class="keyword">error</span>) []ValidationError {
    <span class="keyword">var</span> errors []ValidationError
    validationErrors := err.(validator.ValidationErrors)
    <span class="keyword">for</span>, e := <span class="keyword">range</span> validationErrors {
        errors = <span class="function">append</span>(errors, ValidationError{
            Field:   e.<span class="function">Field</span>(),
            Message: <span class="function">getErrorMessage</span>(e),
        })
    }
    <span class="keyword">return</span> errors
}</code></pre>
                
                <h4>2. è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™</h4>
                <pre><code><span class="comment">// ä¸šåŠ¡ç›¸å…³çš„è‡ªå®šä¹‰æ ¡éªŒ</span>
<span class="function">func</span> <span class="function">validateBusinessRule</span>(fl validator.FieldLevel) <span class="keyword">bool</span> {
    <span class="comment">// å®ç°ä¸šåŠ¡è§„åˆ™æ ¡éªŒ</span>
    <span class="keyword">return</span> <span class="keyword">true</span>
}</code></pre>
                
                <h4>3. åˆ†å±‚æ ¡éªŒ</h4>
                <pre><code><span class="comment">// Controller å±‚ï¼šæ ¼å¼æ ¡éªŒ</span>
<span class="keyword">if</span> err := c.<span class="function">ShouldBindJSON</span>(&req); err != <span class="keyword">nil</span> {
    <span class="keyword">return</span> err
}

<span class="comment">// Service å±‚ï¼šä¸šåŠ¡æ ¡éªŒ</span>
<span class="keyword">if</span> err := s.<span class="function">ValidateBusiness</span>(&req); err != <span class="keyword">nil</span> {
    <span class="keyword">return</span> err
}</code></pre>
            </div>
            
            <h3>Cobra æœ€ä½³å®è·µ</h3>
            <div class="note-box">
                <h4>1. ç»“æ„åŒ–å‘½ä»¤</h4>
                <pre><code><span class="comment">// cmd/root.go</span>
<span class="keyword">package</span> cmd

<span class="keyword">var</span> rootCmd = &cobra.Command{
    Use:   <span class="string">"myapp"</span>,
    Short: <span class="string">"My application"</span>,
}

<span class="function">func</span> <span class="function">Execute</span>() {
    <span class="keyword">if</span> err := rootCmd.<span class="function">Execute</span>(); err != <span class="keyword">nil</span> {
        os.<span class="function">Exit</span>(<span class="number">1</span>)
    }
}

<span class="comment">// cmd/create.go</span>
<span class="keyword">package</span> cmd

<span class="keyword">var</span> createCmd = &cobra.Command{
    Use:   <span class="string">"create"</span>,
    Short: <span class="string">"Create resource"</span>,
}

<span class="function">func</span> <span class="function">init</span>() {
    rootCmd.<span class="function">AddCommand</span>(createCmd)
}</code></pre>
                
                <h4>2. é…ç½®ç®¡ç†</h4>
                <pre><code><span class="comment">// ä½¿ç”¨ Viper ç®¡ç†é…ç½®</span>
<span class="keyword">var</span> cfgFile <span class="keyword">string</span>

<span class="function">func</span> <span class="function">init</span>() {
    cobra.<span class="function">OnInitialize</span>(<span class="function">initConfig</span>)
    rootCmd.<span class="function">PersistentFlags</span>().<span class="function">StringVar</span>(&cfgFile, <span class="string">"config"</span>, <span class="string">""</span>, <span class="string">"config file"</span>)
}

<span class="function">func</span> <span class="function">initConfig</span>() {
    <span class="keyword">if</span> cfgFile != <span class="string">""</span> {
        viper.<span class="function">SetConfigFile</span>(cfgFile)
    } <span class="keyword">else</span> {
        home, _ := os.<span class="function">UserHomeDir</span>()
        viper.<span class="function">AddConfigPath</span>(home)
        viper.<span class="function">SetConfigName</span>(<span class="string">".myapp"</span>)
    }
    
    viper.<span class="function">ReadInConfig</span>()
}</code></pre>
                
                <h4>3. ç”Ÿæˆæ–‡æ¡£</h4>
                <pre><code><span class="comment">// è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£</span>
<span class="keyword">go</span> run main.go docs</code></pre>
            </div>
            
            <h3>Go-Micro æœ€ä½³å®è·µ</h3>
            <div class="note-box">
                <h4>1. æœåŠ¡æ‹†åˆ†</h4>
                <pre><code><span class="comment">// æŒ‰ä¸šåŠ¡é¢†åŸŸæ‹†åˆ†æœåŠ¡</span>
<span class="comment">// - user-service</span>
<span class="comment">// - order-service</span>
<span class="comment">// - payment-service</span></code></pre>
                
                <h4>2. æ¥å£è®¾è®¡</h4>
                <pre><code><span class="comment">// ä½¿ç”¨ Protobuf å®šä¹‰æ¥å£</span>
syntax = <span class="string">"proto3"</span>;

<span class="keyword">package</span> user;

<span class="keyword">service</span> UserService {
  rpc GetUser(GetUserRequest) returns (GetUserResponse);
  rpc CreateUser(CreateUserRequest) returns (CreateUserResponse);
}</code></pre>
                
                <h4>3. é”™è¯¯å¤„ç†</h4>
                <pre><code><span class="comment">// ç»Ÿä¸€é”™è¯¯å¤„ç†</span>
<span class="keyword">type</span> ErrorResponse <span class="keyword">struct</span> {
    Code    <span class="keyword">string</span> <span class="string">`json:"code"`</span>
    Message <span class="keyword">string</span> <span class="string">`json:"message"`</span>
}

<span class="function">func</span> <span class="function">HandleError</span>(err <span class="keyword">error</span>) *ErrorResponse {
    <span class="keyword">return</span> &ErrorResponse{
        Code:    <span class="string">"ERROR"</span>,
        Message: err.<span class="function">Error</span>(),
    }
}</code></pre>
            </div>
            
            <h3>Etcd æœ€ä½³å®è·µ</h3>
            <div class="note-box">
                <h4>1. é”®å‘½åè§„èŒƒ</h4>
                <pre><code><span class="comment">// ä½¿ç”¨å±‚æ¬¡åŒ–çš„é”®å</span>
<span class="comment">// /services/user-service/instances/192.168.1.1:8080</span>
<span class="comment">// /config/database/host</span>
<span class="comment">// /locks/resource-123</span></code></pre>
                
                <h4>2. ç§Ÿçº¦ç®¡ç†</h4>
                <pre><code><span class="comment">// è‡ªåŠ¨ç»­ç§Ÿ</span>
keepAlive, err := cli.<span class="function">KeepAlive</span>(ctx, lease.ID)
<span class="keyword">defer</span> cli.<span class="function">Revoke</span>(ctx, lease.ID)</code></pre>
                
                <h4>3. äº‹åŠ¡ä½¿ç”¨</h4>
                <pre><code><span class="comment">// ä½¿ç”¨äº‹åŠ¡å®ç°åŸå­æ“ä½œ</span>
txn := cli.<span class="function">Txn</span>(ctx)
<span class="comment">// ...</span>
txn.<span class="function">Commit</span>()</code></pre>
                
                <h4>4. ç›‘å¬æœºåˆ¶</h4>
                <pre><code><span class="comment">// ä½¿ç”¨ç›‘å¬å®ç°é…ç½®çƒ­æ›´æ–°</span>
watchChan := cli.<span class="function">Watch</span>(ctx, <span class="string">"/config"</span>, clientv3.<span class="function">WithPrefix</span>())</code></pre>
            </div>
            
            <h3>å¾®æœåŠ¡æ¶æ„æœ€ä½³å®è·µ</h3>
            <div class="note-box">
                <h4>1. æœåŠ¡æ³¨å†Œä¸å‘ç°</h4>
                <pre><code><span class="comment">// ä½¿ç”¨ Etcd ä½œä¸ºæ³¨å†Œä¸­å¿ƒ</span>
registry := etcd.<span class="function">NewRegistry</span>(registry.<span class="function">Addrs</span>(<span class="string">"127.0.0.1:2379"</span>))
service := micro.<span class="function">NewService</span>(micro.<span class="function">Registry</span>(registry))</code></pre>
                
                <h4>2. é…ç½®ä¸­å¿ƒ</h4>
                <pre><code><span class="comment">// ä½¿ç”¨ Etcd å­˜å‚¨é…ç½®</span>
cli.<span class="function">Put</span>(ctx, <span class="string">"/config/database/host"</span>, <span class="string">"localhost"</span>)</code></pre>
                
                <h4>3. åˆ†å¸ƒå¼é”</h4>
                <pre><code><span class="comment">// ä½¿ç”¨ Etcd å®ç°åˆ†å¸ƒå¼é”</span>
<span class="function">func</span> <span class="function">acquireLock</span>(cli *clientv3.Client, key <span class="keyword">string</span>) (<span class="keyword">bool</span>, error) {
    <span class="comment">// ...</span>
}</code></pre>
                
                <h4>4. æ¶ˆæ¯é˜Ÿåˆ—</h4>
                <pre><code><span class="comment">// ä½¿ç”¨ Go-Micro Broker</span>
micro.<span class="function">RegisterSubscriber</span>(<span class="string">"topic"</span>, service.<span class="function">Server</span>(), handler)</code></pre>
            </div>
            
            
            <h2 id="protobuf">Protobuf æ•°æ®åºåˆ—åŒ–</h2>
            <p>Protocol Buffers (Protobuf) æ˜¯ Google å¼€å‘çš„ä¸€ç§è¯­è¨€æ— å…³ã€å¹³å°æ— å…³çš„åºåˆ—åŒ–ç»“æ„æ•°æ®çš„æ–¹æ³•ã€‚</p>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="comment">// å®‰è£… protoc ç¼–è¯‘å™¨</span>
<span class="comment">// macOS: brew install protobuf</span>
<span class="comment">// Ubuntu: apt-get install protobuf-compiler</span>

<span class="comment">// å®‰è£… Go æ’ä»¶</span>
go install google.golang.org/protobuf/cmd/protoc-gen-go@latest
go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest</code></pre>
            
            <h3>å®šä¹‰ .proto æ–‡ä»¶</h3>
            <pre><code><span class="comment">// user.proto</span>
syntax = <span class="string">"proto3"</span>;

<span class="keyword">package</span> user;

<span class="keyword">option</span> go_package = <span class="string">"./user"</span>;

<span class="keyword">message</span> User {
    <span class="keyword">int32</span> id = 1;
    <span class="keyword">string</span> name = 2;
    <span class="keyword">string</span> email = 3;
    <span class="keyword">repeated</span> <span class="keyword">string</span> tags = 4;
    <span class="keyword">enum</span> Status {
        UNKNOWN = 0;
        ACTIVE = 1;
        INACTIVE = 2;
    }
    Status status = 5;
}

<span class="keyword">message</span> GetUserRequest {
    <span class="keyword">int32</span> id = 1;
}

<span class="keyword">message</span> GetUserResponse {
    User user = 1;
}</code></pre>
            
            <h3>ç”Ÿæˆ Go ä»£ç </h3>
            <pre><code><span class="comment">// ç”Ÿæˆä»£ç </span>
protoc --go_out=. --go_opt=paths=source_relative \
       --go-grpc_out=. --go-grpc_opt=paths=source_relative \
       user.proto</code></pre>
            
            <h3>åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"google.golang.org/protobuf/proto"</span>
    <span class="string">"path/to/user"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºæ¶ˆæ¯</span>
    u := &user.User{
        Id:    1,
        Name:  <span class="string">"å¼ ä¸‰"</span>,
        Email: <span class="string">"zhangsan@example.com"</span>,
        Tags:  []<span class="keyword">string</span>{<span class="string">"admin"</span>, <span class="string">"user"</span>},
        Status: user.User_ACTIVE,
    }
    
    <span class="comment">// åºåˆ—åŒ–</span>
    data, err := proto.<span class="function">Marshal</span>(u)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">panic</span>(err)
    }
    fmt.<span class="function">Printf</span>(<span class="string">"åºåˆ—åŒ–ç»“æœ: %x\n"</span>, data)
    
    <span class="comment">// ååºåˆ—åŒ–</span>
    <span class="keyword">var</span> u2 user.User
    err = proto.<span class="function">Unmarshal</span>(data, &u2)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">panic</span>(err)
    }
    fmt.<span class="function">Printf</span>(<span class="string">"ååºåˆ—åŒ–ç»“æœ: %+v\n"</span>, u2)
}</code></pre>
            
            <h3>Protobuf æœ€ä½³å®è·µ</h3>
            <div class="note-box">
                <h4>1. å­—æ®µç¼–å·è§„èŒƒ</h4>
                <pre><code><span class="comment">// 1-15: å•å­—èŠ‚ç¼–ç ï¼Œå¸¸ç”¨å­—æ®µ</span>
<span class="comment">// 16-2047: ä¸¤å­—èŠ‚ç¼–ç ï¼Œä¸å¸¸ç”¨å­—æ®µ</span>
<span class="comment">// ä¿ç•™å­—æ®µç¼–å·ï¼š19000-19999</span>

<span class="keyword">message</span> User {
    <span class="keyword">string</span> name = 1;   <span class="comment">// å¸¸ç”¨å­—æ®µ</span>
    <span class="keyword">string</span> email = 2;  <span class="comment">// å¸¸ç”¨å­—æ®µ</span>
    <span class="keyword">string</span> phone = 16; <span class="comment">// ä¸å¸¸ç”¨å­—æ®µ</span>
}</code></pre>
                
                <h4>2. ä½¿ç”¨ oneof</h4>
                <pre><code><span class="keyword">message</span> Result {
    <span class="keyword">oneof</span> result {
        <span class="keyword">string</span> error = 1;
        <span class="keyword">string</span> data = 2;
    }
}</code></pre>
                
                <h4>3. ä½¿ç”¨ map</h4>
                <pre><code><span class="keyword">message</span> User {
    <span class="keyword">map</span>&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; metadata = 10;
}</code></pre>
                
                <h4>4. ç‰ˆæœ¬å…¼å®¹æ€§</h4>
                <pre><code><span class="comment">// æ–°å¢å­—æ®µæ—¶ä½¿ç”¨ optional</span>
<span class="keyword">message</span> User {
    <span class="keyword">string</span> name = 1;
    <span class="keyword">optional</span> <span class="keyword">string</span> nickname = 10; <span class="comment">// æ–°å¢å­—æ®µ</span>
}

<span class="comment">// ä¿ç•™åºŸå¼ƒå­—æ®µ</span>
<span class="keyword">message</span> User {
    <span class="keyword">int32</span> old_id = 1 [deprecated = <span class="keyword">true</span>];
    <span class="keyword">string</span> new_id = 2;
}</code></pre>
            </div>

            <h2 id="sonic">Sonic JSON</h2>
            <p>Sonic æ˜¯å­—èŠ‚è·³åŠ¨å¼€æºçš„é«˜æ€§èƒ½ JSON åº“ï¼ŒåŸºäº SIMD æŒ‡ä»¤é›†ä¼˜åŒ–ï¼Œåœ¨ Go è¯­è¨€ä¸­æä¾›äº†æ¯”æ ‡å‡†åº“ `encoding/json` æ›´å¿«çš„ JSON åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ€§èƒ½ã€‚å®ƒå®Œå…¨å…¼å®¹æ ‡å‡†åº“ APIï¼Œå¯ä»¥ä½œä¸ºæ ‡å‡†åº“çš„æ›¿ä»£å“ä½¿ç”¨ã€‚</p>
            
            <h3>æ ¸å¿ƒç‰¹æ€§</h3>
            <ul>
                <li><strong>æè‡´æ€§èƒ½</strong>ï¼šåŸºäº SIMD æŒ‡ä»¤é›†ä¼˜åŒ–ï¼Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ€§èƒ½æ¯”æ ‡å‡†åº“å¿« 2-10 å€</li>
                <li><strong>å®Œå…¨å…¼å®¹</strong>ï¼š100% å…¼å®¹æ ‡å‡†åº“ `encoding/json` çš„ APIï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç </li>
                <li><strong>é›¶ä¾èµ–</strong>ï¼šçº¯ Go å®ç°ï¼Œæ—  CGO ä¾èµ–ï¼Œè·¨å¹³å°æ”¯æŒ</li>
                <li><strong>å†…å­˜å®‰å…¨</strong>ï¼šä½¿ç”¨å®‰å…¨çš„å†…å­˜ç®¡ç†ï¼Œé¿å…å†…å­˜æ³„æ¼</li>
                <li><strong>ç±»å‹æ¨æ–­</strong>ï¼šæ”¯æŒè‡ªåŠ¨ç±»å‹æ¨æ–­ï¼Œå‡å°‘ä»£ç é‡</li>
            </ul>
            
            <h3>æ€§èƒ½å¯¹æ¯”</h3>
            <div class="example-box">
                <p>ä¸æ ‡å‡†åº“å’Œå…¶ä»– JSON åº“çš„æ€§èƒ½å¯¹æ¯”ï¼ˆæ•°æ®æ¥æºï¼šSonic å®˜æ–¹åŸºå‡†æµ‹è¯•ï¼‰ï¼š</p>
                <table>
                    <tr>
                        <th>åº“</th>
                        <th>åºåˆ—åŒ–</th>
                        <th>ååºåˆ—åŒ–</th>
                    </tr>
                    <tr>
                        <td>encoding/json</td>
                        <td>1x (åŸºå‡†)</td>
                        <td>1x (åŸºå‡†)</td>
                    </tr>
                    <tr>
                        <td>json-iterator/go</td>
                        <td>1.5x</td>
                        <td>1.8x</td>
                    </tr>
                    <tr>
                        <td>easyjson</td>
                        <td>2.5x</td>
                        <td>3.0x</td>
                    </tr>
                    <tr>
                        <td><strong>sonic</strong></td>
                        <td><strong>3.5x</strong></td>
                        <td><strong>4.2x</strong></td>
                    </tr>
                </table>
            </div>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get -u github.com/bytedance/sonic</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/bytedance/sonic"</span>
)

<span class="keyword">type</span> User <span class="keyword">struct</span> {
    ID    <span class="keyword">int</span>    <span class="string">`json:"id"`</span>
    Name  <span class="keyword">string</span> <span class="string">`json:"name"`</span>
    Email <span class="keyword">string</span> <span class="string">`json:"email"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åºåˆ—åŒ–</span>
    user := User{ID: 1, Name: <span class="string">"Alice"</span>, Email: <span class="string">"alice@example.com"</span>}
    data, err := sonic.<span class="function">Marshal</span>(user)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">panic</span>(err)
    }
    fmt.<span class="function">Println</span>(<span class="keyword">string</span>(data))
    <span class="comment">// è¾“å‡º: {"id":1,"name":"Alice","email":"alice@example.com"}</span>
    
    <span class="comment">// ååºåˆ—åŒ–</span>
    <span class="keyword">var</span> decoded User
    err = sonic.<span class="function">Unmarshal</span>(data, &decoded)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">panic</span>(err)
    }
    fmt.<span class="function">Printf</span>(<span class="string">"%+v\n"</span>, decoded)
    <span class="comment">// è¾“å‡º: {ID:1 Name:Alice Email:alice@example.com}</span>
}</code></pre>
            
            <h3>é«˜çº§ç”¨æ³•</h3>
            
            <h4>1. ä½¿ç”¨é…ç½®é€‰é¡¹</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/bytedance/sonic"</span>
    <span class="string">"github.com/bytedance/sonic/option"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºè‡ªå®šä¹‰é…ç½®</span>
    cfg := sonic.<span class="function">Config</span>{
        EscapeHTML: <span class="keyword">false</span>,
        SortKeys:   <span class="keyword">true</span>,
    }
    
    api := sonic.<span class="function">ConfigStd</span>(cfg)
    
    user := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>{}{
        <span class="string">"name"</span>:  <span class="string">"Bob"</span>,
        <span class="string">"email"</span>: <span class="string">"bob@example.com"</span>,
    }
    
    data, _ := api.<span class="function">Marshal</span>(user)
    fmt.<span class="function">Println</span>(<span class="keyword">string</span>(data))
}</code></pre>
            
            <h4>2. æµå¼å¤„ç†</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"bytes"</span>
    <span class="string">"fmt"</span>
    <span class="string">"github.com/bytedance/sonic"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ä½¿ç”¨ Encoder è¿›è¡Œæµå¼åºåˆ—åŒ–</span>
    <span class="keyword">var</span> buf bytes.Buffer
    encoder := sonic.<span class="function">ConfigDefault</span>().<span class="function">NewEncoder</span>(&buf)
    
    users := []<span class="keyword">string</span>{<span class="string">"Alice"</span>, <span class="string">"Bob"</span>, <span class="string">"Charlie"</span>}
    <span class="keyword">for</span> _, name := <span class="keyword">range</span> users {
        encoder.<span class="function">Encode</span>(name)
    }
    
    fmt.<span class="function">Println</span>(buf.<span class="function">String</span>())
}</code></pre>
            
            <h4>3. ä½¿ç”¨ Node API å¤„ç†åŠ¨æ€ JSON</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/bytedance/sonic"</span>
    <span class="string">"github.com/bytedance/sonic/ast"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    jsonStr := <span class="string">`{"name":"Alice","age":30,"email":"alice@example.com"}`</span>
    
    <span class="comment">// è§£æä¸º Node</span>
    node, err := ast.<span class="function">NewNode</span>(jsonStr)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">panic</span>(err)
    }
    
    <span class="comment">// è®¿é—®å­—æ®µ</span>
    name, _ := node.<span class="function">GetByPath</span>(<span class="string">"name"</span>).<span class="function">String</span>()
    age, _ := node.<span class="function">GetByPath</span>(<span class="string">"age"</span>).<span class="function">Int64</span>()
    
    fmt.<span class="function">Printf</span>(<span class="string">"Name: %s, Age: %d\n"</span>, name, age)
    
    <span class="comment">// ä¿®æ”¹å­—æ®µ</span>
    node.<span class="function">SetByPath</span>(<span class="string">"age"</span>, 31)
    
    <span class="comment">// è½¬æ¢å› JSON</span>
    modified, _ := node.<span class="function">MarshalJSON</span>()
    fmt.<span class="function">Println</span>(<span class="keyword">string</span>(modified))
}</code></pre>
            
            <h4>4. ä¸ HTTP æœåŠ¡å™¨é›†æˆ</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"net/http"</span>
    <span class="string">"github.com/bytedance/sonic"</span>
)

<span class="keyword">type</span> User <span class="keyword">struct</span> {
    ID   <span class="keyword">int</span>    <span class="string">`json:"id"`</span>
    Name <span class="keyword">string</span> <span class="string">`json:"name"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    http.<span class="function">HandleFunc</span>(<span class="string">"/user"</span>, <span class="keyword">func</span>(w http.ResponseWriter, r *http.Request) {
        <span class="keyword">if</span> r.Method == <span class="string">"POST"</span> {
            <span class="keyword">var</span> user User
            <span class="comment">// ä½¿ç”¨ Sonic è§£æ JSON</span>
            err := sonic.<span class="function">Unmarshal</span>([]<span class="keyword">byte</span>(r.FormValue(<span class="string">"data"</span>)), &user)
            <span class="keyword">if</span> err != <span class="keyword">nil</span> {
                http.<span class="function">Error</span>(w, err.<span class="function">Error</span>(), http.StatusBadRequest)
                <span class="keyword">return</span>
            }
            
            <span class="comment">// ä½¿ç”¨ Sonic åºåˆ—åŒ–å“åº”</span>
            data, _ := sonic.<span class="function">Marshal</span>(user)
            w.<span class="function">Header</span>().<span class="function">Set</span>(<span class="string">"Content-Type"</span>, <span class="string">"application/json"</span>)
            w.<span class="function">Write</span>(data)
        }
    })
    
    http.<span class="function">ListenAndServe</span>(<span class="string">":8080"</span>, <span class="keyword">nil</span>)
}</code></pre>
            
            <h3>æœ€ä½³å®è·µ</h3>
            
            <h4>1. æ€§èƒ½ä¼˜åŒ–</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/bytedance/sonic"</span>
    <span class="string">"github.com/bytedance/sonic/option"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ä½¿ç”¨é¢„ç¼–è¯‘çš„ API æå‡æ€§èƒ½</span>
    api := sonic.<span class="function">ConfigFastest</span>()
    
    <span class="comment">// å¯¹äºé¢‘ç¹ä½¿ç”¨çš„ç±»å‹ï¼Œä½¿ç”¨é¢„ç¼–è¯‘</span>
    type User <span class="keyword">struct</span> {
        Name <span class="keyword">string</span> <span class="string">`json:"name"`</span>
        Age  <span class="keyword">int</span>    <span class="string">`json:"age"`</span>
    }
    
    <span class="comment">// é¢„ç¼–è¯‘ç±»å‹çš„åºåˆ—åŒ–å™¨</span>
    marshaler, _ := api.<span class="function">NewMarshaler</span>(User{})
    
    user := User{Name: <span class="string">"Alice"</span>, Age: 30}
    data, _ := marshaler.<span class="function">Marshal</span>(user)
}</code></pre>
            
            <h4>2. é”™è¯¯å¤„ç†</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/bytedance/sonic"</span>
)

<span class="function">func</span> <span class="function">safeUnmarshal</span>(data []<span class="keyword">byte</span>, v <span class="keyword">interface</span>{}) <span class="keyword">error</span> {
    <span class="keyword">if</span> err := sonic.<span class="function">Unmarshal</span>(data, v); err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> fmt.<span class="function">Errorf</span>(<span class="string">"JSON è§£æå¤±è´¥: %w"</span>, err)
    }
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="function">func</span> <span class="function">safeMarshal</span>(v <span class="keyword">interface</span>{}) ([]<span class="keyword">byte</span>, <span class="keyword">error</span>) {
    data, err := sonic.<span class="function">Marshal</span>(v)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="keyword">nil</span>, fmt.<span class="function">Errorf</span>(<span class="string">"JSON åºåˆ—åŒ–å¤±è´¥: %w"</span>, err)
    }
    <span class="keyword">return</span> data, <span class="keyword">nil</span>
}</code></pre>
            
            <h4>3. å…¼å®¹æ€§å¤„ç†</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"github.com/bytedance/sonic"</span>
)

<span class="keyword">type</span> JSONMarshaler <span class="keyword">interface</span> {
    <span class="function">MarshalJSON</span>() ([]<span class="keyword">byte</span>, <span class="keyword">error</span>)
}

<span class="keyword">type</span> JSONUnmarshaler <span class="keyword">interface</span> {
    <span class="function">UnmarshalJSON</span>([]<span class="keyword">byte</span>) <span class="keyword">error</span>
}

<span class="comment">// Sonic å®Œå…¨æ”¯æŒæ ‡å‡†åº“çš„ MarshalJSON å’Œ UnmarshalJSON æ¥å£</span>
<span class="keyword">type</span> CustomType <span class="keyword">struct</span> {
    Value <span class="keyword">string</span>
}

<span class="function">func</span> (c *CustomType) <span class="function">MarshalJSON</span>() ([]<span class="keyword">byte</span>, <span class="keyword">error</span>) {
    <span class="keyword">return</span> json.<span class="function">Marshal</span>(c.Value)
}

<span class="function">func</span> (c *CustomType) <span class="function">UnmarshalJSON</span>(data []<span class="keyword">byte</span>) <span class="keyword">error</span> {
    <span class="keyword">return</span> json.<span class="function">Unmarshal</span>(data, &c.Value)
}</code></pre>
            
            <h3>ä½¿ç”¨åœºæ™¯</h3>
            <ul>
                <li><strong>é«˜æ€§èƒ½ API æœåŠ¡</strong>ï¼šéœ€è¦å¤„ç†å¤§é‡ JSON è¯·æ±‚å’Œå“åº”çš„ Web æœåŠ¡</li>
                <li><strong>å¾®æœåŠ¡æ¶æ„</strong>ï¼šæœåŠ¡é—´é€šä¿¡ä½¿ç”¨ JSON åè®®çš„åœºæ™¯</li>
                <li><strong>æ•°æ®å¤„ç†ç®¡é“</strong>ï¼šéœ€è¦å¿«é€Ÿè§£æå’Œç”Ÿæˆ JSON æ•°æ®çš„æ•°æ®å¤„ç†æµç¨‹</li>
                <li><strong>å®æ—¶ç³»ç»Ÿ</strong>ï¼šå¯¹æ€§èƒ½è¦æ±‚æé«˜çš„å®æ—¶æ•°æ®å¤„ç†ç³»ç»Ÿ</li>
                <li><strong>å¤§æ•°æ®å¤„ç†</strong>ï¼šéœ€è¦å¤„ç†æµ·é‡ JSON æ•°æ®çš„å¤§æ•°æ®åº”ç”¨</li>
            </ul>
            
            <h3>æ³¨æ„äº‹é¡¹</h3>
            <ul>
                <li>Sonic åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹å¯èƒ½ä¸æ ‡å‡†åº“çš„è¡Œä¸ºæœ‰ç»†å¾®å·®å¼‚</li>
                <li>å¯¹äºéå¸¸å¤æ‚çš„åµŒå¥—ç»“æ„ï¼Œå»ºè®®è¿›è¡Œå……åˆ†çš„æµ‹è¯•</li>
                <li>åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å‰ï¼Œå»ºè®®è¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•</li>
                <li>Sonic éœ€è¦ Go 1.16+ ç‰ˆæœ¬æ”¯æŒ</li>
            </ul>
            </div>

            <h2 id="gocsv">GoCarina/gocsv</h2>
            <p>gocsv æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”æ˜“äºä½¿ç”¨çš„ Go è¯­è¨€ CSV æ–‡ä»¶è¯»å†™åº“ï¼Œç”± GoCarina å¼€å‘ã€‚å®ƒæä¾›äº†ç®€æ´çš„ APIï¼Œæ”¯æŒå°† CSV æ–‡ä»¶ä¸ Go ç»“æ„ä½“è¿›è¡Œè‡ªåŠ¨æ˜ å°„ï¼Œå¤§å¤§ç®€åŒ–äº† CSV æ–‡ä»¶çš„å¤„ç†å·¥ä½œã€‚</p>
            
            <h3>æ ¸å¿ƒç‰¹æ€§</h3>
            <ul>
                <li><strong>è‡ªåŠ¨æ˜ å°„</strong>ï¼šé€šè¿‡ç»“æ„ä½“æ ‡ç­¾è‡ªåŠ¨æ˜ å°„ CSV åˆ—åˆ°ç»“æ„ä½“å­—æ®µ</li>
                <li><strong>é«˜æ€§èƒ½</strong>ï¼šä¼˜åŒ–çš„è¯»å†™æ€§èƒ½ï¼Œé€‚åˆå¤„ç†å¤§å‹ CSV æ–‡ä»¶</li>
                <li><strong>çµæ´»é…ç½®</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰åˆ†éš”ç¬¦ã€å¼•å·å­—ç¬¦ã€æ³¨é‡Šç­‰</li>
                <li><strong>æµå¼å¤„ç†</strong>ï¼šæ”¯æŒæµå¼è¯»å†™ï¼Œå†…å­˜å ç”¨ä½</li>
                <li><strong>ç±»å‹è½¬æ¢</strong>ï¼šè‡ªåŠ¨å¤„ç†åŸºæœ¬ç±»å‹å’Œè‡ªå®šä¹‰ç±»å‹çš„è½¬æ¢</li>
                <li><strong>é”™è¯¯å¤„ç†</strong>ï¼šè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œè¡Œå·è¿½è¸ª</li>
            </ul>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get github.com/gocarina/gocsv</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/csv"</span>
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
    <span class="string">"github.com/gocarina/gocsv"</span>
)

<span class="keyword">type</span> Client <span class="keyword">struct</span> {
    Id      <span class="keyword">string</span> <span class="string">`csv:"id"`</span>
    Name    <span class="string">`csv:"name"`</span>
    Age     <span class="keyword">int</span>    <span class="string">`csv:"age"`</span>
    Country <span class="keyword">string</span> <span class="string">`csv:"country"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    clients := []Client{
        {Id: <span class="string">"1"</span>, Name: <span class="string">"Alice"</span>, Age: 30, Country: <span class="string">"USA"</span>},
        {Id: <span class="string">"2"</span>, Name: <span class="string">"Bob"</span>, Age: 25, Country: <span class="string">"UK"</span>},
        {Id: <span class="string">"3"</span>, Name: <span class="string">"Charlie"</span>, Age: 35, Country: <span class="string">"Canada"</span>},
    }
    
    <span class="comment">// å†™å…¥ CSV æ–‡ä»¶</span>
    file, _ := os.<span class="function">OpenFile</span>(<span class="string">"clients.csv"</span>, os.O_RDWR|os.O_CREATE|os.O_TRUNC, 0755)
    <span class="keyword">defer</span> file.<span class="function">Close</span>()
    
    gocsv.<span class="function">MarshalFile</span>(&clients, file)
    
    <span class="comment">// è¯»å– CSV æ–‡ä»¶</span>
    clientsFile, _ := os.<span class="function">OpenFile</span>(<span class="string">"clients.csv"</span>, os.O_RDWR|os.O_CREATE, 0755)
    <span class="keyword">defer</span> clientsFile.<span class="function">Close</span>()
    
    <span class="keyword">var</span> clientsRead []Client
    gocsv.<span class="function">UnmarshalFile</span>(clientsFile, &clientsRead)
    
    fmt.<span class="function">Printf</span>(<span class="string">"%+v\n"</span>, clientsRead)
}</code></pre>
            
            <h3>é«˜çº§ç”¨æ³•</h3>
            
            <h4>1. è‡ªå®šä¹‰åˆ†éš”ç¬¦å’Œé…ç½®</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/gocarina/gocsv"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ä½¿ç”¨åˆ†å·ä½œä¸ºåˆ†éš”ç¬¦</span>
    gocsv.<span class="function">SetCSVReader</span>(gocsv.<span class="function">CustomReader</span>{
        Separator: <span class="string">';'</span>,
    })
    
    <span class="comment">// ä½¿ç”¨åˆ†å·ä½œä¸ºåˆ†éš”ç¬¦å†™å…¥</span>
    gocsv.<span class="function">SetCSVWriter</span>(gocsv.<span class="function">CustomWriter</span>{
        Separator: <span class="string">';'</span>,
    })
}</code></pre>
            
            <h4>2. å¤„ç†å¸¦æ ‡é¢˜çš„ CSV</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
    <span class="string">"github.com/gocarina/gocsv"</span>
)

<span class="keyword">type</span> Product <span class="keyword">struct</span> {
    SKU      <span class="keyword">string</span>  <span class="string">`csv:"SKU"`</span>
    Name     <span class="keyword">string</span>  <span class="string">`csv:"Product Name"`</span>
    Price    <span class="keyword">float64</span> <span class="string">`csv:"Price"`</span>
    Quantity <span class="keyword">int</span>     <span class="string">`csv:"Quantity"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    file, _ := os.<span class="function">Open</span>(<span class="string">"products.csv"</span>)
    <span class="keyword">defer</span> file.<span class="function">Close</span>()
    
    <span class="keyword">var</span> products []Product
    gocsv.<span class="function">UnmarshalFile</span>(file, &products)
    
    fmt.<span class="function">Printf</span>(<span class="string">"è¯»å–åˆ° %d ä¸ªäº§å“\n"</span>, <span class="function">len</span>(products))
}</code></pre>
            
            <h4>3. æµå¼è¯»å–å¤§å‹ CSV æ–‡ä»¶</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
    <span class="string">"github.com/gocarina/gocsv"</span>
)

<span class="keyword">type</span> LogEntry <span class="keyword">struct</span> {
    Timestamp <span class="keyword">string</span> <span class="string">`csv:"timestamp"`</span>
    Level     <span class="keyword">string</span> <span class="string">`csv:"level"`</span>
    Message   <span class="keyword">string</span> <span class="string">`csv:"message"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    file, _ := os.<span class="function">Open</span>(<span class="string">"large_logs.csv"</span>)
    <span class="keyword">defer</span> file.<span class="function">Close</span>()
    
    <span class="comment">// æµå¼è¯»å–ï¼Œé€è¡Œå¤„ç†</span>
    reader := gocsv.<span class="function">NewDecoder</span>(file)
    
    <span class="keyword">for</span> {
        <span class="keyword">var</span> entry LogEntry
        err := reader.<span class="function">Decode</span>(&entry)
        <span class="keyword">if</span> err == io.EOF {
            <span class="keyword">break</span>
        }
        <span class="keyword">if</span> err != <span class="keyword">nil</span> {
            fmt.<span class="function">Printf</span>(<span class="string">"è§£æé”™è¯¯: %v\n"</span>, err)
            <span class="keyword">continue</span>
        }
        
        <span class="comment">// å¤„ç†æ¯è¡Œæ•°æ®</span>
        fmt.<span class="function">Printf</span>(<span class="string">"[%s] %s: %s\n"</span>, entry.Timestamp, entry.Level, entry.Message)
    }
}</code></pre>
            
            <h4>4. å¤„ç†åµŒå¥—ç»“æ„</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/gocarina/gocsv"</span>
)

<span class="keyword">type</span> Address <span class="keyword">struct</span> {
    Street  <span class="keyword">string</span> <span class="string">`csv:"street"`</span>
    City    <span class="keyword">string</span> <span class="string">`csv:"city"`</span>
    Country <span class="keyword">string</span> <span class="string">`csv:"country"`</span>
}

<span class="keyword">type</span> Person <span class="keyword">struct</span> {
    Name    <span class="keyword">string</span>  <span class="string">`csv:"name"`</span>
    Age     <span class="keyword">int</span>     <span class="string">`csv:"age"`</span>
    Address Address  <span class="string">`csv:"address"`</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// gocsv æ”¯æŒåµŒå¥—ç»“æ„</span>
    csvData := <span class="string">`name,age,street,city,country
Alice,30,123 Main St,New York,USA
Bob,25,456 Oak Ave,London,UK`</span>
    
    <span class="keyword">var</span> people []Person
    gocsv.<span class="function">Unmarshal</span>([]<span class="keyword">byte</span>(csvData), &people)
    
    fmt.<span class="function">Printf</span>(<span class="string">"%+v\n"</span>, people)
}</code></pre>
            
            <h4>5. è‡ªå®šä¹‰ç±»å‹è½¬æ¢</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"time"</span>
    <span class="string">"github.com/gocarina/gocsv"</span>
)

<span class="keyword">type</span> Transaction <span class="keyword">struct</span> {
    ID        <span class="keyword">string</span>    <span class="string">`csv:"id"`</span>
    Amount    <span class="keyword">float64</span>   <span class="string">`csv:"amount"`</span>
    Date      <span class="keyword">string</span>    <span class="string">`csv:"date"`</span>
    DateParsed time.Time  <span class="string">`csv:"-"`</span> <span class="comment">// ä¸ä» CSV è¯»å–</span>
}

<span class="function">func</span> (t *Transaction) <span class="function">UnmarshalCSV</span>(csv <span class="keyword">string</span>) <span class="keyword">error</span> {
    <span class="comment">// è‡ªå®šä¹‰è§£æé€»è¾‘</span>
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="function">func</span> (t *Transaction) <span class="function">MarshalCSV</span>() (<span class="keyword">string</span>, <span class="keyword">error</span>) {
    <span class="comment">// è‡ªå®šä¹‰åºåˆ—åŒ–é€»è¾‘</span>
    <span class="keyword">return</span> <span class="string">""</span>, <span class="keyword">nil</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹è½¬æ¢</span>
    transactions := []Transaction{
        {ID: <span class="string">"1"</span>, Amount: 100.50, Date: <span class="string">"2024-01-15"</span>},
    }
    
    csvData, _ := gocsv.<span class="function">MarshalString</span>(&transactions)
    fmt.<span class="function">Println</span>(csvData)
}</code></pre>
            
            <h3>æœ€ä½³å®è·µ</h3>
            
            <h4>1. é”™è¯¯å¤„ç†å’ŒéªŒè¯</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
    <span class="string">"github.com/gocarina/gocsv"</span>
)

<span class="keyword">type</span> ValidatedRecord <span class="keyword">struct</span> {
    Email <span class="keyword">string</span> <span class="string">`csv:"email" validate:"required,email"`</span>
    Phone <span class="keyword">string</span> <span class="string">`csv:"phone" validate:"required"`</span>
}

<span class="function">func</span> <span class="function">validateRecord</span>(record ValidatedRecord) <span class="keyword">error</span> {
    <span class="keyword">if</span> record.Email == <span class="string">""</span> {
        <span class="keyword">return</span> fmt.<span class="function">Errorf</span>(<span class="string">"é‚®ç®±ä¸èƒ½ä¸ºç©º"</span>)
    }
    <span class="comment">// æ›´å¤šéªŒè¯é€»è¾‘...</span>
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    file, _ := os.<span class="function">Open</span>(<span class="string">"data.csv"</span>)
    <span class="keyword">defer</span> file.<span class="function">Close</span>()
    
    <span class="keyword">var</span> records []ValidatedRecord
    <span class="keyword">if</span> err := gocsv.<span class="function">UnmarshalFile</span>(file, &records); err != <span class="keyword">nil</span> {
        fmt.<span class="function">Printf</span>(<span class="string">"CSV è§£æå¤±è´¥: %v\n"</span>, err)
        <span class="keyword">return</span>
    }
    
    <span class="comment">// éªŒè¯æ¯æ¡è®°å½•</span>
    <span class="keyword">for</span> i, record := <span class="keyword">range</span> records {
        <span class="keyword">if</span> err := <span class="function">validateRecord</span>(record); err != <span class="keyword">nil</span> {
            fmt.<span class="function">Printf</span>(<span class="string">"ç¬¬ %d è¡ŒéªŒè¯å¤±è´¥: %v\n"</span>, i+1, err)
        }
    }
}</code></pre>
            
            <h4>2. æ€§èƒ½ä¼˜åŒ–</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"bufio"</span>
    <span class="string">"os"</span>
    <span class="string">"github.com/gocarina/gocsv"</span>
)

<span class="function">func</span> <span class="function">processLargeCSV</span>(filePath <span class="keyword">string</span>) <span class="keyword">error</span> {
    <span class="comment">// ä½¿ç”¨ç¼“å†²è¯»å–æå‡æ€§èƒ½</span>
    file, err := os.<span class="function">Open</span>(filePath)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> file.<span class="function">Close</span>()
    
    <span class="comment">// ä½¿ç”¨ bufio åŒ…è£…æ–‡ä»¶</span>
    bufferedFile := bufio.<span class="function">NewReader</span>(file)
    
    <span class="comment">// æµå¼å¤„ç†ï¼Œé¿å…å†…å­˜æº¢å‡º</span>
    reader := gocsv.<span class="function">NewDecoder</span>(bufferedFile)
    
    <span class="keyword">for</span> {
        <span class="keyword">var</span> record <span class="keyword">interface</span>{}
        err := reader.<span class="function">Decode</span>(&record)
        <span class="keyword">if</span> err == io.EOF {
            <span class="keyword">break</span>
        }
        <span class="keyword">if</span> err != <span class="keyword">nil</span> {
            <span class="keyword">continue</span>
        }
        
        <span class="comment">// å¤„ç†è®°å½•</span>
    }
    
    <span class="keyword">return</span> <span class="keyword">nil</span>
}</code></pre>
            
            <h4>3. å¤„ç†ç‰¹æ®Šå­—ç¬¦å’Œè½¬ä¹‰</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/gocarina/gocsv"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// é…ç½®å¤„ç†åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„å­—æ®µ</span>
    gocsv.<span class="function">SetCSVReader</span>(gocsv.<span class="function">CustomReader</span>{
        LazyQuotes:    <span class="keyword">true</span>,  <span class="comment">// å®½æ¾çš„å¼•å·å¤„ç†</span>
        TrimLeadingSpace: <span class="keyword">true</span>,  <span class="comment">// å»é™¤å‰å¯¼ç©ºæ ¼</span>
        ReuseRecord:    <span class="keyword">true</span>,  <span class="comment">// é‡ç”¨è®°å½•ä»¥å‡å°‘å†…å­˜åˆ†é…</span>
    })
    
    <span class="comment">// å¤„ç†åŒ…å«é€—å·ã€å¼•å·ã€æ¢è¡Œç¬¦çš„å­—æ®µ</span>
    data := <span class="keyword">struct</span> {
        Name    <span class="keyword">string</span> <span class="string">`csv:"name"`</span>
        Comment <span class="keyword">string</span> <span class="string">`csv:"comment"`</span>
    }{
        Name:    <span class="string">"Alice, Bob"</span>,
        Comment: <span class="string">"This is a \"quoted\" string"</span>,
    }
}</code></pre>
            
            <h4>4. æ‰¹é‡å¤„ç†å’Œå¹¶å‘</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"sync"</span>
    <span class="string">"github.com/gocarina/gocsv"</span>
)

<span class="function">func</span> <span class="function">processBatch</span>(records []<span class="keyword">interface</span>{}) {
    <span class="comment">// ä½¿ç”¨ worker pool å¹¶å‘å¤„ç†</span>
    <span class="keyword">var</span> wg sync.WaitGroup
    workerCount := 10
    
    recordChan := <span class="function">make</span>(<span class="keyword">chan</span> <span class="keyword">interface</span>{}, workerCount*2)
    
    <span class="comment">// å¯åŠ¨ workers</span>
    <span class="keyword">for</span> i := 0; i < workerCount; i++ {
        wg.<span class="function">Add</span>(1)
        <span class="keyword">go</span> <span class="function">worker</span>(recordChan, &wg)
    }
    
    <span class="comment">// å‘é€è®°å½•</span>
    <span class="keyword">for</span> _, record := <span class="keyword">range</span> records {
        recordChan <- record
    }
    
    <span class="function">close</span>(recordChan)
    wg.<span class="function">Wait</span>()
}

<span class="function">func</span> <span class="function">worker</span>(recordChan <span class="keyword">chan</span> <span class="keyword">interface</span>{}, wg *sync.WaitGroup) {
    <span class="keyword">defer</span> wg.<span class="function">Done</span>()
    <span class="keyword">for</span> record := <span class="keyword">range</span> recordChan {
        <span class="comment">// å¤„ç†è®°å½•</span>
        _ = record
    }
}</code></pre>
            
            <h4>5. ä¸æ•°æ®åº“é›†æˆ</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"database/sql"</span>
    <span class="string">"fmt"</span>
    <span class="string">"os"</span>
    <span class="string">"_ github.com/go-sql-driver/mysql"</span>
    <span class="string">"github.com/gocarina/gocsv"</span>
)

<span class="keyword">type</span> Customer <span class="keyword">struct</span> {
    ID   <span class="keyword">int</span>    <span class="string">`csv:"id" db:"id"`</span>
    Name <span class="keyword">string</span> <span class="string">`csv:"name" db:"name"`</span>
    Email <span class="keyword">string</span> <span class="string">`csv:"email" db:"email"`</span>
}

<span class="function">func</span> <span class="function">importCSVToDatabase</span>(csvPath <span class="keyword">string</span>, db *sql.DB) <span class="keyword">error</span> {
    <span class="comment">// ä» CSV è¯»å–æ•°æ®</span>
    file, err := os.<span class="function">Open</span>(csvPath)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> file.<span class="function">Close</span>()
    
    <span class="keyword">var</span> customers []Customer
    <span class="keyword">if</span> err := gocsv.<span class="function">UnmarshalFile</span>(file, &customers); err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    
    <span class="comment">// æ‰¹é‡æ’å…¥æ•°æ®åº“</span>
    stmt, err := db.<span class="function">Prepare</span>(<span class="string">"INSERT INTO customers (name, email) VALUES (?, ?)"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> stmt.<span class="function">Close</span>()
    
    <span class="keyword">for</span> _, customer := <span class="keyword">range</span> customers {
        _, err := stmt.<span class="function">Exec</span>(customer.Name, customer.Email)
        <span class="keyword">if</span> err != <span class="keyword">nil</span> {
            fmt.<span class="function">Printf</span>(<span class="string">"æ’å…¥å¤±è´¥: %v\n"</span>, err)
        }
    }
    
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="function">func</span> <span class="function">exportDatabaseToCSV</span>(db *sql.DB, csvPath <span class="keyword">string</span>) <span class="keyword">error</span> {
    <span class="comment">// ä»æ•°æ®åº“æŸ¥è¯¢æ•°æ®</span>
    rows, err := db.<span class="function">Query</span>(<span class="string">"SELECT id, name, email FROM customers"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> rows.<span class="function">Close</span>()
    
    <span class="keyword">var</span> customers []Customer
    <span class="keyword">for</span> rows.<span class="function">Next</span>() {
        <span class="keyword">var</span> customer Customer
        err := rows.<span class="function">Scan</span>(&customer.ID, &customer.Name, &customer.Email)
        <span class="keyword">if</span> err != <span class="keyword">nil</span> {
            <span class="keyword">continue</span>
        }
        customers = <span class="function">append</span>(customers, customer)
    }
    
    <span class="comment">// å†™å…¥ CSV æ–‡ä»¶</span>
    file, err := os.<span class="function">Create</span>(csvPath)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> file.<span class="function">Close</span>()
    
    <span class="keyword">return</span> gocsv.<span class="function">MarshalFile</span>(&customers, file)
}</code></pre>
            
            <h3>ä½¿ç”¨åœºæ™¯</h3>
            <ul>
                <li><strong>æ•°æ®å¯¼å…¥å¯¼å‡º</strong>ï¼šå°†æ•°æ®åº“æ•°æ®å¯¼å‡ºä¸º CSV æˆ–ä» CSV å¯¼å…¥æ•°æ®</li>
                <li><strong>æ•°æ®è¿ç§»</strong>ï¼šåœ¨ä¸åŒç³»ç»Ÿä¹‹é—´è¿ç§»æ•°æ®</li>
                <li><strong>æ—¥å¿—åˆ†æ</strong>ï¼šå¤„ç†å’Œåˆ†æ CSV æ ¼å¼çš„æ—¥å¿—æ–‡ä»¶</li>
                <li><strong>æŠ¥è¡¨ç”Ÿæˆ</strong>ï¼šç”Ÿæˆ CSV æ ¼å¼çš„ä¸šåŠ¡æŠ¥è¡¨</li>
                <li><strong>æ•°æ®äº¤æ¢</strong>ï¼šä¸å¤–éƒ¨ç³»ç»Ÿè¿›è¡Œæ•°æ®äº¤æ¢</li>
            </ul>
            
            <h3>æ³¨æ„äº‹é¡¹</h3>
            <ul>
                <li>å¤„ç†å¤§å‹ CSV æ–‡ä»¶æ—¶ï¼Œå»ºè®®ä½¿ç”¨æµå¼å¤„ç†é¿å…å†…å­˜æº¢å‡º</li>
                <li>æ³¨æ„å¤„ç† CSV æ–‡ä»¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆé€—å·ã€å¼•å·ã€æ¢è¡Œç¬¦ç­‰ï¼‰</li>
                <li>å»ºè®®å¯¹æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿æ•°æ®è´¨é‡</li>
                <li>å¤„ç†æ—¥æœŸæ—¶é—´ç­‰ç‰¹æ®Šç±»å‹æ—¶ï¼Œéœ€è¦è‡ªå®šä¹‰ç±»å‹è½¬æ¢é€»è¾‘</li>
                <li>åœ¨å¹¶å‘ç¯å¢ƒä¸­ä½¿ç”¨æ—¶ï¼Œæ³¨æ„çº¿ç¨‹å®‰å…¨é—®é¢˜</li>
            </ul>
            </div>

            <h2 id="excelize">Excelize Excel</h2>
            <p>Excelize æ˜¯ä¸€ä¸ªç”¨äºå¤„ç† Microsoft Excelâ„¢ï¼ˆ.xlsxï¼‰æ–‡ä»¶çš„ Go è¯­è¨€åº“ã€‚å®ƒæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½æ¥åˆ›å»ºã€è¯»å–ã€ä¿®æ”¹å’Œå†™å…¥ Excel æ–‡ä»¶ï¼Œæ”¯æŒå¤æ‚çš„æ ¼å¼è®¾ç½®ã€å›¾è¡¨ã€å›¾ç‰‡ã€æ•°æ®é€è§†è¡¨ç­‰åŠŸèƒ½ï¼Œæ˜¯ Go ç”Ÿæ€ä¸­æœ€å¼ºå¤§çš„ Excel å¤„ç†åº“ä¹‹ä¸€ã€‚</p>
            
            <h3>æ ¸å¿ƒç‰¹æ€§</h3>
            <ul>
                <li><strong>è¯»å†™ Excel</strong>ï¼šæ”¯æŒè¯»å–å’Œå†™å…¥ .xlsx æ ¼å¼çš„ Excel æ–‡ä»¶ï¼ˆ97-2003 å’Œ 2007+ï¼‰</li>
                <li><strong>æ ¼å¼è®¾ç½®</strong>ï¼šæ”¯æŒå•å…ƒæ ¼æ ¼å¼ã€å­—ä½“ã€é¢œè‰²ã€è¾¹æ¡†ã€å¯¹é½æ–¹å¼ç­‰</li>
                <li><strong>å›¾è¡¨æ”¯æŒ</strong>ï¼šæ”¯æŒåˆ›å»ºæŸ±çŠ¶å›¾ã€æŠ˜çº¿å›¾ã€é¥¼å›¾ç­‰å¤šç§å›¾è¡¨ç±»å‹</li>
                <li><strong>å›¾ç‰‡æ’å…¥</strong>ï¼šæ”¯æŒåœ¨ Excel æ–‡ä»¶ä¸­æ’å…¥å›¾ç‰‡å’Œå½¢çŠ¶</li>
                <li><strong>æ•°æ®é€è§†</strong>ï¼šæ”¯æŒåˆ›å»ºå’Œæ“ä½œæ•°æ®é€è§†è¡¨</li>
                <li><strong>å…¬å¼è®¡ç®—</strong>ï¼šæ”¯æŒ Excel å…¬å¼å’Œå‡½æ•°</li>
                <li><strong>æµå¼å¤„ç†</strong>ï¼šæ”¯æŒæµå¼è¯»å–å¤§å‹ Excel æ–‡ä»¶ï¼Œé™ä½å†…å­˜å ç”¨</li>
                <li><strong>æ¨¡æ¿æ”¯æŒ</strong>ï¼šæ”¯æŒä»æ¨¡æ¿åˆ›å»ºæ–°æ–‡ä»¶</li>
            </ul>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get github.com/xuri/excelize/v2</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/xuri/excelize/v2"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºæ–°çš„ Excel æ–‡ä»¶</span>
    f := excelize.<span class="function">NewFile</span>()
    <span class="keyword">defer</span> <span class="function">func</span>() {
        <span class="keyword">if</span> err := f.<span class="function">Close</span>(); err != <span class="keyword">nil</span> {
            fmt.<span class="function">Println</span>(err)
        }
    }()
    
    <span class="comment">// è®¾ç½®å•å…ƒæ ¼å€¼</span>
    f.<span class="function">SetCellValue</span>(<span class="string">"Sheet1"</span>, <span class="string">"A1"</span>, <span class="string">"å§“å"</span>)
    f.<span class="function">SetCellValue</span>(<span class="string">"Sheet1"</span>, <span class="string">"B1"</span>, <span class="string">"å¹´é¾„"</span>)
    f.<span class="function">SetCellValue</span>(<span class="string">"Sheet1"</span>, <span class="string">"A2"</span>, <span class="string">"Alice"</span>)
    f.<span class="function">SetCellValue</span>(<span class="string">"Sheet1"</span>, <span class="string">"B2"</span>, 30)
    
    <span class="comment">// ä¿å­˜æ–‡ä»¶</span>
    <span class="keyword">if</span> err := f.<span class="function">SaveAs</span>(<span class="string">"Book1.xlsx"</span>); err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(err)
    }
}</code></pre>
            
            <h3>é«˜çº§ç”¨æ³•</h3>
            
            <h4>1. è¯»å– Excel æ–‡ä»¶</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/xuri/excelize/v2"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// æ‰“å¼€ç°æœ‰æ–‡ä»¶</span>
    f, err := excelize.<span class="function">OpenFile</span>(<span class="string">"Book1.xlsx"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(err)
        <span class="keyword">return</span>
    }
    <span class="keyword">defer</span> <span class="function">func</span>() {
        <span class="keyword">if</span> err := f.<span class="function">Close</span>(); err != <span class="keyword">nil</span> {
            fmt.<span class="function">Println</span>(err)
        }
    }()
    
    <span class="comment">// è·å–å•å…ƒæ ¼å€¼</span>
    cell, _ := f.<span class="function">GetCellValue</span>(<span class="string">"Sheet1"</span>, <span class="string">"A2"</span>)
    fmt.<span class="function">Println</span>(<span class="string">"A2 çš„å€¼:"</span>, cell)
    
    <span class="comment">// è·å–æ‰€æœ‰è¡Œ</span>
    rows, _ := f.<span class="function">GetRows</span>(<span class="string">"Sheet1"</span>)
    <span class="keyword">for</span> _, row := <span class="keyword">range</span> rows {
        fmt.<span class="function">Println</span>(row)
    }
}</code></pre>
            
            <h4>2. å•å…ƒæ ¼æ ¼å¼è®¾ç½®</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/xuri/excelize/v2"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    f := excelize.<span class="function">NewFile</span>()
    <span class="keyword">defer</span> f.<span class="function">Close</span>()
    
    <span class="comment">// è®¾ç½®å­—ä½“æ ·å¼</span>
    style, _ := f.<span class="function">NewStyle</span>(&excelize.Style{
        Font: &excelize.Font{
            Bold:   <span class="keyword">true</span>,
            Italic: <span class="keyword">true</span>,
            Family: <span class="string">"Arial"</span>,
            Size:   14,
            Color:  <span class="string">"#FF0000"</span>,
        },
    })
    f.<span class="function">SetCellStyle</span>(<span class="string">"Sheet1"</span>, <span class="string">"A1"</span>, <span class="string">"A1"</span>, style)
    
    <span class="comment">// è®¾ç½®è¾¹æ¡†</span>
    borderStyle, _ := f.<span class="function">NewStyle</span>(&excelize.Style{
        Border: []excelize.Border{
            {Type: <span class="string">"left"</span>, Color: <span class="string">"#000000"</span>, Style: 1},
            {Type: <span class="string">"top"</span>, Color: <span class="string">"#000000"</span>, Style: 1},
            {Type: <span class="string">"bottom"</span>, Color: <span class="string">"#000000"</span>, Style: 1},
            {Type: <span class="string">"right"</span>, Color: <span class="string">"#000000"</span>, Style: 1},
        },
    })
    f.<span class="function">SetCellStyle</span>(<span class="string">"Sheet1"</span>, <span class="string">"A1"</span>, <span class="string">"C10"</span>, borderStyle)
    
    <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²</span>
    fillStyle, _ := f.<span class="function">NewStyle</span>(&excelize.Style{
        Fill: excelize.Fill{
            Type:    <span class="string">"pattern"</span>,
            Color:   []<span class="keyword">string</span>{<span class="string">"#E0E0E0"</span>},
            Pattern: 1,
        },
    })
    f.<span class="function">SetCellStyle</span>(<span class="string">"Sheet1"</span>, <span class="string">"A1"</span>, <span class="string">"A1"</span>, fillStyle)
    
    f.<span class="function">SaveAs</span>(<span class="string">"styled.xlsx"</span>)
}</code></pre>
            
            <h4>3. åˆ›å»ºå›¾è¡¨</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/xuri/excelize/v2"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    f := excelize.<span class="function">NewFile</span>()
    <span class="keyword">defer</span> f.<span class="function">Close</span>()
    
    <span class="comment">// æ·»åŠ æ•°æ®</span>
    <span class="keyword">for</span> i, row := <span class="keyword">range</span> [][]<span class="keyword">interface</span>{}{
        {<span class="string">"äº§å“"</span>, <span class="string">"é”€å”®é‡"</span>},
        {<span class="string">"A"</span>, 100},
        {<span class="string">"B"</span>, 200},
        {<span class="string">"C"</span>, 150},
    } {
        <span class="keyword">for</span> j, cell := <span class="keyword">range</span> row {
            f.<span class="function">SetCellValue</span>(<span class="string">"Sheet1"</span>, 
                fmt.<span class="function">Sprintf</span>(<span class="string">"%c%d"</span>, <span class="string">'A'</span>+j, i+1), cell)
        }
    }
    
    <span class="comment">// åˆ›å»ºæŸ±çŠ¶å›¾</span>
    <span class="keyword">if</span> err := f.<span class="function">AddChart</span>(<span class="string">"Sheet1"</span>, <span class="string">"E1"</span>, &excelize.Chart{
        Type: excelize.<span class="function">Col</span>,
        Series: []excelize.ChartSeries{
            {
                Name:       <span class="string">"Sheet1!$B$1"</span>,
                Categories: <span class="string">"Sheet1!$A$2:$A$4"</span>,
                Values:     <span class="string">"Sheet1!$B$2:$B$4"</span>,
            },
        },
        Format: excelize.GraphicOptions{
            ScaleX: 1,
            ScaleY: 1,
        },
        Title: []excelize.ChartTitle{
            {Text: <span class="string">"äº§å“é”€å”®é‡æŸ±çŠ¶å›¾"</span>},
        },
    }); err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(err)
    }
    
    f.<span class="function">SaveAs</span>(<span class="string">"chart.xlsx"</span>)
}</code></pre>
            
            <h4>4. æ’å…¥å›¾ç‰‡</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/xuri/excelize/v2"</span>
    <span class="string">_ "image/jpeg"</span>
    <span class="string">_ "image/png"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    f := excelize.<span class="function">NewFile</span>()
    <span class="keyword">defer</span> f.<span class="function">Close</span>()
    
    <span class="comment">// æ’å…¥å›¾ç‰‡</span>
    <span class="keyword">if</span> err := f.<span class="function">AddPicture</span>(<span class="string">"Sheet1"</span>, <span class="string">"A1"</span>, <span class="string">"image.png"</span>, 
        &excelize.Picture{
            Format:     excelize.<span class="function">PictureType</span>(<span class="string">"image/png"</span>),
            Width:      200,
            Height:     150,
            PrintObj:   <span class="keyword">true</span>,
            LockAspect: <span class="keyword">true</span>,
        }); err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(err)
    }
    
    f.<span class="function">SaveAs</span>(<span class="string">"image.xlsx"</span>)
}</code></pre>
            
            <h4>5. æµå¼è¯»å–å¤§å‹ Excel æ–‡ä»¶</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/xuri/excelize/v2"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    f, err := excelize.<span class="function">OpenFile</span>(<span class="string">"large_file.xlsx"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(err)
        <span class="keyword">return</span>
    }
    <span class="keyword">defer</span> f.<span class="function">Close</span>()
    
    <span class="comment">// ä½¿ç”¨æµå¼è¯»å–å™¨</span>
    rows, err := f.<span class="function">Rows</span>(<span class="string">"Sheet1"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        fmt.<span class="function">Println</span>(err)
        <span class="keyword">return</span>
    }
    <span class="keyword">defer</span> rows.<span class="function">Close</span>()
    
    <span class="keyword">for</span> rows.<span class="function">Next</span>() {
        row, err := rows.<span class="function">Columns</span>()
        <span class="keyword">if</span> err != <span class="keyword">nil</span> {
            fmt.<span class="function">Println</span>(err)
            <span class="keyword">continue</span>
        }
        fmt.<span class="function">Println</span>(row)
    }
}</code></pre>
            
            <h4>6. ä½¿ç”¨å…¬å¼å’Œå‡½æ•°</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/xuri/excelize/v2"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    f := excelize.<span class="function">NewFile</span>()
    <span class="keyword">defer</span> f.<span class="function">Close</span>()
    
    <span class="comment">// è®¾ç½®æ•°æ®</span>
    f.<span class="function">SetCellValue</span>(<span class="string">"Sheet1"</span>, <span class="string">"A1"</span>, 10)
    f.<span class="function">SetCellValue</span>(<span class="string">"Sheet1"</span>, <span class="string">"A2"</span>, 20)
    f.<span class="function">SetCellValue</span>(<span class="string">"Sheet1"</span>, <span class="string">"A3"</span>, 30)
    
    <span class="comment">// ä½¿ç”¨å…¬å¼</span>
    f.<span class="function">SetCellValue</span>(<span class="string">"Sheet1"</span>, <span class="string">"A4"</span>, <span class="string">"=SUM(A1:A3)"</span>)
    f.<span class="function">SetCellValue</span>(<span class="string">"Sheet1"</span>, <span class="string">"A5"</span>, <span class="string">"=AVERAGE(A1:A3)"</span>)
    f.<span class="function">SetCellValue</span>(<span class="string">"Sheet1"</span>, <span class="string">"A6"</span>, <span class="string">"=MAX(A1:A3)"</span>)
    f.<span class="function">SetCellValue</span>(<span class="string">"Sheet1"</span>, <span class="string">"A7"</span>, <span class="string">"=MIN(A1:A3)"</span>)
    
    <span class="comment">// è®¡ç®—å…¬å¼ç»“æœ</span>
    result, _ := f.<span class="function">GetCellValue</span>(<span class="string">"Sheet1"</span>, <span class="string">"A4"</span>)
    fmt.<span class="function">Println</span>(<span class="string">"SUM ç»“æœ:"</span>, result)
    
    f.<span class="function">SaveAs</span>(<span class="string">"formula.xlsx"</span>)
}</code></pre>
            
            <h3>æœ€ä½³å®è·µ</h3>
            
            <h4>1. å†…å­˜ç®¡ç†</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/xuri/excelize/v2"</span>
)

<span class="function">func</span> <span class="function">processLargeExcel</span>(filePath <span class="keyword">string</span>) <span class="keyword">error</span> {
    <span class="comment">// ä½¿ç”¨æµå¼è¯»å–é¿å…å†…å­˜æº¢å‡º</span>
    f, err := excelize.<span class="function">OpenFile</span>(filePath, excelize.Options{
        Password: <span class="string">""</span>,
    })
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> f.<span class="function">Close</span>()
    
    <span class="comment">// ä½¿ç”¨ Rows æµå¼è¯»å–</span>
    rows, err := f.<span class="function">Rows</span>(<span class="string">"Sheet1"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> rows.<span class="function">Close</span>()
    
    <span class="keyword">for</span> rows.<span class="function">Next</span>() {
        row, _ := rows.<span class="function">Columns</span>()
        <span class="comment">// å¤„ç†æ¯ä¸€è¡Œ</span>
        _ = row
    }
    
    <span class="keyword">return</span> <span class="keyword">nil</span>
}</code></pre>
            
            <h4>2. é”™è¯¯å¤„ç†å’ŒéªŒè¯</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/xuri/excelize/v2"</span>
)

<span class="function">func</span> <span class="function">safeSetCellValue</span>(f *excelize.File, sheet, cell <span class="keyword">string</span>, value <span class="keyword">interface</span>{}) <span class="keyword">error</span> {
    <span class="keyword">if</span> err := f.<span class="function">SetCellValue</span>(sheet, cell, value); err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> fmt.<span class="function">Errorf</span>(<span class="string">"è®¾ç½®å•å…ƒæ ¼ %s å¤±è´¥: %v"</span>, cell, err)
    }
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="function">func</span> <span class="function">validateCellValue</span>(value <span class="keyword">interface</span>{}) <span class="keyword">error</span> {
    <span class="keyword">switch</span> v := value.(<span class="keyword">type</span>) {
    <span class="keyword">case</span> <span class="keyword">string</span>:
        <span class="keyword">if</span> <span class="function">len</span>(v) > 32767 {
            <span class="keyword">return</span> fmt.<span class="function">Errorf</span>(<span class="string">"å­—ç¬¦ä¸²é•¿åº¦è¶…è¿‡ Excel é™åˆ¶"</span>)
        }
    <span class="keyword">case</span> <span class="keyword">int</span>, <span class="keyword">int64</span>:
        <span class="keyword">if</span> v < -9007199254740992 || v > 9007199254740992 {
            <span class="keyword">return</span> fmt.<span class="function">Errorf</span>(<span class="string">"æ•°å€¼è¶…å‡º Excel èŒƒå›´"</span>)
        }
    }
    <span class="keyword">return</span> <span class="keyword">nil</span>
}</code></pre>
            
            <h4>3. æ€§èƒ½ä¼˜åŒ–</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/xuri/excelize/v2"</span>
)

<span class="function">func</span> <span class="function">batchWriteCells</span>(f *excelize.File, sheet <span class="keyword">string</span>, data [][]<span class="keyword">interface</span>{}) <span class="keyword">error</span> {
    <span class="comment">// æ‰¹é‡å†™å…¥å•å…ƒæ ¼ï¼Œå‡å°‘ I/O æ“ä½œ</span>
    <span class="keyword">for</span> i, row := <span class="keyword">range</span> data {
        <span class="keyword">for</span> j, cell := <span class="keyword">range</span> row {
            cellName, _ := excelize.<span class="function">CoordinatesToCellName</span>(j+1, i+1)
            <span class="keyword">if</span> err := f.<span class="function">SetCellValue</span>(sheet, cellName, cell); err != <span class="keyword">nil</span> {
                <span class="keyword">return</span> err
            }
        }
    }
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="function">func</span> <span class="function">optimizeStyle</span>(f *excelize.File) {
    <span class="comment">// å¤ç”¨æ ·å¼å¯¹è±¡ï¼Œå‡å°‘å†…å­˜åˆ†é…</span>
    headerStyle, _ := f.<span class="function">NewStyle</span>(&excelize.Style{
        Font: &excelize.Font{Bold: <span class="keyword">true</span>},
    })
    
    <span class="comment">// åº”ç”¨æ ·å¼åˆ°å¤šä¸ªå•å…ƒæ ¼</span>
    f.<span class="function">SetCellStyle</span>(<span class="string">"Sheet1"</span>, <span class="string">"A1"</span>, <span class="string">"Z1"</span>, headerStyle)
}</code></pre>
            
            <h4>4. æ¨¡æ¿å¤„ç†</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/xuri/excelize/v2"</span>
)

<span class="function">func</span> <span class="function">generateReportFromTemplate</span>(templatePath, outputPath <span class="keyword">string</span>, data <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>{}) <span class="keyword">error</span> {
    <span class="comment">// ä»æ¨¡æ¿åˆ›å»ºæ–°æ–‡ä»¶</span>
    f, err := excelize.<span class="function">OpenFile</span>(templatePath)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> f.<span class="function">Close</span>()
    
    <span class="comment">// æ›¿æ¢æ¨¡æ¿ä¸­çš„å ä½ç¬¦</span>
    <span class="keyword">for</span> key, value := <span class="keyword">range</span> data {
        f.<span class="function">SetCellValue</span>(<span class="string">"Sheet1"</span>, key, value)
    }
    
    <span class="comment">// ä¿å­˜ä¸ºæ–°æ–‡ä»¶</span>
    <span class="keyword">return</span> f.<span class="function">SaveAs</span>(outputPath)
}</code></pre>
            
            <h4>5. å¹¶å‘å¤„ç†</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"sync"</span>
    <span class="string">"github.com/xuri/excelize/v2"</span>
)

<span class="function">func</span> <span class="function">processMultipleSheets</span>(filePath <span class="keyword">string</span>) <span class="keyword">error</span> {
    f, err := excelize.<span class="function">OpenFile</span>(filePath)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> f.<span class="function">Close</span>()
    
    sheets := f.<span class="function">GetSheetList</span>()
    <span class="keyword">var</span> wg sync.WaitGroup
    
    <span class="comment">// å¹¶å‘å¤„ç†å¤šä¸ªå·¥ä½œè¡¨</span>
    <span class="keyword">for</span> _, sheet := <span class="keyword">range</span> sheets {
        wg.<span class="function">Add</span>(1)
        <span class="keyword">go</span> <span class="function">func</span>(s <span class="keyword">string</span>) {
            <span class="keyword">defer</span> wg.<span class="function">Done</span>()
            <span class="comment">// å¤„ç†å·¥ä½œè¡¨</span>
            _ = s
        }(sheet)
    }
    
    wg.<span class="function">Wait</span>()
    <span class="keyword">return</span> <span class="keyword">nil</span>
}</code></pre>
            
            <h3>ä½¿ç”¨åœºæ™¯</h3>
            <ul>
                <li><strong>æŠ¥è¡¨ç”Ÿæˆ</strong>ï¼šç”Ÿæˆä¸šåŠ¡æŠ¥è¡¨ã€è´¢åŠ¡æŠ¥è¡¨ã€é”€å”®æŠ¥è¡¨ç­‰</li>
                <li><strong>æ•°æ®å¯¼å‡º</strong>ï¼šå°†æ•°æ®åº“æ•°æ®å¯¼å‡ºä¸º Excel æ–‡ä»¶</li>
                <li><strong>æ•°æ®å¯¼å…¥</strong>ï¼šä» Excel æ–‡ä»¶å¯¼å…¥æ•°æ®åˆ°æ•°æ®åº“</li>
                <li><strong>æ•°æ®åˆ†æ</strong>ï¼šè¯»å– Excel æ•°æ®è¿›è¡Œåˆ†æå’Œå¤„ç†</li>
                <li><strong>æ¨¡æ¿å¡«å……</strong>ï¼šåŸºäºæ¨¡æ¿ç”Ÿæˆæ ‡å‡†åŒ–æ–‡æ¡£</li>
            </ul>
            
            <h3>æ³¨æ„äº‹é¡¹</h3>
            <ul>
                <li>å¤„ç†å¤§å‹ Excel æ–‡ä»¶æ—¶ï¼Œå»ºè®®ä½¿ç”¨æµå¼è¯»å–é¿å…å†…å­˜æº¢å‡º</li>
                <li>æ³¨æ„ Excel çš„å•å…ƒæ ¼é™åˆ¶ï¼ˆå­—ç¬¦ä¸²é•¿åº¦ 32767 å­—ç¬¦ï¼Œæ•°å€¼èŒƒå›´ç­‰ï¼‰</li>
                <li>æ ·å¼å¯¹è±¡åº”è¯¥å¤ç”¨ï¼Œé¿å…é‡å¤åˆ›å»º</li>
                <li>ä½¿ç”¨å®Œæ¯•åè®°å¾—å…³é—­æ–‡ä»¶ï¼Œé‡Šæ”¾èµ„æº</li>
                <li>åœ¨å¹¶å‘ç¯å¢ƒä¸­ä½¿ç”¨æ—¶ï¼Œæ³¨æ„çº¿ç¨‹å®‰å…¨é—®é¢˜</li>
                <li>å…¬å¼è®¡ç®—å¯èƒ½éœ€è¦é¢å¤–çš„æ€§èƒ½å¼€é”€</li>
            </ul>
            </div>

            <h2 id="imaging">Imaging å›¾ç‰‡å¤„ç†</h2>
            <p>Imaging æ˜¯ä¸€ä¸ªç®€å•è€Œå¼ºå¤§çš„ Go è¯­è¨€å›¾ç‰‡å¤„ç†åº“ï¼Œæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½æ¥å¤„ç†å›¾ç‰‡ï¼ŒåŒ…æ‹¬ç¼©æ”¾ã€è£å‰ªã€æ—‹è½¬ã€æ»¤é•œã€é¢œè‰²è°ƒæ•´ç­‰ã€‚å®ƒåŸºäºæ ‡å‡†åº“ `image` å’Œ `image/draw`ï¼Œæ˜“äºä½¿ç”¨ä¸”æ€§èƒ½ä¼˜ç§€ã€‚</p>
            
            <h3>æ ¸å¿ƒç‰¹æ€§</h3>
            <ul>
                <li><strong>åŸºç¡€æ“ä½œ</strong>ï¼šæ”¯æŒå›¾ç‰‡ç¼©æ”¾ã€è£å‰ªã€æ—‹è½¬ã€ç¿»è½¬ç­‰åŸºç¡€æ“ä½œ</li>
                <li><strong>æ»¤é•œæ•ˆæœ</strong>ï¼šæä¾›æ¨¡ç³Šã€é”åŒ–ã€è¾¹ç¼˜æ£€æµ‹ç­‰æ»¤é•œæ•ˆæœ</li>
                <li><strong>é¢œè‰²è°ƒæ•´</strong>ï¼šæ”¯æŒäº®åº¦ã€å¯¹æ¯”åº¦ã€é¥±å’Œåº¦ã€è‰²ç›¸è°ƒæ•´</li>
                <li><strong>æ ¼å¼æ”¯æŒ</strong>ï¼šæ”¯æŒ JPEGã€PNGã€GIFã€TIFFã€BMP ç­‰å¸¸è§æ ¼å¼</li>
                <li><strong>é«˜æ€§èƒ½</strong>ï¼šä¼˜åŒ–çš„ç®—æ³•ï¼Œå¤„ç†é€Ÿåº¦å¿«</li>
                <li><strong>ç®€å•æ˜“ç”¨</strong>ï¼šç®€æ´çš„ API è®¾è®¡ï¼Œæ˜“äºé›†æˆ</li>
            </ul>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get github.com/disintegration/imaging</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"log"</span>
    <span class="string">"github.com/disintegration/imaging"</span>
    <span class="string">"image"</span>
    <span class="string">_ "image/jpeg"</span>
    <span class="string">_ "image/png"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// æ‰“å¼€å›¾ç‰‡</span>
    src, err := imaging.<span class="function">Open</span>(<span class="string">"input.jpg"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        log.<span class="function">Fatal</span>(err)
    }
    <span class="keyword">defer</span> src.<span class="function">Close</span>()
    
    <span class="comment">// ç¼©æ”¾å›¾ç‰‡</span>
    dst := imaging.<span class="function">Resize</span>(src, 800, 0, imaging.<span class="function">Lanczos</span>)
    
    <span class="comment">// ä¿å­˜å›¾ç‰‡</span>
    err = imaging.<span class="function">Save</span>(dst, <span class="string">"output.jpg"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        log.<span class="function">Fatal</span>(err)
    }
}</code></pre>
            
            <h3>å¸¸ç”¨åŠŸèƒ½</h3>
            
            <h4>1. ç¼©æ”¾å’Œè£å‰ª</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/disintegration/imaging"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    src, _ := imaging.<span class="function">Open</span>(<span class="string">"input.jpg"</span>)
    <span class="keyword">defer</span> src.<span class="function">Close</span>()
    
    <span class="comment">// æŒ‰å®½åº¦ç¼©æ”¾ï¼Œä¿æŒå®½é«˜æ¯”</span>
    resized1 := imaging.<span class="function">Resize</span>(src, 800, 0, imaging.<span class="function">Lanczos</span>)
    
    <span class="comment">// æŒ‰é«˜åº¦ç¼©æ”¾ï¼Œä¿æŒå®½é«˜æ¯”</span>
    resized2 := imaging.<span class="function">Resize</span>(src, 0, 600, imaging.<span class="function">Lanczos</span>)
    
    <span class="comment">// ç¼©æ”¾åˆ°æŒ‡å®šå°ºå¯¸ï¼ˆå¯èƒ½å˜å½¢ï¼‰</span>
    resized3 := imaging.<span class="function">Resize</span>(src, 800, 600, imaging.<span class="function">Lanczos</span>)
    
    <span class="comment">// è£å‰ªå›¾ç‰‡</span>
    cropped := imaging.<span class="function">Crop</span>(src, image.Rect(100, 100, 500, 500))
    
    <span class="comment">// ç¼©ç•¥å›¾ç”Ÿæˆ</span>
    thumbnail := imaging.<span class="function">Thumbnail</span>(src, 100, 100, imaging.<span class="function">Lanczos</span>)
    
    imaging.<span class="function">Save</span>(resized1, <span class="string">"resized1.jpg"</span>)
    imaging.<span class="function">Save</span>(cropped, <span class="string">"cropped.jpg"</span>)
    imaging.<span class="function">Save</span>(thumbnail, <span class="string">"thumbnail.jpg"</span>)
}</code></pre>
            
            <h4>2. æ—‹è½¬å’Œç¿»è½¬</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/disintegration/imaging"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    src, _ := imaging.<span class="function">Open</span>(<span class="string">"input.jpg"</span>)
    <span class="keyword">defer</span> src.<span class="function">Close</span>()
    
    <span class="comment">// æ—‹è½¬ 90 åº¦</span>
    rotated90 := imaging.<span class="function">Rotate90</span>(src)
    
    <span class="comment">// æ—‹è½¬ 180 åº¦</span>
    rotated180 := imaging.<span class="function">Rotate180</span>(src)
    
    <span class="comment">// æ—‹è½¬ 270 åº¦</span>
    rotated270 := imaging.<span class="function">Rotate270</span>(src)
    
    <span class="comment">// æ—‹è½¬ä»»æ„è§’åº¦</span>
    rotated45 := imaging.<span class="function">Rotate</span>(src, 45, <span class="keyword">nil</span>)
    
    <span class="comment">// æ°´å¹³ç¿»è½¬</span>
    flippedH := imaging.<span class="function">FlipH</span>(src)
    
    <span class="comment">// å‚ç›´ç¿»è½¬</span>
    flippedV := imaging.<span class="function">FlipV</span>(src)
    
    imaging.<span class="function">Save</span>(rotated90, <span class="string">"rotated90.jpg"</span>)
    imaging.<span class="function">Save</span>(flippedH, <span class="string">"flipped_h.jpg"</span>)
}</code></pre>
            
            <h4>3. æ»¤é•œæ•ˆæœ</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/disintegration/imaging"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    src, _ := imaging.<span class="function">Open</span>(<span class="string">"input.jpg"</span>)
    <span class="keyword">defer</span> src.<span class="function">Close</span>()
    
    <span class="comment">// æ¨¡ç³Šæ•ˆæœ</span>
    blurred := imaging.<span class="function">Blur</span>(src, 5.0)
    
    <span class="comment">// é”åŒ–æ•ˆæœ</span>
    sharpened := imaging.<span class="function">Sharpen</span>(src, 2.0)
    
    <span class="comment">// è°ƒæ•´äº®åº¦</span>
    brighter := imaging.<span class="function">AdjustBrightness</span>(src, 20)
    darker := imaging.<span class="function">AdjustBrightness</span>(src, -20)
    
    <span class="comment">// è°ƒæ•´å¯¹æ¯”åº¦</span>
    contrast := imaging.<span class="function">AdjustContrast</span>(src, 20)
    
    <span class="comment">// è°ƒæ•´é¥±å’Œåº¦</span>
    saturated := imaging.<span class="function">AdjustSaturation</span>(src, 50)
    
    <span class="comment">// ç°åº¦åŒ–</span>
    grayscale := imaging.<span class="function">Grayscale</span>(src)
    
    <span class="comment">// åè‰²</span>
    inverted := imaging.<span class="function">Invert</span>(src)
    
    imaging.<span class="function">Save</span>(blurred, <span class="string">"blurred.jpg"</span>)
    imaging.<span class="function">Save</span>(grayscale, <span class="string">"grayscale.jpg"</span>)
    imaging.<span class="function">Save</span>(inverted, <span class="string">"inverted.jpg"</span>)
}</code></pre>
            
            <h4>4. å›¾ç‰‡åˆæˆ</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/disintegration/imaging"</span>
    <span class="string">"image"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åŠ è½½ä¸¤å¼ å›¾ç‰‡</span>
    bg, _ := imaging.<span class="function">Open</span>(<span class="string">"background.jpg"</span>)
    <span class="keyword">defer</span> bg.<span class="function">Close</span>()
    
    overlay, _ := imaging.<span class="function">Open</span>(<span class="string">"overlay.png"</span>)
    <span class="keyword">defer</span> overlay.<span class="function">Close</span>()
    
    <span class="comment">// è°ƒæ•´overlayå›¾ç‰‡å¤§å°</span>
    overlay = imaging.<span class="function">Resize</span>(overlay, 200, 0, imaging.<span class="function">Lanczos</span>)
    
    <span class="comment">// åœ¨èƒŒæ™¯å›¾ä¸Šç»˜åˆ¶overlay</span>
    dst := imaging.<span class="function">Overlay</span>(bg, overlay, image.Pt(100, 100), 1.0)
    
    <span class="comment">// åˆ›å»ºæ°´å°æ•ˆæœï¼ˆåŠé€æ˜ï¼‰</span>
    watermark := imaging.<span class="function">Overlay</span>(bg, overlay, image.Pt(100, 100), 0.5)
    
    imaging.<span class="function">Save</span>(dst, <span class="string">"overlay.jpg"</span>)
    imaging.<span class="function">Save</span>(watermark, <span class="string">"watermark.jpg"</span>)
}</code></pre>
            
            <h4>5. æ‰¹é‡å¤„ç†</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"os"</span>
    <span class="string">"path/filepath"</span>
    <span class="string">"github.com/disintegration/imaging"</span>
)

<span class="function">func</span> <span class="function">batchProcessImages</span>(inputDir, outputDir <span class="keyword">string</span>) <span class="keyword">error</span> {
    <span class="comment">// éå†è¾“å…¥ç›®å½•</span>
    err := filepath.<span class="function">Walk</span>(inputDir, <span class="function">func</span>(path <span class="keyword">string</span>, info os.FileInfo, err <span class="keyword">error</span>) <span class="keyword">error</span> {
        <span class="keyword">if</span> err != <span class="keyword">nil</span> {
            <span class="keyword">return</span> err
        }
        
        <span class="comment">// è·³è¿‡ç›®å½•</span>
        <span class="keyword">if</span> info.<span class="function">IsDir</span>() {
            <span class="keyword">return</span> <span class="keyword">nil</span>
        }
        
        <span class="comment">// åªå¤„ç†å›¾ç‰‡æ–‡ä»¶</span>
        ext := filepath.<span class="function">Ext</span>(path)
        <span class="keyword">if</span> ext != <span class="string">".jpg"</span> && ext != <span class="string">".png"</span> {
            <span class="keyword">return</span> <span class="keyword">nil</span>
        }
        
        <span class="comment">// æ‰“å¼€å›¾ç‰‡</span>
        src, err := imaging.<span class="function">Open</span>(path)
        <span class="keyword">if</span> err != <span class="keyword">nil</span> {
            <span class="keyword">return</span> err
        }
        <span class="keyword">defer</span> src.<span class="function">Close</span>()
        
        <span class="comment">// è°ƒæ•´å¤§å°</span>
        dst := imaging.<span class="function">Resize</span>(src, 800, 0, imaging.<span class="function">Lanczos</span>)
        
        <span class="comment">// ä¿å­˜åˆ°è¾“å‡ºç›®å½•</span>
        outputPath := filepath.<span class="function">Join</span>(outputDir, filepath.<span class="function">Base</span>(path))
        <span class="keyword">return</span> imaging.<span class="function">Save</span>(dst, outputPath)
    })
    
    <span class="keyword">return</span> err
}</code></pre>
            
            <h3>æœ€ä½³å®è·µ</h3>
            
            <h4>1. å†…å­˜ç®¡ç†</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/disintegration/imaging"</span>
)

<span class="function">func</span> <span class="function">processLargeImage</span>(filePath <span class="keyword">string</span>) <span class="keyword">error</span> {
    <span class="comment">// ä½¿ç”¨ io.Reader é€æ­¥è¯»å–å¤§å›¾ç‰‡</span>
    src, err := imaging.<span class="function">Open</span>(filePath)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> src.<span class="function">Close</span>()
    
    <span class="comment">// å¤„ç†å®Œåç«‹å³é‡Šæ”¾èµ„æº</span>
    dst := imaging.<span class="function">Resize</span>(src, 800, 0, imaging.<span class="function">Lanczos</span>)
    
    <span class="comment">// ä¿å­˜åå…³é—­</span>
    err = imaging.<span class="function">Save</span>(dst, <span class="string">"output.jpg"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    
    <span class="comment">// æ˜¾å¼é‡Šæ”¾å†…å­˜</span>
    dst = <span class="keyword">nil</span>
    <span class="keyword">return</span> <span class="keyword">nil</span>
}</code></pre>
            
            <h4>2. é”™è¯¯å¤„ç†</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/disintegration/imaging"</span>
)

<span class="function">func</span> <span class="function">safeProcessImage</span>(inputPath, outputPath <span class="keyword">string</span>) <span class="keyword">error</span> {
    <span class="comment">// éªŒè¯è¾“å…¥æ–‡ä»¶</span>
    src, err := imaging.<span class="function">Open</span>(inputPath)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> fmt.<span class="function">Errorf</span>(<span class="string">"æ— æ³•æ‰“å¼€å›¾ç‰‡ %s: %v"</span>, inputPath, err)
    }
    <span class="keyword">defer</span> src.<span class="function">Close</span>()
    
    <span class="comment">// éªŒè¯è¾“å‡ºè·¯å¾„</span>
    <span class="keyword">if</span> outputPath == <span class="string">""</span> {
        <span class="keyword">return</span> fmt.<span class="function">Errorf</span>(<span class="string">"è¾“å‡ºè·¯å¾„ä¸èƒ½ä¸ºç©º"</span>)
    }
    
    <span class="comment">// å¤„ç†å›¾ç‰‡</span>
    dst := imaging.<span class="function">Resize</span>(src, 800, 0, imaging.<span class="function">Lanczos</span>)
    
    <span class="comment">// ä¿å­˜å¹¶å¤„ç†é”™è¯¯</span>
    <span class="keyword">if</span> err := imaging.<span class="function">Save</span>(dst, outputPath); err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> fmt.<span class="function">Errorf</span>(<span class="string">"ä¿å­˜å›¾ç‰‡å¤±è´¥: %v"</span>, err)
    }
    
    <span class="keyword">return</span> <span class="keyword">nil</span>
}</code></pre>
            
            <h4>3. æ€§èƒ½ä¼˜åŒ–</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/disintegration/imaging"</span>
    <span class="string">"image"</span>
)

<span class="function">func</span> <span class="function">optimizeProcessing</span>(src image.Image) image.Image {
    <span class="comment">// ä½¿ç”¨åˆé€‚çš„æ’å€¼ç®—æ³•</span>
    <span class="comment">// Lanczos: é«˜è´¨é‡ä½†æ…¢</span>
    <span class="comment">// CatmullRom: å¹³è¡¡è´¨é‡å’Œé€Ÿåº¦</span>
    <span class="comment">// Linear: å¿«é€Ÿä½†è´¨é‡è¾ƒä½</span>
    
    <span class="comment">// æ ¹æ®å›¾ç‰‡å¤§å°é€‰æ‹©ç®—æ³•</span>
    bounds := src.<span class="function">Bounds</span>()
    <span class="keyword">if</span> bounds.<span class="function">Dx</span>() > 2000 || bounds.<span class="function">Dy</span>() > 2000 {
        <span class="comment">// å¤§å›¾ç‰‡ä½¿ç”¨å¿«é€Ÿç®—æ³•</span>
        <span class="keyword">return</span> imaging.<span class="function">Resize</span>(src, 800, 0, imaging.<span class="function">Linear</span>)
    } <span class="keyword">else</span> {
        <span class="comment">// å°å›¾ç‰‡ä½¿ç”¨é«˜è´¨é‡ç®—æ³•</span>
        <span class="keyword">return</span> imaging.<span class="function">Resize</span>(src, 800, 0, imaging.<span class="function">Lanczos</span>)
    }
}</code></pre>
            
            <h4>4. æ ¼å¼è½¬æ¢</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"path/filepath"</span>
    <span class="string">"github.com/disintegration/imaging"</span>
)

<span class="function">func</span> <span class="function">convertFormat</span>(inputPath, outputFormat <span class="keyword">string</span>) <span class="keyword">error</span> {
    src, err := imaging.<span class="function">Open</span>(inputPath)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">defer</span> src.<span class="function">Close</span>()
    
    <span class="comment">// æ„å»ºè¾“å‡ºè·¯å¾„</span>
    outputPath := filepath.<span class="function">Join</span>(
        filepath.<span class="function">Dir</span>(inputPath),
        filepath.<span class="function">Base</span>(inputPath[:<span class="function">len</span>(inputPath)-<span class="function">len</span>(filepath.<span class="function">Ext</span>(inputPath))])+<span class="string">"."</span>+outputFormat,
    )
    
    <span class="comment">// æ ¹æ®æ ¼å¼è°ƒæ•´è´¨é‡</span>
    <span class="keyword">if</span> outputFormat == <span class="string">"jpg"</span> {
        <span class="comment">// JPEG æ ¼å¼ï¼Œä½¿ç”¨é»˜è®¤è´¨é‡</span>
        <span class="keyword">return</span> imaging.<span class="function">Save</span>(src, outputPath)
    } <span class="keyword">else if</span> outputFormat == <span class="string">"png"</span> {
        <span class="comment">// PNG æ ¼å¼ï¼Œæ— æŸå‹ç¼©</span>
        <span class="keyword">return</span> imaging.<span class="function">Save</span>(src, outputPath)
    }
    
    <span class="keyword">return</span> <span class="keyword">nil</span>
}</code></pre>
            
            <h3>ä½¿ç”¨åœºæ™¯</h3>
            <ul>
                <li><strong>å›¾ç‰‡ç¼©ç•¥å›¾</strong>ï¼šç”Ÿæˆç½‘ç«™æˆ–åº”ç”¨çš„ç¼©ç•¥å›¾</li>
                <li><strong>å›¾ç‰‡å‹ç¼©</strong>ï¼šä¼˜åŒ–å›¾ç‰‡å¤§å°ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´</li>
                <li><strong>å›¾ç‰‡æ°´å°</strong>ï¼šä¸ºå›¾ç‰‡æ·»åŠ ç‰ˆæƒæ°´å°</li>
                <li><strong>å›¾ç‰‡ç¼–è¾‘</strong>ï¼šå®ç°ç®€å•çš„å›¾ç‰‡ç¼–è¾‘åŠŸèƒ½</li>
                <li><strong>æ‰¹é‡å¤„ç†</strong>ï¼šæ‰¹é‡å¤„ç†å¤§é‡å›¾ç‰‡æ–‡ä»¶</li>
            </ul>
            
            <h3>æ³¨æ„äº‹é¡¹</h3>
            <ul>
                <li>å¤„ç†å¤§å›¾ç‰‡æ—¶æ³¨æ„å†…å­˜ä½¿ç”¨ï¼ŒåŠæ—¶é‡Šæ”¾èµ„æº</li>
                <li>é€‰æ‹©åˆé€‚çš„æ’å€¼ç®—æ³•å¹³è¡¡è´¨é‡å’Œæ€§èƒ½</li>
                <li>JPEG æ ¼å¼æ˜¯æœ‰æŸå‹ç¼©ï¼ŒPNG æ˜¯æ— æŸå‹ç¼©</li>
                <li>æ³¨æ„å¤„ç†é€æ˜é€šé“ï¼ˆPNGï¼‰</li>
                <li>æ‰¹é‡å¤„ç†æ—¶å»ºè®®ä½¿ç”¨ goroutine å¹¶å‘å¤„ç†</li>
                <li>ä¿å­˜å›¾ç‰‡æ—¶æ³¨æ„é€‰æ‹©åˆé€‚çš„æ ¼å¼å’Œè´¨é‡</li>
            </ul>
            </div>

            <h2 id="testify">Testify æµ‹è¯•æ¡†æ¶</h2>
            <p>Testify æ˜¯ä¸€ä¸ª Go è¯­è¨€æµè¡Œçš„æµ‹è¯•å·¥å…·åŒ…ï¼Œæä¾›äº†æ–­è¨€ã€æ¨¡æ‹Ÿï¼ˆMockï¼‰ã€å¥—ä»¶ï¼ˆSuiteï¼‰ç­‰åŠŸèƒ½ï¼Œè®©ç¼–å†™æµ‹è¯•æ›´åŠ ç®€å•å’Œå¼ºå¤§ã€‚å®ƒæä¾›äº†ä¸°å¯Œçš„æ–­è¨€æ–¹æ³•ã€æ¨¡æ‹Ÿå¯¹è±¡å’Œæµ‹è¯•å¥—ä»¶åŠŸèƒ½ï¼Œæ˜¯ Go æµ‹è¯•ç”Ÿæ€ä¸­ä¸å¯æˆ–ç¼ºçš„å·¥å…·ã€‚</p>
            
            <h3>æ ¸å¿ƒç‰¹æ€§</h3>
            <ul>
                <li><strong>ä¸°å¯Œçš„æ–­è¨€</strong>ï¼šæä¾›å¤§é‡æ–­è¨€æ–¹æ³•ï¼Œç®€åŒ–æµ‹è¯•ä»£ç </li>
                <li><strong>æ¨¡æ‹Ÿå¯¹è±¡</strong>ï¼šæ”¯æŒåˆ›å»º Mock å¯¹è±¡ï¼Œä¾¿äºæµ‹è¯•ä¾èµ–</li>
                <li><strong>æµ‹è¯•å¥—ä»¶</strong>ï¼šæ”¯æŒæµ‹è¯•å¥—ä»¶å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†</li>
                <li><strong>HTTP æµ‹è¯•</strong>ï¼šæä¾› HTTP è¯·æ±‚/å“åº”çš„æ–­è¨€å’Œæ¨¡æ‹Ÿ</li>
                <li><strong>æ˜“äºé›†æˆ</strong>ï¼šä¸ Go æ ‡å‡†æµ‹è¯•æ¡†æ¶æ— ç¼é›†æˆ</li>
                <li><strong>æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯</strong>ï¼šæä¾›è¯¦ç»†çš„é”™è¯¯æŠ¥å‘Šå’Œå †æ ˆè·Ÿè¸ª</li>
            </ul>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get github.com/stretchr/testify</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> math

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
    <span class="string">"github.com/stretchr/testify/assert"</span>
)

<span class="function">func</span> <span class="function">TestAdd</span>(t *testing.T) {
    result := <span class="function">Add</span>(2, 3)
    assert.<span class="function">Equal</span>(t, 5, result, <span class="string">"2 + 3 åº”è¯¥ç­‰äº 5"</span>)
}</code></pre>
            
            <h3>å¸¸ç”¨åŠŸèƒ½</h3>
            
            <h4>1. åŸºæœ¬æ–­è¨€</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
    <span class="string">"github.com/stretchr/testify/assert"</span>
)

<span class="function">func</span> <span class="function">TestAssertions</span>(t *testing.T) {
    <span class="comment">// ç›¸ç­‰æ–­è¨€</span>
    assert.<span class="function">Equal</span>(t, <span class="string">"hello"</span>, <span class="string">"hello"</span>)
    assert.<span class="function">NotEqual</span>(t, <span class="string">"hello"</span>, <span class="string">"world"</span>)
    
    <span class="comment">// å¸ƒå°”æ–­è¨€</span>
    assert.<span class="function">True</span>(t, <span class="keyword">true</span>)
    assert.<span class="function">False</span>(t, <span class="keyword">false</span>)
    
    <span class="comment">// æ•°å€¼æ–­è¨€</span>
    assert.<span class="function">Equal</span>(t, 42, 42)
    assert.<span class="function">NotEqual</span>(t, 42, 43)
    
    <span class="comment">// nil æ–­è¨€</span>
    <span class="keyword">var</span> ptr *<span class="keyword">int</span>
    assert.<span class="function">Nil</span>(t, ptr)
    assert.<span class="function">NotNil</span>(t, &ptr)
    
    <span class="comment">// é”™è¯¯æ–­è¨€</span>
    err := <span class="function">someFunction</span>()
    assert.<span class="function">NoError</span>(t, err)
    assert.<span class="function">Error</span>(t, err)
}</code></pre>
            
            <h4>2. é›†åˆæ–­è¨€</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
    <span class="string">"github.com/stretchr/testify/assert"</span>
)

<span class="function">func</span> <span class="function">TestCollectionAssertions</span>(t *testing.T) {
    <span class="comment">// åˆ‡ç‰‡æ–­è¨€</span>
    slice := []<span class="keyword">int</span>{1, 2, 3}
    assert.<span class="function">Contains</span>(t, slice, 2)
    assert.<span class="function">NotContains</span>(t, slice, 4)
    assert.<span class="function">Len</span>(t, slice, 3)
    assert.<span class="function">Empty</span>(t, []<span class="keyword">int</span>{})
    assert.<span class="function">NotEmpty</span>(t, slice)
    
    <span class="comment">// Map æ–­è¨€</span>
    m := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>{<span class="string">"a"</span>: 1, <span class="string">"b"</span>: 2}
    assert.<span class="function">ContainsKey</span>(t, m, <span class="string">"a"</span>)
    assert.<span class="function">NotContainsKey</span>(t, m, <span class="string">"c"</span>)
    assert.<span class="function">Len</span>(t, m, 2)
}</code></pre>
            
            <h4>3. å¯¹è±¡æ–­è¨€</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
    <span class="string">"github.com/stretchr/testify/assert"</span>
)

<span class="keyword">type</span> User <span class="keyword">struct</span> {
    Name <span class="keyword">string</span>
    Age  <span class="keyword">int</span>
}

<span class="function">func</span> <span class="function">TestObjectAssertions</span>(t *testing.T) {
    user1 := User{Name: <span class="string">"Alice"</span>, Age: 30}
    user2 := User{Name: <span class="string">"Alice"</span>, Age: 30}
    user3 := User{Name: <span class="string">"Bob"</span>, Age: 25}
    
    <span class="comment">// å¯¹è±¡ç›¸ç­‰æ–­è¨€</span>
    assert.<span class="function">Equal</span>(t, user1, user2)
    assert.<span class="function">NotEqual</span>(t, user1, user3)
    
    <span class="comment">// æŒ‡é’ˆæ–­è¨€</span>
    ptr1 := &user1
    ptr2 := &user2
    assert.<span class="function">Same</span>(t, ptr1, ptr1)
    assert.<span class="function">NotSame</span>(t, ptr1, ptr2)
    
    <span class="comment">// ç±»å‹æ–­è¨€</span>
    <span class="keyword">var</span> <span class="keyword">interface</span>{} = user1
    assert.<span class="function">IsType</span>(t, User{}, <span class="keyword">interface</span>{})
    assert.<span class="function">Implements</span>(t, (*<span class="keyword">interface</span>{})(<span class="keyword">nil</span>), user1)
}</code></pre>
            
            <h4>4. Mock å¯¹è±¡</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
    <span class="string">"github.com/stretchr/testify/assert"</span>
    <span class="string">"github.com/stretchr/testify/mock"</span>
)

<span class="comment">// å®šä¹‰æ¥å£</span>
<span class="keyword">type</span> Database <span class="keyword">interface</span> {
    <span class="function">GetUser</span>(id <span class="keyword">int</span>) (*User, <span class="keyword">error</span>)
    <span class="function">SaveUser</span>(user *User) <span class="keyword">error</span>
}

<span class="comment">// åˆ›å»º Mock</span>
<span class="keyword">type</span> MockDatabase <span class="keyword">struct</span> {
    mock.Mock
}

<span class="function">func</span> (m *MockDatabase) <span class="function">GetUser</span>(id <span class="keyword">int</span>) (*User, <span class="keyword">error</span>) {
    args := m.<span class="function">Called</span>(id)
    <span class="keyword">if</span> args.Get(0) == <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="keyword">nil</span>, args.<span class="function">Error</span>(1)
    }
    <span class="keyword">return</span> args.Get(0).(*User), args.<span class="function">Error</span>(1)
}

<span class="function">func</span> (m *MockDatabase) <span class="function">SaveUser</span>(user *User) <span class="keyword">error</span> {
    args := m.<span class="function">Called</span>(user)
    <span class="keyword">return</span> args.<span class="function">Error</span>(0)
}

<span class="function">func</span> <span class="function">TestUserService</span>(t *testing.T) {
    <span class="comment">// åˆ›å»º Mock å¯¹è±¡</span>
    mockDB := <span class="keyword">new</span>(MockDatabase)
    
    <span class="comment">// è®¾ç½®æœŸæœ›</span>
    mockDB.<span class="function">On</span>(<span class="string">"GetUser"</span>, 1).<span class="function">Return</span>(&User{Name: <span class="string">"Alice"</span>}, <span class="keyword">nil</span>)
    mockDB.<span class="function">On</span>(<span class="string">"SaveUser"</span>, mock.Anything).<span class="function">Return</span>(<span class="keyword">nil</span>)
    
    <span class="comment">// ä½¿ç”¨ Mock è¿›è¡Œæµ‹è¯•</span>
    user, err := mockDB.<span class="function">GetUser</span>(1)
    assert.<span class="function">NoError</span>(t, err)
    assert.<span class="function">Equal</span>(t, <span class="string">"Alice"</span>, user.Name)
    
    err = mockDB.<span class="function">SaveUser</span>(&User{Name: <span class="string">"Bob"</span>})
    assert.<span class="function">NoError</span>(t, err)
    
    <span class="comment">// éªŒè¯æœŸæœ›</span>
    mockDB.<span class="function">AssertExpectations</span>(t)
}</code></pre>
            
            <h4>5. æµ‹è¯•å¥—ä»¶</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
    <span class="string">"github.com/stretchr/testify/suite"</span>
)

<span class="keyword">type</span> CalculatorTestSuite <span class="keyword">struct</span> {
    suite.Suite
    calc *Calculator
}

<span class="function">func</span> (suite *CalculatorTestSuite) <span class="function">SetupTest</span>() {
    <span class="comment">// æ¯ä¸ªæµ‹è¯•å‰æ‰§è¡Œ</span>
    suite.calc = <span class="function">NewCalculator</span>()
}

<span class="function">func</span> (suite *CalculatorTestSuite) <span class="function">TearDownTest</span>() {
    <span class="comment">// æ¯ä¸ªæµ‹è¯•åæ‰§è¡Œ</span>
    suite.calc = <span class="keyword">nil</span>
}

<span class="function">func</span> (suite *CalculatorTestSuite) <span class="function">SetupSuite</span>() {
    <span class="comment">// å¥—ä»¶å¼€å§‹å‰æ‰§è¡Œ</span>
}

<span class="function">func</span> (suite *CalculatorTestSuite) <span class="function">TearDownSuite</span>() {
    <span class="comment">// å¥—ä»¶ç»“æŸåæ‰§è¡Œ</span>
}

<span class="function">func</span> (suite *CalculatorTestSuite) <span class="function">TestAdd</span>() {
    result := suite.calc.<span class="function">Add</span>(2, 3)
    suite.<span class="function">Equal</span>(5, result)
}

<span class="function">func</span> (suite *CalculatorTestSuite) <span class="function">TestSubtract</span>() {
    result := suite.calc.<span class="function">Subtract</span>(5, 3)
    suite.<span class="function">Equal</span>(2, result)
}

<span class="function">func</span> <span class="function">TestCalculatorTestSuite</span>(t *testing.T) {
    suite.<span class="function">Run</span>(t, <span class="keyword">new</span>(CalculatorTestSuite))
}</code></pre>
            
            <h4>6. HTTP æµ‹è¯•</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"net/http"</span>
    <span class="string">"net/http/httptest"</span>
    <span class="string">"testing"</span>
    <span class="string">"github.com/stretchr/testify/assert"</span>
    <span class="string">"github.com/stretchr/testify/http"</span>
)

<span class="function">func</span> <span class="function">TestHTTPHandler</span>(t *testing.T) {
    <span class="comment">// åˆ›å»ºæµ‹è¯•æœåŠ¡å™¨</span>
    router := <span class="function">SetupRouter</span>()
    w := httptest.<span class="function">NewRecorder</span>()
    req, _ := http.<span class="function">NewRequest</span>(<span class="string">"GET"</span>, <span class="string">"/users/1"</span>, <span class="keyword">nil</span>)
    
    <span class="comment">// æ‰§è¡Œè¯·æ±‚</span>
    router.<span class="function">ServeHTTP</span>(w, req)
    
    <span class="comment">// æ–­è¨€å“åº”</span>
    assert.<span class="function">Equal</span>(t, http.StatusOK, w.Code)
    assert.<span class="function">JSONEq</span>(t, <span class="string">`{"id":1,"name":"Alice"}`</span>, w.Body.<span class="function">String</span>())
    
    <span class="comment">// ä½¿ç”¨ httpassert</span>
    http.<span class="function">AssertSuccess</span>(t, w.Code)
    http.<span class="function">AssertJSONPath</span>(t, w, <span class="string">"$.name"</span>, <span class="string">"Alice"</span>)
}</code></pre>
            
            <h3>æœ€ä½³å®è·µ</h3>
            
            <h4>1. æµ‹è¯•ç»„ç»‡</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
    <span class="string">"github.com/stretchr/testify/assert"</span>
)

<span class="comment">// ä½¿ç”¨å­æµ‹è¯•ç»„ç»‡æµ‹è¯•</span>
<span class="function">func</span> <span class="function">TestCalculator</span>(t *testing.T) {
    t.<span class="function">Run</span>(<span class="string">"Add"</span>, <span class="function">func</span>(t *testing.T) {
        calc := <span class="function">NewCalculator</span>()
        result := calc.<span class="function">Add</span>(2, 3)
        assert.<span class="function">Equal</span>(t, 5, result)
    })
    
    t.<span class="function">Run</span>(<span class="string">"Subtract"</span>, <span class="function">func</span>(t *testing.T) {
        calc := <span class="function">NewCalculator</span>()
        result := calc.<span class="function">Subtract</span>(5, 3)
        assert.<span class="function">Equal</span>(t, 2, result)
    })
}</code></pre>
            
            <h4>2. è¡¨é©±åŠ¨æµ‹è¯•</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
    <span class="string">"github.com/stretchr/testify/assert"</span>
)

<span class="function">func</span> <span class="function">TestAdd</span>(t *testing.T) {
    tests := []<span class="keyword">struct</span> {
        name     <span class="keyword">string</span>
        a, b     <span class="keyword">int</span>
        expected <span class="keyword">int</span>
    }{
        {<span class="string">"positive"</span>, 2, 3, 5},
        {<span class="string">"negative"</span>, -2, -3, -5},
        {<span class="string">"mixed"</span>, 2, -3, -1},
        {<span class="string">"zero"</span>, 0, 0, 0},
    }
    
    <span class="keyword">for</span> _, tt := <span class="keyword">range</span> tests {
        t.<span class="function">Run</span>(tt.name, <span class="function">func</span>(t *testing.T) {
            result := <span class="function">Add</span>(tt.a, tt.b)
            assert.<span class="function">Equal</span>(t, tt.expected, result, <span class="string">"Add(%d, %d) = %d; want %d"</span>, tt.a, tt.b, result, tt.expected)
        })
    }
}</code></pre>
            
            <h4>3. æµ‹è¯•è¦†ç›–ç‡</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
    <span class="string">"github.com/stretchr/testify/assert"</span>
)

<span class="comment">// æµ‹è¯•æ‰€æœ‰åˆ†æ”¯</span>
<span class="function">func</span> <span class="function">TestDivide</span>(t *testing.T) {
    <span class="comment">// æ­£å¸¸æƒ…å†µ</span>
    result, err := <span class="function">Divide</span>(10, 2)
    assert.<span class="function">Equal</span>(t, 5, result)
    assert.<span class="function">NoError</span>(t, err)
    
    <span class="comment">// é™¤é›¶é”™è¯¯</span>
    result, err = <span class="function">Divide</span>(10, 0)
    assert.<span class="function">Zero</span>(t, result)
    assert.<span class="function">Error</span>(t, err)
    
    <span class="comment">// è´Ÿæ•°é™¤æ³•</span>
    result, err = <span class="function">Divide</span>(-10, 2)
    assert.<span class="function">Equal</span>(t, -5, result)
    assert.<span class="function">NoError</span>(t, err)
}</code></pre>
            
            <h4>4. Mock æœ€ä½³å®è·µ</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
    <span class="string">"github.com/stretchr/testify/assert"</span>
    <span class="keyword">"github.com/stretchr/testify/mock"</span>
)

<span class="function">func</span> <span class="function">TestWithProperMocking</span>(t *testing.T) {
    mockDB := <span class="keyword">new</span>(MockDatabase)
    
    <span class="comment">// æ˜ç¡®è®¾ç½®æœŸæœ›</span>
    mockDB.<span class="function">On</span>(<span class="string">"GetUser"</span>, 1).<span class="function">Return</span>(&User{Name: <span class="string">"Alice"</span>}, <span class="keyword">nil</span>).<span class="function">Once</span>()
    
    <span class="comment">// æ‰§è¡Œæµ‹è¯•</span>
    user, err := mockDB.<span class="function">GetUser</span>(1)
    assert.<span class="function">NoError</span>(t, err)
    assert.<span class="function">Equal</span>(t, <span class="string">"Alice"</span>, user.Name)
    
    <span class="comment">// éªŒè¯æ‰€æœ‰æœŸæœ›éƒ½è¢«æ»¡è¶³</span>
    mockDB.<span class="function">AssertExpectations</span>(t)
    
    <span class="comment">// æµ‹è¯•é”™è¯¯æƒ…å†µ</span>
    mockDB.<span class="function">On</span>(<span class="string">"GetUser"</span>, 999).<span class="function">Return</span>(<span class="keyword">nil</span>, assert.AnError).<span class="function">Once</span>()
    
    user, err = mockDB.<span class="function">GetUser</span>(999)
    assert.<span class="function">Nil</span>(t, user)
    assert.<span class="function">Error</span>(t, err)
    
    mockDB.<span class="function">AssertExpectations</span>(t)
}</code></pre>
            
            <h4>5. æµ‹è¯•è¾…åŠ©å‡½æ•°</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"testing"</span>
    <span class="string">"github.com/stretchr/testify/assert"</span>
    <span class="string">"github.com/stretchr/testify/require"</span>
)

<span class="comment">// è¾…åŠ©å‡½æ•°åˆ›å»ºæµ‹è¯•æ•°æ®</span>
<span class="function">func</span> <span class="function">createTestUser</span>(name <span class="keyword">string</span>, age <span class="keyword">int</span>) *User {
    <span class="keyword">return</span> &User{
        Name: name,
        Age:  age,
        ID:   <span class="function">generateTestID</span>(),
    }
}

<span class="function">func</span> <span class="function">generateTestID</span>() <span class="keyword">int</span> {
    <span class="keyword">return</span> 42
}

<span class="function">func</span> <span class="function">TestWithHelpers</span>(t *testing.T) {
    <span class="comment">// ä½¿ç”¨ require ç«‹å³å¤±è´¥</span>
    user := <span class="function">createTestUser</span>(<span class="string">"Alice"</span>, 30)
    require.<span class="function">NotNil</span>(t, user)
    
    <span class="comment">// ä½¿ç”¨ assert ç»§ç»­æ‰§è¡Œ</span>
    assert.<span class="function">Equal</span>(t, <span class="string">"Alice"</span>, user.Name)
    assert.<span class="function">Equal</span>(t, 30, user.Age)
}</code></pre>
            
            <h3>ä½¿ç”¨åœºæ™¯</h3>
            <ul>
                <li><strong>å•å…ƒæµ‹è¯•</strong>ï¼šç¼–å†™ç®€æ´æ˜“è¯»çš„å•å…ƒæµ‹è¯•</li>
                <li><strong>é›†æˆæµ‹è¯•</strong>ï¼šä½¿ç”¨ Mock å¯¹è±¡éš”ç¦»ä¾èµ–</li>
                <li><strong>API æµ‹è¯•</strong>ï¼šæµ‹è¯• HTTP API çš„å“åº”</li>
                <li><strong>æ•°æ®åº“æµ‹è¯•</strong>ï¼šä½¿ç”¨ Mock æ•°æ®åº“è¿›è¡Œæµ‹è¯•</li>
                <li><strong>å¹¶å‘æµ‹è¯•</strong>ï¼šæµ‹è¯•å¹¶å‘åœºæ™¯å’Œç«æ€æ¡ä»¶</li>
            </ul>
            
            <h3>æ³¨æ„äº‹é¡¹</h3>
            <ul>
                <li>Mock å¯¹è±¡åº”è¯¥æ˜ç¡®è®¾ç½®æœŸæœ›å’Œè¿”å›å€¼</li>
                <li>ä½¿ç”¨ require æ–­è¨€ç«‹å³å¤±è´¥ï¼Œä½¿ç”¨ assert æ–­è¨€ç»§ç»­æ‰§è¡Œ</li>
                <li>æµ‹è¯•åº”è¯¥ç‹¬ç«‹ï¼Œä¸ä¾èµ–æ‰§è¡Œé¡ºåº</li>
                <li>æµ‹è¯•åº”è¯¥å¿«é€Ÿï¼Œé¿å…ä½¿ç”¨ sleep ç­‰å»¶è¿Ÿ</li>
                <li>ä½¿ç”¨è¡¨é©±åŠ¨æµ‹è¯•æé«˜æµ‹è¯•è¦†ç›–ç‡</li>
                <li>å®šæœŸæ£€æŸ¥æµ‹è¯•è¦†ç›–ç‡ï¼Œç¡®ä¿ä»£ç è´¨é‡</li>
            </ul>
            </div>

            <h2 id="gods">GoDS æ•°æ®ç»“æ„</h2>
            <p>GoDSï¼ˆGo Data Structuresï¼‰æ˜¯ä¸€ä¸ªçº¯ Go è¯­è¨€å®ç°çš„ã€é«˜æ€§èƒ½çš„å¼€æºæ•°æ®ç»“æ„å’Œç®—æ³•åº“ã€‚å®ƒæä¾›äº†ä¸°å¯Œçš„æ•°æ®ç»“æ„ï¼Œå¦‚é“¾è¡¨ã€æ ˆã€é˜Ÿåˆ—ã€é›†åˆã€æ ‘ã€å †ã€å“ˆå¸Œè¡¨ç­‰ï¼Œä»¥åŠå¤šç§ç®—æ³•å®ç°ã€‚GoDS çš„è®¾è®¡ç›®æ ‡æ˜¯æä¾›ä¸ Go æ ‡å‡†åº“å…¼å®¹çš„ APIï¼ŒåŒæ—¶æä¾›æ›´å¥½çš„æ€§èƒ½å’Œæ›´ä¸°å¯Œçš„åŠŸèƒ½ã€‚</p>
            
            <h3>æ ¸å¿ƒç‰¹æ€§</h3>
            <ul>
                <li><strong>ä¸°å¯Œçš„æ•°æ®ç»“æ„</strong>ï¼šæä¾›é“¾è¡¨ã€æ ˆã€é˜Ÿåˆ—ã€é›†åˆã€æ ‘ã€å †ã€å“ˆå¸Œè¡¨ç­‰</li>
                <li><strong>é«˜æ€§èƒ½</strong>ï¼šä¼˜åŒ–çš„å®ç°ï¼Œæ€§èƒ½ä¼˜äºæ ‡å‡†åº“</li>
                <li><strong>å†…å­˜é«˜æ•ˆ</strong>ï¼šä½¿ç”¨å†…å­˜æ± å’Œå¯¹è±¡æ± å‡å°‘å†…å­˜åˆ†é…</li>
                <li><strong>å¹¶å‘å®‰å…¨</strong>ï¼šæä¾›å¹¶å‘å®‰å…¨çš„æ•°æ®ç»“æ„å®ç°</li>
                <li><strong>åºåˆ—åŒ–æ”¯æŒ</strong>ï¼šæ”¯æŒ JSONã€Gob ç­‰åºåˆ—åŒ–æ ¼å¼</li>
                <li><strong>ç±»å‹å®‰å…¨</strong>ï¼šä½¿ç”¨æ³›å‹æä¾›ç±»å‹å®‰å…¨çš„ API</li>
            </ul>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get github.com/emirpasic/gods/v2</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/emirpasic/gods/v2/list"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºé“¾è¡¨</span>
    l := list.<span class="function">New</span>()
    l.<span class="function">PushBack</span>(1)
    l.<span class="function">PushBack</span>(2)
    l.<span class="function">PushBack</span>(3)
    
    <span class="comment">// éå†é“¾è¡¨</span>
    it := l.<span class="function">Front</span>()
    <span class="keyword">for</span> it.<span class="function">Next</span>() {
        fmt.<span class="function">Println</span>(it.<span class="function">Value</span>())
    }
}</code></pre>
            
            <h3>å¸¸ç”¨æ•°æ®ç»“æ„</h3>
            
            <h4>1. é“¾è¡¨ï¼ˆListï¼‰</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/emirpasic/gods/v2/list"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºé“¾è¡¨</span>
    l := list.<span class="function">New</span>()
    
    <span class="comment">// æ·»åŠ å…ƒç´ </span>
    l.<span class="function">PushBack</span>(1)
    l.<span class="function">PushFront</span>(0)
    l.<span class="function">PushBack</span>(2)
    
    <span class="comment">// è®¿é—®å…ƒç´ </span>
    fmt.<span class="function">Println</span>(<span class="string">"Front:"</span>, l.<span class="function">Front</span>().<span class="function">Value</span>())
    fmt.<span class="function">Println</span>(<span class="string">"Back:"</span>, l.<span class="function">Back</span>().<span class="function">Value</span>())
    
    <span class="comment">// ç§»é™¤å…ƒç´ </span>
    l.<span class="function">Remove</span>(l.<span class="function">Front</span>())
    
    <span class="comment">// éå†</span>
    <span class="keyword">for</span> it := l.<span class="function">Front</span>(); it != <span class="keyword">nil</span>; it = it.<span class="function">Next</span>() {
        fmt.<span class="function">Println</span>(it.<span class="function">Value</span>())
    }
}</code></pre>
            
            <h4>2. æ ˆï¼ˆStackï¼‰</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/emirpasic/gods/v2/stack"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºæ ˆ</span>
    s := stack.<span class="function">New</span>()
    
    <span class="comment">// å…¥æ ˆ</span>
    s.<span class="function">Push</span>(1)
    s.<span class="function">Push</span>(2)
    s.<span class="function">Push</span>(3)
    
    <span class="comment">// æŸ¥çœ‹æ ˆé¡¶</span>
    <span class="keyword">if</span> top, ok := s.<span class="function">Peek</span>(); ok {
        fmt.<span class="function">Println</span>(<span class="string">"Top:"</span>, top)
    }
    
    <span class="comment">// å‡ºæ ˆ</span>
    <span class="keyword">if</span> value, ok := s.<span class="function">Pop</span>(); ok {
        fmt.<span class="function">Println</span>(<span class="string">"Popped:"</span>, value)
    }
    
    <span class="comment">// æ£€æŸ¥æ ˆæ˜¯å¦ä¸ºç©º</span>
    fmt.<span class="function">Println</span>(<span class="string">"Empty:"</span>, s.<span class="function">Empty</span>())
}</code></pre>
            
            <h4>3. é˜Ÿåˆ—ï¼ˆQueueï¼‰</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/emirpasic/gods/v2/queue"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºé˜Ÿåˆ—</span>
    q := queue.<span class="function">New</span>()
    
    <span class="comment">// å…¥é˜Ÿ</span>
    q.<span class="function">Enqueue</span>(1)
    q.<span class="function">Enqueue</span>(2)
    q.<span class="function">Enqueue</span>(3)
    
    <span class="comment">// æŸ¥çœ‹é˜Ÿé¦–</span>
    <span class="keyword">if</span> front, ok := q.<span class="function">Peek</span>(); ok {
        fmt.<span class="function">Println</span>(<span class="string">"Front:"</span>, front)
    }
    
    <span class="comment">// å‡ºé˜Ÿ</span>
    <span class="keyword">if</span> value, ok := q.<span class="function">Dequeue</span>(); ok {
        fmt.<span class="function">Println</span>(<span class="string">"Dequeued:"</span>, value)
    }
    
    <span class="comment">// æ£€æŸ¥é˜Ÿåˆ—å¤§å°</span>
    fmt.<span class="function">Println</span>(<span class="string">"Size:"</span>, q.<span class="function">Size</span>())
}</code></pre>
            
            <h4>4. é›†åˆï¼ˆSetï¼‰</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/emirpasic/gods/v2/hashset"</span>
)

<span class="function">func</span> <span class="function">main</span> {
    <span class="comment">// åˆ›å»ºé›†åˆ</span>
    set := hashset.<span class="function">New</span>()
    
    <span class="comment">// æ·»åŠ å…ƒç´ </span>
    set.<span class="function">Add</span>(1)
    set.<span class="function">Add</span>(2)
    set.<span class="function">Add</span>(3)
    
    <span class="comment">// æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨</span>
    fmt.<span class="function">Println</span>(<span class="string">"Contains 2:"</span>, set.<span class="function">Contains</span>(2))
    
    <span class="comment">// ç§»é™¤å…ƒç´ </span>
    set.<span class="function">Remove</span>(2)
    
    <span class="comment">// éå†é›†åˆ</span>
    set.<span class="function">Each</span>(<span class="function">func</span>(value <span class="keyword">interface</span>{}) <span class="keyword">bool</span> {
        fmt.<span class="function">Println</span>(value)
        <span class="keyword">return</span> <span class="keyword">true</span>
    })
}</code></pre>
            
            <h4>5. æ ‘ï¼ˆTreeï¼‰</h4>
pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"github.com/emirpasic/gods/v2/treemap"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºæ ‘å½¢æ˜ å°„</span>
    tree := treemap.<span class="function">NewWithStringComparator</span>()
    
    <span class="comment">// æ·»åŠ é”®å€¼å¯¹</span>
    tree.<span class="function">Put</span>(<span class="string">"a"</span>, 1)
    tree.<span class="function">Put</span>(<span class="string">"b"</span>, 2)
    tree.<span class="function">Put</span>(<span class="string">"c"</span>, 3)
    
    <span class="comment">// è·å–å€¼</span>
    <span class="keyword">if</span> value, ok := tree.<span class="function">Get</span>(<span class="string">"b"</span>); ok {
        fmt.<span class="function">Println</span>(<span class="string">"Value for 'b':"</span>, value)
    }
    
    <span class="comment">// éå†æ ‘</span>
    it := tree.<span class="function">Iterator</span>()
    <span class="keyword">for</span> it.<span class="function">Begin</span>(); it.<span class="function">End</span>(); it.<span class="function">Next</span>()() {
        key, value := it.<span class="function">Key</span>(), it.<span class="function">Value</span>()
        fmt.<span class="function">Printf</span>(<span class="string">"%s: %v\n"</span>, key, value)
    }
}</code></pre>
            
            <h4>6. å †ï¼ˆHeapï¼‰</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"container/heap"</span>
    <span class="string">"github.com/emirpasic/gods/v2/treemap"</span>
)

<span class="keyword">type</span> IntHeap []<span class="keyword">int</span>

<span class="function">func</span> (h IntHeap) <span class="function">Len</span>() <span class="keyword">int</span>           { <span class="keyword">return</span> <span class="function">len</span>(h) }
<span class="function">func</span> (h IntHeap) <span class="function">Less</span>(i, j <span class="keyword">int</span>) <span class="keyword">bool</span> { <span class="keyword">return</span> h[i] < h[j] }
<span class="function">func</span> (h IntHeap) <span class="function">Swap</span>(i, j <span class="keyword">int</span>)      { h[i], h[j] = h[j], h[i] }
<span class="function">func</span> (h IntHeap) <span class="function">Push</span>(x <span class="keyword">int</span>)      { heap.<span class="function">Push</span>(h, x) }
<span class="function">func</span> (h *IntHeap) <span class="function">Pop</span>() <span class="keyword">int</span>     { <span class="keyword">return</span> heap.<span class="function">Pop</span>(h) }

<span class="function">func</span> <span class="function">main</span>() {
    h := &IntHeap{3, 1, 4, 1, 5, 9}
    heap.<span class="function">Init</span>(h)
    
    <span class="comment">// å¼¹å‡ºæœ€å°å€¼</span>
    <span class="keyword">for</span> h.<span class="function">Len</span>() > 0 {
        fmt.<span class="function">Println</span>(heap.<span class="function">Pop</span>(h))
    }
}</code></pre>
            
            <h3>é«˜çº§åŠŸèƒ½</h3>
            
            <h4>1. å¹¶å‘å®‰å…¨çš„æ•°æ®ç»“æ„</h4>
            <pre><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sync"</span>
    <span class="string">"github.com/emirpasic/gods/v2/list"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºå¹¶å‘å®‰å…¨çš„é“¾è¡¨</span>
    l := list.<span class="function">New</span>()
    <span class="keyword">var</span> mu sync.Mutex
    
    <span class="comment">// å¹¶å‘æ“ä½œ</span>
    <span class="keyword">for</span> i := 0; i < 10; i++ {
        <span class="keyword">go</span> <span class="function">func</span>(n <span class="keyword">int</span>) {
            mu.<span class="function">Lock</span>()
            <span class="keyword">defer</span> mu.<span class="function">Unlock</span>()
            l.<span class="function">PushBack</span>(n)
        }(i)
    }
}</code></pre>
            
            <h4>2. è‡ªå®šä¹‰æ¯”è¾ƒå™¨</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/emirpasic/gods/v2/treemap"</span>
    <span class="string">"github.com/emirpasic/gods/v2/utils"</span>
)

<span class="keyword">type</span> User <span class="keyword">struct</span> {
    Name <span class="keyword">string</span>
    Age  <span class="keyword">int</span>
}

<span class="comment">// è‡ªå®šä¹‰æ¯”è¾ƒå™¨</span>
<span class="keyword">type</span> ByAge <span class="keyword">struct</span>{ users []*User }

<span class="function">func</span> (a ByAge) <span class="function">Len</span>() <span class="keyword">int</span> <span class="keyword">return</span> <span class="function">len</span>(a.users) }
<span class="function">func</span> (a ByAge) <span class="function">Less</span>(i, j <span class="keyword">int</span>) <span class="keyword">bool</span> <span class="keyword">return</span> a.users[i].Age < a.users[j].Age }
<span class="function">func</span> (a ByAge) <span class="function">Swap</span>(i, j <span class="keyword">int</span>)      { a.users[i], a.users[j] = a.users[j], a.users[i] }

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// ä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒå™¨åˆ›å»ºæ ‘</span>
    tree := treemap.<span class="function">NewWith</span>(utils.<span class="function">Comparator</span>(<span class="keyword">func</span>(a, b <span class="keyword">interface</span>{}) <span class="keyword">int</span> {
        return a.(<span class="keyword">int</span>) - b.(<span class="keyword">int</span>)
    }))
    
    tree.<span class="function">Put</span>(10, <span class="string">"ten"</span>)
    tree.<span class="function">Put</span>(5, <span class="string">"five"</span>)
}</code></pre>
            
            <h4>3. åºåˆ—åŒ–</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"encoding/json"</span>
    <span class="string">"fmt"</span>
    <span class="string">"github.com/emirpasic/gods/v2/list"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    l := list.<span class="function">New</span>()
    l.<span class="function">PushBack</span>(1)
    l.<span class="function">PushBack</span>(2)
    l.<span class="function">PushBack</span>(3)
    
    <span class="comment">// è½¬æ¢ä¸ºåˆ‡ç‰‡</span>
    values := l.<span class="function">Values</span>()
    
    <span class="comment">// JSON åºåˆ—åŒ–</span>
    data, _ := json.<span class="function">Marshal</span>(values)
    fmt.<span class="function">Println</span>(<span class="function">String</span>(data))
}</code></pre>
            
            <h3>æœ€ä½³å®è·µ</h3>
            
            <h4>1. é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/emirpasic/gods/v2/list"</span>
    <span class="string">"github.com/emirpasic/gods/v2/hashmap"</span>
    <span class="string">"github.com/emirpasic/gods/v2/hashset"</span>
)

<span class="function">func</span> <span class="function">chooseDataStructure</span>() {
    <span class="comment">// é¢‘ç¹çš„æ’å…¥å’Œåˆ é™¤ - ä½¿ç”¨é“¾è¡¨</span>
    l := list.<span class="function">New</span>()
    
    <span class="comment">// éœ€è¦å¿«é€ŸæŸ¥æ‰¾ - ä½¿ç”¨å“ˆå¸Œè¡¨</span>
    m := hashmap.<span><span class="function">New</span>()
    
    <span class="comment">// éœ€è¦å”¯ä¸€å…ƒç´  - ä½¿ç”¨é›†åˆ</span>
    s := hashset.<span class="function">New</span>()
    
    <span class="comment">// éœ€è¦æ’åº - ä½¿ç”¨æ ‘</span>
}</code></pre>
            
            <h4>2. å†…å­˜ç®¡ç†</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/emirpasic/gods/v2/list"</span>
)

<span class="function">func</span> <span class="function">manageMemory</span>() {
    l := list.<span class="function">New</span>()
    
    <span class="comment">// åŠæ—¶æ¸…ç†ä¸éœ€è¦çš„å…ƒç´ </span>
    <span class="keyword">for</span> l.<span class="function">Size</span>() > 1000 {
        l.<span class="function">Remove</span>(l.<span class="function">Front</span>())
    }
    
    <span class="comment">// ä½¿ç”¨è¿­ä»£å™¨é¿å…åˆ›å»ºä¸å¿…è¦çš„åˆ‡ç‰‡</span>
    <span class="keyword">for</span> it := l.<span class="function">Front</span>(); it != <span class="keyword">nil</span>; it = it.<span class="function">Next</span>() {
        _ = it.<span class="function">Value</span>()
    }
}</code></pre>
            
            <h4>3. æ€§èƒ½ä¼˜åŒ–</h4>
é¢„è®¡ç®—å®¹é‡ï¼š
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/emirpasic/gods/v2/hashmap"</span>
)

<span class="function</span> <span class="keyword">func</span> <span class="function">optimizePerformance</span>() {
    <span class="comment">// é¢„åˆ†é…å®¹é‡</span>
    m := hashmap.<span class="function">New</span>()
    m.<span class="function">Resize</span>(1000)
    
    <span class="span class="comment">// æ‰¹é‡æ“ä½œ</span>
    <span class="keyword">for</span> i := 0; i < 1000; i++ {
        m.<span class="function">Put</span>(i, i*2)
    }
}</code></pre>
            
            <h4>4. è¿­ä»£å™¨ä½¿ç”¨</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/emirpasic/gods/v2/list"</span>
)

<span class="function">func</span> <span class="function">useIterator</span>() {
    l := list.<span class="function">New</span>()
    l.<span class="function">PushBack</span>(1)
    l.<span class="function">PushBack</span>(2)
    l.<span class="function">PushBack</span>(3)
    
    <span class="comment">// æ­£å‘è¿­ä»£</span>
    <span class="keyword">for</span> it := l.<span class="function">Front</span>(); it != <span class="keyword">nil</span>(); it = it.<span class="function">Next</span>()() {
        _ = it.<span class="function">Value</span>()
    }
    
    <span class="comment">// åå‘è¿­ä»£</span>
    <span class="keyword">for</span> it := l.<span class="function">Back</span>(); it != <span class="keyword">nil</span>(); it = it.<span class="function">Prev</span>()() {
        _ = it.<span class="function">Value</span>()
    }
}</code></pre>
            
            <h4>5. ä¸æ ‡å‡†åº“å¯¹æ¯”</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"container/list"</span>
    <span class="string">"github.com/emirpasic/gods/v2/list"</span>
)

<span class="function">func</span> <span class="function">compareWithStdLib</span>() {
    <span class="comment">// æ ‡å‡†åº“é“¾è¡¨</span>
    stdList := list.<span class="function">New</span>()
    stdList.<span class="function">PushBack</span>(1)
    
    <span class="comment">// GoDS é“¾è¡¨</span>
    godsList := list.<span class="function">New</span>()
    godsList.<span class="function">PushBack</span>(1)
    
    <span class="comment">// GoDS æä¾›äº†æ›´ä¸°å¯Œçš„åŠŸèƒ½</span>
    <span class="comment">// å¦‚ï¼šValues()ã€Each()ã€Select() ç­‰</span>
}</code></pre>
            
            <h3>ä½¿ç”¨åœºæ™¯</h3>
            <ul>
                <li><strong>ç®—æ³•å®ç°</strong>ï¼šå®ç°å„ç§ç®—æ³•å¦‚æ’åºã€æœç´¢ã€å›¾ç®—æ³•</li>
                <li><strong>ç¼“å­˜ç³»ç»Ÿ</strong>ï¼šä½¿ç”¨ LRU ç¼“å­˜ç­‰æ•°æ®ç»“æ„</li>
                <li><strong>ä»»åŠ¡é˜Ÿåˆ—</span>ï¼šä½¿ç”¨é˜Ÿåˆ—å’Œæ ˆç®¡ç†ä»»åŠ¡</li>
                <li><strong>æ•°æ®å»é‡</span>ï¼šä½¿ç”¨é›†åˆè¿›è¡Œæ•°æ®å»é‡</span>
                <li><strong>äº‹ä»¶å¤„ç†</span>ï¼šä½¿ç”¨é˜Ÿåˆ—å¤„ç†äº‹ä»¶æµ</li>
            </ul>
            
            <h3>æ³¨æ„äº‹é¡¹</h3>
            <ul>
                <li>æ ¹æ®ä½¿ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„</li>
                <li>æ³¨æ„å†…å­˜ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¤§å‹æ•°æ®é›†</li>
                <li>å¹¶å‘ç¯å¢ƒä¸­ä½¿ç”¨é€‚å½“çš„åŒæ­¥æœºåˆ¶</li>
                <li>GoDS çš„ API ä¸æ ‡å‡†åº“ä¸åŒï¼Œéœ€è¦é€‚åº”</li>
                <li>å®šæœŸæ£€æŸ¥æ€§èƒ½ï¼Œç¡®ä¿é€‰æ‹©çš„æ•°æ®ç»“æ„åˆé€‚</li>
                <li>æ³¨æ„è¿­ä»£å™¨çš„ä½¿ç”¨ï¼Œé¿å…åœ¨è¿­ä»£æ—¶ä¿®æ”¹æ•°æ®ç»“æ„</li>
            </ul>
            </div>

            <h2 id="gg">gg å›¾å½¢åº“</h2>
            <p>gg æ˜¯ä¸€ä¸ªçº¯ Go è¯­è¨€å®ç°çš„é«˜æ€§èƒ½ 2D å›¾å½¢åº“ï¼Œæä¾›äº†ä¸°å¯Œçš„ç»˜å›¾åŠŸèƒ½ï¼ŒåŒ…æ‹¬è·¯å¾„ç»˜åˆ¶ã€å›¾åƒå¤„ç†ã€æ–‡æœ¬æ¸²æŸ“ã€å˜æ¢ã€æ¸å˜ã€é€æ˜åº¦ç­‰ã€‚gg çš„è®¾è®¡ç›®æ ‡æ˜¯æä¾›ç®€å•æ˜“ç”¨ã€æ€§èƒ½ä¼˜ç§€çš„ 2D å›¾å½¢å¤„ç†èƒ½åŠ›ï¼Œé€‚ç”¨äºæ•°æ®å¯è§†åŒ–ã€æ¸¸æˆå¼€å‘ã€å›¾åƒå¤„ç†ç­‰åœºæ™¯ã€‚</p>
            
            <h3>æ ¸å¿ƒç‰¹æ€§</h3>
            <ul>
                <li><strong>çº¯ Go å®ç°</strong>ï¼šä¸ä¾èµ–ä»»ä½•å¤–éƒ¨ C åº“ï¼Œå®Œå…¨ç”¨ Go è¯­è¨€å®ç°</li>
                <li><strong>é«˜æ€§èƒ½</strong>ï¼šä¼˜åŒ–çš„æ¸²æŸ“å¼•æ“ï¼Œæ”¯æŒç¡¬ä»¶åŠ é€Ÿ</li>
                <li><strong>ä¸°å¯Œçš„ç»˜å›¾åŠŸèƒ½</strong>ï¼šæ”¯æŒè·¯å¾„ã€å½¢çŠ¶ã€æ–‡æœ¬ã€å›¾åƒç­‰</li>
                <li><strong>å˜æ¢æ”¯æŒ</strong>ï¼šæ”¯æŒå¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾ç­‰å˜æ¢</li>
                <li><strong>æ¸å˜å’Œé€æ˜åº¦</strong>ï¼šæ”¯æŒçº¿æ€§æ¸å˜ã€å¾„å‘æ¸å˜ã€é€æ˜åº¦</li>
                <li><strong>å¤šç§è¾“å‡ºæ ¼å¼</strong>ï¼šæ”¯æŒ PNGã€JPEGã€GIFã€TIFF ç­‰æ ¼å¼</li>
                <li><strong>å­—ä½“æ”¯æŒ</strong>ï¼šæ”¯æŒ TrueType å’Œ OpenType å­—ä½“</li>
            </ul>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get github.com/fogleman/gg</code></pre>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»º 800x600 çš„ç”»å¸ƒ</span>
    dc := gg.<span class="function">NewContext</span>(800, 600)
    
    <span class="comment">// è®¾ç½®èƒŒæ™¯è‰²</span>
    dc.<span class="function">SetRGB</span>(1, 1, 1)
    dc.<span class="function">Clear</span>()
    
    <span class="comment">// ç»˜åˆ¶çº¢è‰²çŸ©å½¢</span>
    dc.<span class="function">SetRGB255</span>(255, 0, 0)
    dc.<span class="function">DrawRectangle</span>(100, 100, 200, 150)
    dc.<span class="function">Fill</span>()
    
    <span class="comment">// ä¿å­˜ä¸º PNG</span>
    dc.<span class="function">SavePNG</span>(<span class="string">"output.png"</span>)
}</code></pre>
            
            <h3>å¸¸ç”¨åŠŸèƒ½</h3>
            
            <h4>1. åŸºæœ¬å½¢çŠ¶ç»˜åˆ¶</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    dc := gg.<span class="function">NewContext</span>(800, 600)
    dc.<span class="function">SetRGB</span>(1, 1, 1)
    dc.<span class="function">Clear</span>()
    
    <span class="comment">// ç»˜åˆ¶çŸ©å½¢</span>
    dc.<span class="function">SetRGB255</span>(255, 0, 0)
    dc.<span class="function">DrawRectangle</span>(50, 50, 200, 150)
    dc.<span class="function">Fill</span>()
    
    <span class="comment">// ç»˜åˆ¶åœ†å½¢</span>
    dc.<span class="function">SetRGB255</span>(0, 255, 0)
    dc.<span class="function">DrawCircle</span>(400, 300, 100)
    dc.<span class="function">Fill</span>()
    
    <span class="comment">// ç»˜åˆ¶æ¤­åœ†</span>
    dc.<span class="function">SetRGB255</span>(0, 0, 255)
    dc.<span class="function">DrawEllipse</span>(600, 200, 100, 50)
    dc.<span class="function">Fill</span>()
    
    <span class="comment">// ç»˜åˆ¶çº¿æ¡</span>
    dc.<span class="function">SetRGB255</span>(0, 0, 0)
    dc.<span class="function">SetLineWidth</span>(5)
    dc.<span class="function">DrawLine</span>(50, 400, 750, 400)
    dc.<span class="function">Stroke</span>()
    
    dc.<span class="function">SavePNG</span>(<span class="string">"shapes.png"</span>)
}</code></pre>
            
            <h4>2. è·¯å¾„ç»˜åˆ¶</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    dc := gg.<span class="function">NewContext</span>(800, 600)
    dc.<span class="function">SetRGB</span>(1, 1, 1)
    dc.<span class="function">Clear</span>()
    
    <span class="comment">// ç»˜åˆ¶å¤šè¾¹å½¢è·¯å¾„</span>
    dc.<span class="function">SetRGB255</span>(255, 0, 0)
    dc.<span class="function">MoveTo</span>(100, 100)
    dc.<span class="function">LineTo</span>(200, 50)
    dc.<span class="function">LineTo</span>(300, 100)
    dc.<span class="function">LineTo</span>(300, 200)
    dc.<span class="function">LineTo</span>(200, 250)
    dc.<span class="function">LineTo</span>(100, 200)
    dc.<span class="function">ClosePath</span>()
    dc.<span class="function">Fill</span>()
    
    <span class="comment">// ç»˜åˆ¶è´å¡å°”æ›²çº¿</span>
    dc.<span class="function">SetRGB255</span>(0, 0, 255)
    dc.<span class="function">SetLineWidth</span>(3)
    dc.<span class="function">MoveTo</span>(400, 300)
    dc.<span class="function">QuadCurveTo</span>(500, 200, 600, 300)
    dc.<span class="function">CubicCurveTo</span>(650, 350, 700, 250, 750, 300)
    dc.<span class="function">Stroke</span>()
    
    dc.<span class="function">SavePNG</span>(<span class="string">"paths.png"</span>)
}</code></pre>
            
            <h4>3. æ–‡æœ¬æ¸²æŸ“</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    dc := gg.<span class="function">NewContext</span>(800, 600)
    dc.<span class="function">SetRGB</span>(1, 1, 1)
    dc.<span class="function">Clear</span>()
    
    <span class="comment">// åŠ è½½å­—ä½“</span>
    <span class="keyword">if</span> err := dc.<span class="function">LoadFontFace</span>(<span class="string">"arial.ttf"</span>, 48); err != <span class="keyword">nil</span> {
        <span class="keyword">panic</span>(err)
    }
    
    <span class="comment">// ç»˜åˆ¶æ–‡æœ¬</span>
    dc.<span class="function">SetRGB255</span>(0, 0, 0)
    dc.<span class="function">DrawString</span>(<span class="string">"Hello, gg!"</span>, 100, 100)
    
    <span class="comment">// ç»˜åˆ¶å¸¦é˜´å½±çš„æ–‡æœ¬</span>
    dc.<span class="function">SetRGB255</span>(200, 200, 200)
    dc.<span class="function">DrawString</span>(<span class="string">"Shadow Text"</span>, 102, 202)
    dc.<span class="function">SetRGB255</span>(0, 0, 0)
    dc.<span class="function">DrawString</span>(<span class="string">"Shadow Text"</span>, 100, 200)
    
    <span class="comment">// ç»˜åˆ¶æ—‹è½¬çš„æ–‡æœ¬</span>
    dc.<span class="function">Push</span>()
    dc.<span class="function">RotateAbout</span>(gg.<span class="function">Radians</span>(45), 400, 400)
    dc.<span class="function">SetRGB255</span>(255, 0, 0)
    dc.<span class="function">DrawString</span>(<span class="string">"Rotated Text"</span>, 350, 400)
    dc.<span class="function">Pop</span>()
    
    dc.<span class="function">SavePNG</span>(<span class="string">"text.png"</span>)
}</code></pre>
            
            <h4>4. å›¾åƒå¤„ç†</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    dc := gg.<span class="function">NewContext</span>(800, 600)
    dc.<span class="function">SetRGB</span>(1, 1, 1)
    dc.<span class="function">Clear</span>()
    
    <span class="comment">// åŠ è½½å›¾åƒ</span>
    img, err := gg.<span class="function">LoadImage</span>(<span class="string">"input.png"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">panic</span>(err)
    }
    
    <span class="comment">// ç»˜åˆ¶å›¾åƒï¼ˆåŸå§‹å¤§å°ï¼‰</span>
    dc.<span class="function">DrawImage</span>(img, 50, 50)
    
    <span class="comment">// ç»˜åˆ¶ç¼©æ”¾åçš„å›¾åƒ</span>
    dc.<span class="function">DrawImageAnchored</span>(img, 400, 300, 0.5, 0.5)
    
    <span class="comment">// ç»˜åˆ¶æ—‹è½¬åçš„å›¾åƒ</span>
    dc.<span class="function">Push</span>()
    dc.<span class="function">RotateAbout</span>(gg.<span class="function">Radians</span>(30), 600, 400)
    dc.<span class="function">DrawImageAnchored</span>(img, 600, 400, 0.5, 0.5)
    dc.<span class="function">Pop</span>()
    
    dc.<span class="function">SavePNG</span>(<span class="string">"image.png"</span>)
}</code></pre>
            
            <h4>5. æ¸å˜å’Œé€æ˜åº¦</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    dc := gg.<span class="function">NewContext</span>(800, 600)
    dc.<span class="function">SetRGB</span>(1, 1, 1)
    dc.<span class="function">Clear</span>()
    
    <span class="comment">// çº¿æ€§æ¸å˜</span>
    gradient := gg.<span class="function">NewLinearGradient</span>(0, 0, 400, 400)
    gradient.<span class="function">AddColorStop</span>(0, gg.<span class="function">NewRGBA</span>(255, 0, 0, 255))
    gradient.<span class="function">AddColorStop</span>(1, gg.<span class="function">NewRGBA</span>(0, 0, 255, 255))
    dc.<span class="function">SetFillStyle</span>(gradient)
    dc.<span class="function">DrawRectangle</span>(50, 50, 300, 300)
    dc.<span class="function">Fill</span>()
    
    <span class="comment">// å¾„å‘æ¸å˜</span>
    radial := gg.<span class="function">NewRadialGradient</span>(600, 300, 0, 600, 300, 150)
    radial.<span class="function">AddColorStop</span>(0, gg.<span class="function">NewRGBA</span>(255, 255, 0, 255))
    radial.<span class="function">AddColorStop</span>(1, gg.<span class="function">NewRGBA</span>(255, 0, 0, 255))
    dc.<span class="function">SetFillStyle</span>(radial)
    dc.<span class="function">DrawCircle</span>(600, 300, 150)
    dc.<span class="function">Fill</span>()
    
    <span class="comment">// é€æ˜åº¦</span>
    dc.<span class="function">SetRGBA255</span>(0, 255, 0, 128)
    dc.<span class="function">DrawRectangle</span>(100, 400, 200, 150)
    dc.<span class="function">Fill</span>()
    
    dc.<span class="function">SavePNG</span>(<span class="string">"gradient.png"</span>)
}</code></pre>
            
            <h4>6. å˜æ¢æ“ä½œ</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    dc := gg.<span class="function">NewContext</span>(800, 600)
    dc.<span class="function">SetRGB</span>(1, 1, 1)
    dc.<span class="function">Clear</span>()
    
    <span class="comment">// å¹³ç§»</span>
    dc.<span class="function">Push</span>()
    dc.<span class="function">Translate</span>(100, 100)
    dc.<span class="function">SetRGB255</span>(255, 0, 0)
    dc.<span class="function">DrawRectangle</span>(0, 0, 100, 100)
    dc.<span class="function">Fill</span>()
    dc.<span class="function">Pop</span>()
    
    <span class="comment">// æ—‹è½¬</span>
    dc.<span class="function">Push</span>()
    dc.<span class="function">Translate</span>(300, 300)
    dc.<span class="function">Rotate</span>(gg.<span class="function">Radians</span>(45))
    dc.<span class="function">SetRGB255</span>(0, 255, 0)
    dc.<span class="function">DrawRectangle</span>(-50, -50, 100, 100)
    dc.<span class="function">Fill</span>()
    dc.<span class="function">Pop</span>()
    
    <span class="comment">// ç¼©æ”¾</span>
    dc.<span class="function">Push</span>()
    dc.<span class="function">Translate</span>(500, 400)
    dc.<span class="function">Scale</span>(2, 0.5)
    dc.<span class="function">SetRGB255</span>(0, 0, 255)
    dc.<span class="function">DrawCircle</span>(0, 0, 50)
    dc.<span class="function">Fill</span>()
    dc.<span class="function">Pop</span>()
    
    dc.<span class="function">SavePNG</span>(<span class="string">"transform.png"</span>)
}</code></pre>
            
            <h3>é«˜çº§åŠŸèƒ½</h3>
            
            <h4>1. è£å‰ª</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    dc := gg.<span class="function">NewContext</span>(800, 600)
    dc.<span class="function">SetRGB</span>(1, 1, 1)
    dc.<span class="function">Clear</span>()
    
    <span class="comment">// ç»˜åˆ¶åœ†å½¢è£å‰ªåŒºåŸŸ</span>
    dc.<span class="function">DrawCircle</span>(400, 300, 200)
    dc.<span class="function">Clip</span>()
    
    <span class="comment">// åœ¨è£å‰ªåŒºåŸŸå†…ç»˜åˆ¶</span>
    <span class="keyword">for</span> i := 0; i < 10; i++ {
        dc.<span class="function">SetRGB255</span>(<span class="function">byte</span>(i*25), 0, <span class="function">byte</span>(255-i*25))
        dc.<span class="function">DrawRectangle</span>(<span class="function">float64</span>(i*80), 0, 80, 600)
        dc.<span class="function">Fill</span>()
    }
    
    dc.<span class="function">SavePNG</span>(<span class="string">"clip.png"</span>)
}</code></pre>
            
            <h4>2. é˜´å½±</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    dc := gg.<span class="function">NewContext</span>(800, 600)
    dc.<span class="function">SetRGB</span>(1, 1, 1)
    dc.<span class="function">Clear</span>()
    
    <span class="comment">// ç»˜åˆ¶é˜´å½±</span>
    dc.<span class="function">SetRGBA255</span>(0, 0, 0, 100)
    dc.<span class="function">DrawRoundedRectangle</span>(110, 110, 200, 150, 20)
    dc.<span class="function">Fill</span>()
    
    <span class="comment">// ç»˜åˆ¶ä¸»ä½“</span>
    dc.<span class="function">SetRGB255</span>(255, 0, 0)
    dc.<span class="function">DrawRoundedRectangle</span>(100, 100, 200, 150, 20)
    dc.<span class="function">Fill</span>()
    
    dc.<span class="function">SavePNG</span>(<span class="string">"shadow.png"</span>)
}</code></pre>
            
            <h4>3. æ··åˆæ¨¡å¼</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    dc := gg.<span class="function">NewContext</span>(800, 600)
    dc.<span class="function">SetRGB</span>(1, 1, 1)
    dc.<span class="function">Clear</span>()
    
    <span class="comment">// ç»˜åˆ¶çº¢è‰²åœ†å½¢</span>
    dc.<span class="function">SetRGB255</span>(255, 0, 0)
    dc.<span class="function">DrawCircle</span>(300, 300, 150)
    dc.<span class="function">Fill</span>()
    
    <span class="comment">// ä½¿ç”¨æ··åˆæ¨¡å¼ç»˜åˆ¶è“è‰²åœ†å½¢</span>
    dc.<span class="function">SetCompositionOp</span>(gg.<span class="function">CompositionOperatorXor</span>)
    dc.<span class="function">SetRGB255</span>(0, 0, 255)
    dc.<span class="function">DrawCircle</span>(500, 300, 150)
    dc.<span class="function">Fill</span>()
    
    dc.<span class="function">SavePNG</span>(<span class="string">"blend.png"</span>)
}</code></pre>
            
            <h3>æœ€ä½³å®è·µ</h3>
            
            <h4>1. æ€§èƒ½ä¼˜åŒ–</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">optimizePerformance</span>() {
    dc := gg.<span class="function">NewContext</span>(800, 600)
    
    <span class="comment">// æ‰¹é‡ç»˜åˆ¶</span>
    <span class="keyword">for</span> i := 0; i < 1000; i++ {
        dc.<span class="function">MoveTo</span>(<span class="function">float64</span>(i), <span class="function">float64</span>(i%600))
        dc.<span class="function">LineTo</span>(<span class="function">float64</span>(i+1), <span class="function">float64</span>((i+1)%600))
    }
    dc.<span class="function">Stroke</span>()
    
    <span class="comment">// é¿å…é¢‘ç¹çš„çŠ¶æ€åˆ‡æ¢</span>
    dc.<span class="function">SetRGB255</span>(255, 0, 0)
    <span class="keyword">for</span> i := 0; i < 100; i++ {
        dc.<span class="function">DrawCircle</span>(<span class="function">float64</span>(i*8), 300, 5)
    }
    dc.<span class="function">Fill</span>()
}</code></pre>
            
            <h4>2. èµ„æºç®¡ç†</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">manageResources</span>() {
    <span class="comment">// é‡ç”¨ Context</span>
    dc := gg.<span class="function">NewContext</span>(800, 600)
    
    <span class="comment">// åŠ è½½å›¾åƒä¸€æ¬¡ï¼Œå¤šæ¬¡ä½¿ç”¨</span>
    img, _ := gg.<span class="function">LoadImage</span>(<span class="string">"sprite.png"</span>)
    
    <span class="keyword">for</span> i := 0; i < 10; i++ {
        dc.<span class="function">Clear</span>()
        dc.<span class="function">DrawImage</span>(img, <span class="function">float64</span>(i*80), 100)
        dc.<span class="function">SavePNG</span>(<span class="function">Sprintf</span>(<span class="string">"frame%d.png"</span>, i))
    }
}</code></pre>
            
            <h4>3. é”™è¯¯å¤„ç†</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"log"</span>
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">handleErrors</span>() {
    dc := gg.<span class="function">NewContext</span>(800, 600)
    
    <span class="comment">// åŠ è½½å­—ä½“</span>
    <span class="keyword">if</span> err := dc.<span class="function">LoadFontFace</span>(<span class="string">"font.ttf"</span>, 24); err != <span class="keyword">nil</span> {
        log.<span class="function">Fatal</span>(<span class="string">"Failed to load font:"</span>, err)
    }
    
    <span class="comment">// ä¿å­˜å›¾åƒ</span>
    <span class="keyword">if</span> err := dc.<span class="function">SavePNG</span>(<span class="string">"output.png"</span>); err != <span class="keyword">nil</span> {
        log.<span class="function">Fatal</span>(<span class="string">"Failed to save image:"</span>, err)
    }
}</code></pre>
            
            <h4>4. ä½¿ç”¨æ¨¡æ¿</h4>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"github.com/fogleman/gg"</span>
)

<span class="function">func</span> <span class="function">useTemplates</span>() {
    <span class="comment">// åˆ›å»ºæ¨¡æ¿</span>
    templateDC := gg.<span class="function">NewContext</span>(800, 600)
    templateDC.<span class="function">SetRGB</span>(1, 1, 1)
    templateDC.<span class="function">Clear</span>()
    templateDC.<span class="function">DrawRectangle</span>(10, 10, 780, 580)
    templateDC.<span class="function">SetLineWidth</span>(5)
    templateDC.<span class="function">Stroke</span>()
    
    <span class="comment">// ä½¿ç”¨æ¨¡æ¿åˆ›å»ºæ–°å›¾åƒ</span>
    dc := gg.<span class="function">NewContext</span>(800, 600)
    dc.<span class="function">DrawImage</span>(templateDC.<span class="function">Image</span>(), 0, 0)
    
    <span class="comment">// æ·»åŠ è‡ªå®šä¹‰å†…å®¹</span>
    dc.<span class="function">SetRGB255</span>(255, 0, 0)
    dc.<span class="function">DrawCircle</span>(400, 300, 100)
    dc.<span class="function">Fill</span>()
}</code></pre>
            
            <h3>ä½¿ç”¨åœºæ™¯</h3>
            <ul>
                <li><strong>æ•°æ®å¯è§†åŒ–</strong>ï¼šåˆ›å»ºå›¾è¡¨ã€å›¾å½¢ã€ä»ªè¡¨ç›˜</li>
                <li><strong>å›¾åƒå¤„ç†</strong>ï¼šå›¾åƒç¼–è¾‘ã€æ»¤é•œã€åˆæˆ</li>
                <li><strong>æ¸¸æˆå¼€å‘</strong>ï¼š2D æ¸¸æˆæ¸²æŸ“ã€ç²¾çµç»˜åˆ¶</li>
                <li><strong>æŠ¥å‘Šç”Ÿæˆ</strong>ï¼šç”Ÿæˆ PDFã€å›¾ç‰‡æŠ¥å‘Š</li>
                <li><strong>Web å›¾å½¢</strong>ï¼šç”Ÿæˆç½‘ç«™å›¾å½¢ã€ç¼©ç•¥å›¾</li>
                <li><strong>è‰ºæœ¯åˆ›ä½œ</strong>ï¼šç”Ÿæˆè‰ºæœ¯ã€åˆ›æ„è®¾è®¡</li>
            </ul>
            
            <h3>æ³¨æ„äº‹é¡¹</h3>
            <ul>
                <li>å­—ä½“æ–‡ä»¶éœ€è¦å•ç‹¬æä¾›ï¼Œç¡®ä¿å­—ä½“æ–‡ä»¶å­˜åœ¨</li>
                <li>å¤§å°ºå¯¸å›¾åƒå¯èƒ½æ¶ˆè€—è¾ƒå¤šå†…å­˜</li>
                <li>é¢‘ç¹çš„ä¿å­˜æ“ä½œä¼šå½±å“æ€§èƒ½</li>
                <li>æ³¨æ„åæ ‡ç³»ç»Ÿçš„æ–¹å‘ï¼ˆå·¦ä¸Šè§’ä¸ºåŸç‚¹ï¼‰</li>
                <li>å˜æ¢æ“ä½œä¼šå½±å“åç»­æ‰€æœ‰ç»˜åˆ¶ï¼Œä½¿ç”¨ Push/Pop ç®¡ç†çŠ¶æ€</li>
                <li>è·¯å¾„æ“ä½œéœ€è¦æ­£ç¡®å…³é—­è·¯å¾„</li>
                <li>é€æ˜åº¦å’Œæ··åˆæ¨¡å¼å¯èƒ½å½±å“æ€§èƒ½</li>
            </ul>
            </div>

            <h2 id="grpc">gRPC RPCæ¡†æ¶</h2>
            <p>gRPC æ˜¯ Google å¼€å‘çš„é«˜æ€§èƒ½ã€å¼€æºçš„é€šç”¨ RPC æ¡†æ¶ï¼ŒåŸºäº HTTP/2 å’Œ Protocol Buffersã€‚å®ƒæ”¯æŒå¤šç§è¯­è¨€ï¼Œæä¾›äº†ç®€å•ã€é«˜æ•ˆçš„è¿œç¨‹è°ƒç”¨æ–¹å¼ï¼Œå¹¿æ³›åº”ç”¨äºå¾®æœåŠ¡æ¶æ„ä¸­ã€‚</p>
            
            <h3>æ ¸å¿ƒç‰¹æ€§</h3>
            <ul>
                <li><strong>åŸºäº HTTP/2</strong>ï¼šæ”¯æŒåŒå‘æµã€å¤šè·¯å¤ç”¨ã€å¤´éƒ¨å‹ç¼©</li>
                <li><strong>ä½¿ç”¨ Protobuf</strong>ï¼šé«˜æ•ˆçš„äºŒè¿›åˆ¶åºåˆ—åŒ–æ ¼å¼</li>
                <li><strong>å¤šè¯­è¨€æ”¯æŒ</strong>ï¼šæ”¯æŒ Goã€Javaã€Pythonã€C++ ç­‰å¤šç§è¯­è¨€</li>
                <li><strong>å››ç§æœåŠ¡æ–¹æ³•</strong>ï¼šä¸€å…ƒè°ƒç”¨ã€æœåŠ¡ç«¯æµã€å®¢æˆ·ç«¯æµã€åŒå‘æµ</li>
                <li><strong>æ‹¦æˆªå™¨</strong>ï¼šæ”¯æŒè¯·æ±‚æ‹¦æˆªå’Œå“åº”å¤„ç†</li>
            </ul>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> get -u google.golang.org/grpc
<span class="keyword">go</span> install google.golang.org/protobuf/cmd/protoc-gen-go@latest
<span class="keyword">go</span> install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest</code></pre>
            
            <h3>å®šä¹‰æœåŠ¡</h3>
            <pre><code>syntax = <span class="string">"proto3"</span>;

<span class="keyword">package</span> example;

<span class="keyword">option</span> go_package = <span class="string">"./example"</span>;

<span class="keyword">service</span> Greeter {
    <span class="keyword">rpc</span> SayHello (HelloRequest) <span class="keyword">returns</span> (HelloReply) {}
    <span class="keyword">rpc</span> SayHelloStream (HelloRequest) <span class="keyword">returns</span> (stream HelloReply) {}
}

<span class="keyword">message</span> HelloRequest {
    <span class="keyword">string</span> name = 1;
}

<span class="keyword">message</span> HelloReply {
    <span class="keyword">string</span> message = 1;
}</code></pre>
            
            <h3>å®ç°æœåŠ¡ç«¯</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"log"</span>
    <span class="string">"net"</span>
    <span class="string">"google.golang.org/grpc"</span>
    pb <span class="string">"path/to/your/proto"</span>
)

<span class="keyword">type</span> server <span class="keyword">struct</span> {
    pb.UnimplementedGreeterServer
}

<span class="function">func</span> (s *server) <span class="function">SayHello</span>(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, <span class="keyword">error</span>) {
    log.<span class="function">Printf</span>(<span class="string">"Received: %v"</span>, in.GetName())
    <span class="keyword">return</span> &pb.HelloReply{Message: <span class="string">"Hello "</span> + in.GetName()}, <span class="keyword">nil</span>
}

<span class="function">func</span> (s *server) <span class="function">SayHelloStream</span>(in *pb.HelloRequest, stream pb.Greeter_SayHelloStreamServer) <span class="keyword">error</span> {
    <span class="keyword">for</span> i := <span class="number">0</span>; i < <span class="number">5</span>; i++ {
        stream.<span class="function">Send</span>(&pb.HelloReply{
            Message: <span class="string">"Hello "</span> + in.GetName() + <span class="string">" "</span> + string(rune(<span class="string">'0'</span>+i)),
        })
    }
    <span class="keyword">return</span> <span class="keyword">nil</span>
}

<span class="function">func</span> <span class="function">main</span>() {
    lis, err := net.<span class="function">Listen</span>(<span class="string">"tcp"</span>, <span class="string">":50051"</span>)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        log.<span class="function">Fatalf</span>(<span class="string">"failed to listen: %v"</span>, err)
    }
    
    s := grpc.<span class="function">NewServer</span>()
    pb.<span class="function">RegisterGreeterServer</span>(s, &server{})
    
    log.<span class="function">Printf</span>(<span class="string">"server listening at %v"</span>, lis.<span class="function">Addr</span>())
    <span class="keyword">if</span> err := s.<span class="function">Serve</span>(lis); err != <span class="keyword">nil</span> {
        log.<span class="function">Fatalf</span>(<span class="string">"failed to serve: %v"</span>, err)
    }
}</code></pre>
            
            <h3>å®ç°å®¢æˆ·ç«¯</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"io"</span>
    <span class="string">"log"</span>
    <span class="string">"time"</span>
    <span class="string">"google.golang.org/grpc"</span>
    pb <span class="string">"path/to/your/proto"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    conn, err := grpc.<span class="function">Dial</span>(<span class="string">"localhost:50051"</span>, grpc.<span class="function">WithTransportCredentials</span>(insecure.<span class="function">NewCredentials</span>()))
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        log.<span class="function">Fatalf</span>(<span class="string">"did not connect: %v"</span>, err)
    }
    <span class="keyword">defer</span> conn.<span class="function">Close</span>()
    
    c := pb.<span class="function">NewGreeterClient</span>(conn)
    
    <span class="comment">// ä¸€å…ƒè°ƒç”¨</span>
    ctx, cancel := context.<span class="function">WithTimeout</span>(context.<span class="function">Background</span>(), time.Second)
    <span class="keyword">defer</span> cancel()
    
    r, err := c.<span class="function">SayHello</span>(ctx, &pb.HelloRequest{Name: <span class="string">"World"</span>})
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        log.<span class="function">Fatalf</span>(<span class="string">"could not greet: %v"</span>, err)
    }
    log.<span class="function">Printf</span>(<span class="string">"Greeting: %s"</span>, r.GetMessage())
    
    <span class="comment">// æµå¼è°ƒç”¨</span>
    stream, err := c.<span class="function">SayHelloStream</span>(ctx, &pb.HelloRequest{Name: <span class="string">"Stream"</span>})
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        log.<span class="function">Fatalf</span>(<span class="string">"could not stream: %v"</span>, err)
    }
    
    <span class="keyword">for</span> {
        reply, err := stream.<span class="function">Recv</span>()
        <span class="keyword">if</span> err == io.EOF {
            <span class="keyword">break</span>
        }
        <span class="keyword">if</span> err != <span class="keyword">nil</span> {
            log.<span class="function">Fatalf</span>(<span class="string">"failed to recv: %v"</span>, err)
        }
        log.<span class="function">Printf</span>(<span class="string">"Stream reply: %s"</span>, reply.GetMessage())
    }
}</code></pre>
            </div>

            <h2 id="gateway">Gateway APIç½‘å…³</h2>
            <p>gRPC-Gateway æ˜¯ Google æä¾›çš„ä¸€ä¸ªæ’ä»¶ï¼Œç”¨äºå°† gRPC æœåŠ¡è½¬æ¢ä¸º RESTful APIã€‚å®ƒå…è®¸å®¢æˆ·ç«¯é€šè¿‡ HTTP/JSON è°ƒç”¨ gRPC æœåŠ¡ï¼ŒåŒæ—¶ä¿æŒ gRPC çš„é«˜æ€§èƒ½å’Œç±»å‹å®‰å…¨ã€‚</p>
            
            <h3>æ ¸å¿ƒç‰¹æ€§</h3>
            <ul>
                <li><strong>è‡ªåŠ¨ç”Ÿæˆ</strong>ï¼šä» Protobuf å®šä¹‰è‡ªåŠ¨ç”Ÿæˆ RESTful API</li>
                <li><strong>åŒå‘è½¬æ¢</strong>ï¼šæ”¯æŒ HTTP/JSON åˆ° gRPC çš„åŒå‘è½¬æ¢</li>
                <li><strong>OpenAPI æ”¯æŒ</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆ OpenAPI (Swagger) æ–‡æ¡£</li>
                <li><strong>åå‘ä»£ç†</strong>ï¼šä½œä¸ºåå‘ä»£ç†è½¬å‘è¯·æ±‚åˆ° gRPC æœåŠ¡</li>
                <li><strong>ä¸­é—´ä»¶æ”¯æŒ</strong>ï¼šæ”¯æŒè®¤è¯ã€æ—¥å¿—ã€CORS ç­‰ä¸­é—´ä»¶</li>
            </ul>
            
            <h3>å®‰è£…</h3>
            <pre><code><span class="keyword">go</span> install github.com/grpc-ecosystem/grpc-gateway/v2/protoc-gen-grpc-gateway@latest
<span class="keyword">go</span> install github.com/grpc-ecosystem/grpc-gateway/v2/protoc-gen-openapiv2@latest</code></pre>
            
            <h3>å®šä¹‰æœåŠ¡</h3>
            <pre><code>syntax = <span class="string">"proto3"</span>;

<span class="keyword">package</span> example;

<span class="keyword">option</span> go_package = <span class="string">"./example"</span>;

<span class="keyword">import</span> <span class="string">"google/api/annotations.proto"</span>;

<span class="keyword">service</span> Greeter {
    <span class="keyword">rpc</span> SayHello (HelloRequest) <span class="keyword">returns</span> (HelloReply) {
        <span class="keyword">option</span> (google.api.http) = {
            <span class="keyword">get</span>: <span class="string">"/v1/hello/{name}"</span>
        };
    }
    
    <span class="keyword">rpc</span> CreateUser (CreateUserRequest) <span class="keyword">returns</span> (User) {
        <span class="keyword">option</span> (google.api.http) = {
            <span class="keyword">post</span>: <span class="string">"/v1/users"</span>
            body: <span class="string">"*"</span>
        };
    }
}

<span class="keyword">message</span> HelloRequest {
    <span class="keyword">string</span> name = 1;
}

<span class="keyword">message</span> HelloReply {
    <span class="keyword">string</span> message = 1;
}

<span class="keyword">message</span> CreateUserRequest {
    <span class="keyword">string</span> name = 1;
    <span class="keyword">string</span> email = 2;
}

<span class="keyword">message</span> User {
    <span class="keyword">string</span> id = 1;
    <span class="keyword">string</span> name = 2;
    <span class="keyword">string</span> email = 3;
}</code></pre>
            
            <h3>ç”Ÿæˆä»£ç </h3>
            <pre><code>protoc -I. \
    --go_out=. --go_opt=paths=source_relative \
    --go-grpc_out=. --go-grpc_opt=paths=source_relative \
    --grpc-gateway_out=. --grpc-gateway_opt=paths=source_relative \
    --openapiv2_out=. --openapiv2_opt=paths=source_relative \
    service.proto</code></pre>
            
            <h3>å®ç° Gateway æœåŠ¡</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"log"</span>
    <span class="string">"net/http"</span>
    <span class="string">"github.com/grpc-ecosystem/grpc-gateway/v2/runtime"</span>
    <span class="string">"google.golang.org/grpc"</span>
    <span class="string">"google.golang.org/grpc/credentials/insecure"</span>
    gw <span class="string">"path/to/your/proto"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»º gRPC è¿æ¥</span>
    conn, err := grpc.<span class="function">DialContext</span>(
        context.<span class="function">Background</span>(),
        <span class="string">"localhost:50051"</span>,
        grpc.<span class="function">WithTransportCredentials</span>(insecure.<span class="function">NewCredentials</span>()),
    )
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        log.<span class="function">Fatalf</span>(<span class="string">"failed to dial server: %v"</span>, err)
    }
    
    <span class="comment">// åˆ›å»º Gateway mux</span>
    mux := runtime.<span class="function">NewServeMux</span>()
    
    <span class="comment">// æ³¨å†ŒæœåŠ¡</span>
    err = gw.<span class="function">RegisterGreeterHandler</span>(context.<span class="function">Background</span>(), mux, conn)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        log.<span class="function">Fatalf</span>(<span class="string">"failed to register handler: %v"</span>, err)
    }
    
    <span class="comment">// å¯åŠ¨ HTTP æœåŠ¡</span>
    addr := <span class="string">":8080"</span>
    log.<span class="function">Printf</span>(<span class="string">"Gateway server listening on %s"</span>, addr)
    
    <span class="keyword">if</span> err := http.<span class="function">ListenAndServe</span>(addr, mux); err != <span class="keyword">nil</span> {
        log.<span class="function">Fatalf</span>(<span class="string">"failed to serve: %v"</span>, err)
    }
}</code></pre>
            
            <h3>æ·»åŠ ä¸­é—´ä»¶</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"log"</span>
    <span class="string">"net/http"</span>
)

<span class="comment">// CORS ä¸­é—´ä»¶</span>
<span class="function">func</span> <span class="function">corsMiddleware</span>(h http.Handler) http.Handler {
    <span class="keyword">return</span> http.<span class="function">HandlerFunc</span>(<span class="keyword">func</span>(w http.ResponseWriter, r *http.Request) {
        w.<span class="function">Header</span>().<span class="function">Set</span>(<span class="string">"Access-Control-Allow-Origin"</span>, <span class="string">"*"</span>)
        w.<span class="function">Header</span>().<span class="function">Set</span>(<span class="string">"Access-Control-Allow-Methods"</span>, <span class="string">"GET, POST, PATCH, DELETE, OPTIONS"</span>)
        w.<span class="function">Header</span>().<span class="function">Set</span>(<span class="string">"Access-Control-Allow-Headers"</span>, <span class="string">"Content-Type, Authorization"</span>)
        
        <span class="keyword">if</span> r.Method == <span class="string">"OPTIONS"</span> {
            w.<span class="function">WriteHeader</span>(http.StatusOK)
            <span class="keyword">return</span>
        }
        
        h.<span class="function">ServeHTTP</span>(w, r)
    })
}

<span class="comment">// æ—¥å¿—ä¸­é—´ä»¶</span>
<span class="function">func</span> <span class="function">loggingMiddleware</span>(h http.Handler) http.Handler {
    <span class="keyword">return</span> http.<span class="function">HandlerFunc</span>(<span class="keyword">func</span>(w http.ResponseWriter, r *http.Request) {
        log.<span class="function">Printf</span>(<span class="string">"Request: %s %s"</span>, r.Method, r.URL.Path)
        h.<span class="function">ServeHTTP</span>(w, r)
    })
}

<span class="comment">// ä½¿ç”¨ä¸­é—´ä»¶</span>
<span class="function">func</span> <span class="function">main</span>() {
    mux := runtime.<span class="function">NewServeMux</span>()
    
    <span class="comment">// ä½¿ç”¨ä¸­é—´ä»¶åŒ…è£…</span>
    handler := <span class="function">corsMiddleware</span>(<span class="function">loggingMiddleware</span>(mux))
    
    http.<span class="function">ListenAndServe</span>(<span class="string">":8080"</span>, handler)
}</code></pre>
            
            <h3>æµ‹è¯• API</h3>
            <pre><code><span class="comment"># GET è¯·æ±‚</span>
curl http://localhost:8080/v1/hello/World

<span class="comment"># POST è¯·æ±‚</span>
curl -X POST http://localhost:8080/v1/users \
  -H <span class="string">"Content-Type: application/json"</span> \
  -d <span class="string">'{"name": "Alice", "email": "alice@example.com"}'</span>

<span class="comment"># æŸ¥çœ‹ OpenAPI æ–‡æ¡£</span>
curl http://localhost:8080/swagger.json</code></pre>
            </div>

            <h2 id="redis">Redis å®¢æˆ·ç«¯</h2>
            <p>Redis æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„é”®å€¼å­˜å‚¨æ•°æ®åº“ï¼ŒGo ä¸­å¸¸ç”¨ go-redis åº“è¿›è¡Œæ“ä½œã€‚</p>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">go get</span> github.com/redis/go-redis/v9</code></pre>
            
            <h3>åŸºæœ¬æ“ä½œ</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"context"</span>
    <span class="string">"fmt"</span>
    <span class="string">"time"</span>
    <span class="string">"github.com/redis/go-redis/v9"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    <span class="comment">// åˆ›å»ºå®¢æˆ·ç«¯</span>
    rdb := redis.<span class="function">NewClient</span>(&redis.Options{
        Addr:     <span class="string">"localhost:6379"</span>,
        Password: <span class="string">""</span>,
        DB:       0,
    })
    
    ctx := context.<span class="function">Background</span>()
    
    <span class="comment">// è®¾ç½®é”®å€¼</span>
    err := rdb.<span class="function">Set</span>(ctx, <span class="string">"key"</span>, <span class="string">"value"</span>, 0).<span class="function">Err</span>()
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">panic</span>(err)
    }
    
    <span class="comment">// è·å–é”®å€¼</span>
    val, err := rdb.<span class="function">Get</span>(ctx, <span class="string">"key"</span>).<span class="function">Result</span>()
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">panic</span>(err)
    }
    fmt.<span class="function">Println</span>(<span class="string">"key:"</span>, val)
    
    <span class="comment">// è®¾ç½®è¿‡æœŸæ—¶é—´</span>
    rdb.<span class="function">Set</span>(ctx, <span class="string">"key"</span>, <span class="string">"value"</span>, 10*time.Minute)
    
    <span class="comment">// åˆ é™¤é”®</span>
    rdb.<span class="function">Del</span>(ctx, <span class="string">"key"</span>)
}</code></pre>
            
            <h3>æ•°æ®ç»“æ„æ“ä½œ</h3>
            <pre><code><span class="comment">// 1. Hash æ“ä½œ</span>
rdb.<span class="function">HSet</span>(ctx, <span class="string">"user:1"</span>, <span class="string">"name"</span>, <span class="string">"å¼ ä¸‰"</span>)
rdb.<span class="function">HSet</span>(ctx, <span class="string">"user:1"</span>, <span class="string">"email"</span>, <span class="string">"zhangsan@example.com"</span>)
name, _ := rdb.<span class="function">HGet</span>(ctx, <span class="string">"user:1"</span>, <span class="string">"name"</span>).<span class="function">Result</span>()

<span class="comment">// 2. List æ“ä½œ</span>
rdb.<span class="function">LPush</span>(ctx, <span class="string">"list"</span>, <span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>)
val, _ := rdb.<span class="function">RPop</span>(ctx, <span class="string">"list"</span>).<span class="function">Result</span>()

<span class="comment">// 3. Set æ“ä½œ</span>
rdb.<span class="function">SAdd</span>(ctx, <span class="string">"set"</span>, <span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>)
members, _ := rdb.<span class="function">SMembers</span>(ctx, <span class="string">"set"</span>).<span class="function">Result</span>()

<span class="comment">// 4. Sorted Set æ“ä½œ</span>
rdb.<span class="function">ZAdd</span>(ctx, <span class="string">"zset"</span>, redis.Z{Score: 1, Member: <span class="string">"a"</span>})
rdb.<span class="function">ZAdd</span>(ctx, <span class="string">"zset"</span>, redis.Z{Score: 2, Member: <span class="string">"b"</span>})
result, _ := rdb.<span class="function">ZRangeWithScores</span>(ctx, <span class="string">"zset"</span>, 0, -1).<span class="function">Result</span>()</code></pre>
            
            <h3>å‘å¸ƒè®¢é˜…</h3>
            <pre><code><span class="comment">// å‘å¸ƒæ¶ˆæ¯</span>
err := rdb.<span class="function">Publish</span>(ctx, <span class="string">"channel"</span>, <span class="string">"message"</span>).<span class="function">Err</span>()

<span class="comment">// è®¢é˜…æ¶ˆæ¯</span>
pubsub := rdb.<span class="function">Subscribe</span>(ctx, <span class="string">"channel"</span>)
<span class="keyword">defer</span> pubsub.<span class="function">Close</span>()

<span class="keyword">for</span> {
    msg, err := pubsub.<span class="function">ReceiveMessage</span>(ctx)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">panic</span>(err)
    }
    fmt.<span class="function">Println</span>(<span class="string">"æ”¶åˆ°æ¶ˆæ¯:"</span>, msg.Payload)
}</code></pre>
            
            <h3>äº‹åŠ¡</h3>
            <pre><code><span class="comment">// ä½¿ç”¨äº‹åŠ¡</span>
<span class="function">func</span> <span class="function">transfer</span>(from, to <span class="keyword">string</span>, amount <span class="keyword">int64</span>) <span class="keyword">error</span> {
    tx := rdb.<span class="function">TxPipeline</span>()
    
    err := tx.<span class="function">DecrBy</span>(ctx, from, amount).<span class="function">Err</span>()
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    
    tx.<span class="function">IncrBy</span>(ctx, to, amount)
    
    _, err = tx.<span class="function">Exec</span>(ctx)
    <span class="keyword">return</span> err
}</code></pre>
            
            <h3>Redis æœ€ä½³å®è·µ</h3>
            <div class="note-box">
                <h4>1. è¿æ¥æ± é…ç½®</h4>
                <pre><code>rdb := redis.<span class="function">NewClient</span>(&redis.Options{
    Addr:         <span class="string">"localhost:6379"</span>,
    Password:     <span class="string">""</span>,
    DB:           0,
    PoolSize:     10,   <span class="comment">// è¿æ¥æ± å¤§å°</span>
    MinIdleConns: 5,    <span class="comment">// æœ€å°ç©ºé—²è¿æ¥</span>
    MaxRetries:   3,    <span class="comment">// æœ€å¤§é‡è¯•æ¬¡æ•°</span>
})</code></pre>
                
                <h4>2. ä½¿ç”¨ Pipeline</h4>
                <pre><code><span class="comment">// æ‰¹é‡æ“ä½œä½¿ç”¨ Pipeline</span>
pipe := rdb.<span class="function">Pipeline</span>()
pipe.<span class="function">Set</span>(ctx, <span class="string">"key1"</span>, <span class="string">"value1"</span>, 0)
pipe.<span class="function">Set</span>(ctx, <span class="string">"key2"</span>, <span class="string">"value2"</span>, 0)
pipe.<span class="function">Set</span>(ctx, <span class="string">"key3"</span>, <span class="string">"value3"</span>, 0)
cmds, err := pipe.<span class="function">Exec</span>(ctx)</code></pre>
                
                <h4>3. é”®å‘½åè§„èŒƒ</h4>
                <pre><code><span class="comment">// ä½¿ç”¨å†’å·åˆ†éš”çš„å±‚æ¬¡ç»“æ„</span>
<span class="string">"user:1:name"</span>
<span class="string">"user:1:email"</span>
<span class="string">"session:abc123"</span>
<span class="string">"cache:product:123"</span></code></pre>
                
                <h4>4. ç¼“å­˜ç­–ç•¥</h4>
                <pre><code><span class="comment">// Cache-Aside æ¨¡å¼</span>
<span class="function">func</span> <span class="function">getUser</span>(id <span class="keyword">int64</span>) (*User, <span class="keyword">error</span>) {
    <span class="comment">// 1. å…ˆæŸ¥ç¼“å­˜</span>
    key := fmt.<span class="function">Sprintf</span>(<span class="string">"user:%d"</span>, id)
    val, err := rdb.<span class="function">Get</span>(ctx, key).<span class="function">Result</span>()
    <span class="keyword">if</span> err == <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="function">unmarshalUser</span>(val)
    }
    
    <span class="comment">// 2. æŸ¥æ•°æ®åº“</span>
    user, err := db.<span class="function">GetUser</span>(id)
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="keyword">nil</span>, err
    }
    
    <span class="comment">// 3. å†™å…¥ç¼“å­˜</span>
    data, _ := json.<span class="function">Marshal</span>(user)
    rdb.<span class="function">Set</span>(ctx, key, data, 10*time.Minute)
    
    <span class="keyword">return</span> user, <span class="keyword">nil</span>
}</code></pre>
            </div>

            <h2 id="mysql">MySQL å®¢æˆ·ç«¯</h2>
            <p>Go ä¸­å¸¸ç”¨ GORM æˆ– database/sql æ“ä½œ MySQL æ•°æ®åº“ã€‚</p>
            
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <pre><code><span class="keyword">go get</span> gorm.io/gorm
<span class="keyword">go get</span> gorm.io/driver/mysql</code></pre>
            
            <h3>è¿æ¥æ•°æ®åº“</h3>
            <pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"gorm.io/driver/mysql"</span>
    <span class="string">"gorm.io/gorm"</span>
)

<span class="function">func</span> <span class="function">main</span>() {
    dsn := <span class="string">"user:password@tcp(127.0.0.1:3306)/dbname?charset=utf8mb4&parseTime=True&loc=Local"</span>
    db, err := gorm.<span class="function">Open</span>(mysql.<span class="function">Open</span>(dsn), &gorm.Config{})
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">panic</span>(err)
    }
}</code></pre>
            
            <h3>å®šä¹‰æ¨¡å‹</h3>
            <pre><code><span class="keyword">type</span> User <span class="keyword">struct</span> {
    ID        <span class="keyword">uint</span>           <span class="string">`gorm:"primaryKey"`</span>
    Name      <span class="keyword">string</span>         <span class="string">`gorm:"size:255;not null"`</span>
    Email     <span class="keyword">string</span>         <span class="string">`gorm:"size:255;uniqueIndex"`</span>
    Age       <span class="keyword">int</span>            <span class="string">`gorm:"default:0"`</span>
    CreatedAt time.Time
    UpdatedAt time.Time
    DeletedAt gorm.DeletedAt <span class="string">`gorm:"index"`</span>
}

<span class="comment">// è‡ªåŠ¨è¿ç§»</span>
db.<span class="function">AutoMigrate</span>(&User{})</code></pre>
            
            <h3>CRUD æ“ä½œ</h3>
            <pre><code><span class="comment">// åˆ›å»º</span>
user := User{Name: <span class="string">"å¼ ä¸‰"</span>, Email: <span class="string">"zhangsan@example.com"</span>}
result := db.<span class="function">Create</span>(&user)

<span class="comment">// æŸ¥è¯¢</span>
<span class="keyword">var</span> user User
db.<span class="function">First</span>(&user, 1)  <span class="comment">// æ ¹æ® ID æŸ¥è¯¢</span>
db.<span class="function">Where</span>(<span class="string">"name = ?"</span>, <span class="string">"å¼ ä¸‰"</span>).<span class="function">First</span>(&user)
db.<span class="function">Find</span>(&users)  <span class="comment">// æŸ¥è¯¢æ‰€æœ‰</span>

<span class="comment">// æ›´æ–°</span>
db.<span class="function">Model</span>(&user).<span class="function">Update</span>(<span class="string">"name"</span>, <span class="string">"æå››"</span>)
db.<span class="function">Model</span>(&user).<span class="function">Updates</span>(User{Name: <span class="string">"æå››"</span>, Age: 30})

<span class="comment">// åˆ é™¤</span>
db.<span class="function">Delete</span>(&user)  <span class="comment">// è½¯åˆ é™¤</span>
db.<span class="function">Unscoped</span>().<span class="function">Delete</span>(&user)  <span class="comment">// æ°¸ä¹…åˆ é™¤</span></code></pre>
            
            <h3>å¤æ‚æŸ¥è¯¢</h3>
            <pre><code><span class="comment">// æ¡ä»¶æŸ¥è¯¢</span>
db.<span class="function">Where</span>(<span class="string">"age > ?"</span>, 18).<span class="function">Find</span>(&users)
db.<span class="function">Where</span>(<span class="string">"name LIKE ?"</span>, <span class="string">"%å¼ %"</span>).<span class="function">Find</span>(&users)

<span class="comment">// Or æŸ¥è¯¢</span>
db.<span class="function">Where</span>(<span class="string">"name = ?"</span>, <span class="string">"å¼ ä¸‰"</span>).<span class="function">Or</span>(<span class="string">"name = ?"</span>, <span class="string">"æå››"</span>).<span class="function">Find</span>(&users)

<span class="comment">// æ’åºå’Œåˆ†é¡µ</span>
db.<span class="function">Order</span>(<span class="string">"age desc"</span>).<span class="function">Offset</span>(0).<span class="function">Limit</span>(10).<span class="function">Find</span>(&users)

<span class="comment">// ç»Ÿè®¡</span>
<span class="keyword">var</span> count <span class="keyword">int64</span>
db.<span class="function">Model</span>(&User{}).<span class="function">Count</span>(&count)

<span class="comment">// åŸç”Ÿ SQL</span>
db.<span class="function">Raw</span>(<span class="string">"SELECT * FROM users WHERE age > ?"</span>, 18).<span class="function">Scan</span>(&users)</code></pre>
            
            <h3>äº‹åŠ¡</h3>
            <pre><code><span class="comment">// è‡ªåŠ¨äº‹åŠ¡</span>
err := db.<span class="function">Transaction</span>(<span class="keyword">func</span>(tx *gorm.DB) <span class="keyword">error</span> {
    <span class="keyword">if</span> err := tx.<span class="function">Create</span>(&user1).<span class="function">Error</span>; err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">if</span> err := tx.<span class="function">Create</span>(&user2).<span class="function">Error</span>; err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> err
    }
    <span class="keyword">return</span> <span class="keyword">nil</span>
})

<span class="comment">// æ‰‹åŠ¨äº‹åŠ¡</span>
tx := db.<span class="function">Begin</span>()
<span class="keyword">defer</span> <span class="function">func</span>() {
    <span class="keyword">if</span> r := <span class="function">recover</span>(); r != <span class="keyword">nil</span> {
        tx.<span class="function">Rollback</span>()
    }
}()

<span class="keyword">if</span> err := tx.<span class="function">Create</span>(&user).<span class="function">Error</span>; err != <span class="keyword">nil</span> {
    tx.<span class="function">Rollback</span>()
    <span class="keyword">return</span> err
}

tx.<span class="function">Commit</span>()</code></pre>
            
            <h3>MySQL æœ€ä½³å®è·µ</h3>
            <div class="note-box">
                <h4>1. è¿æ¥æ± é…ç½®</h4>
                <pre><code>sqlDB, _ := db.<span class="function">DB</span>()
sqlDB.<span class="function">SetMaxIdleConns</span>(10)
sqlDB.<span class="function">SetMaxOpenConns</span>(100)
sqlDB.<span class="function">SetConnMaxLifetime</span>(time.Hour)</code></pre>
                
                <h4>2. ä½¿ç”¨ç´¢å¼•</h4>
                <pre><code><span class="keyword">type</span> User <span class="keyword">struct</span> {
    Email <span class="keyword">string</span> <span class="string">`gorm:"uniqueIndex"`</span>
    Age   <span class="keyword">int</span>    <span class="string">`gorm:"index"`</span>
}</code></pre>
                
                <h4>3. æ‰¹é‡æ“ä½œ</h4>
                <pre><code><span class="comment">// ä½¿ç”¨ CreateInBatches æ‰¹é‡æ’å…¥</span>
users := []User{{Name: <span class="string">"a"</span>}, {Name: <span class="string">"b"</span>}, {Name: <span class="string">"c"</span>}}
db.<span class="function">CreateInBatches</span>(users, 100)</code></pre>
                
                <h4>4. é¢„åŠ è½½é¿å… N+1</h4>
                <pre><code><span class="comment">// ä½¿ç”¨ Preload é¢„åŠ è½½å…³è”</span>
db.<span class="function">Preload</span>(<span class="string">"Orders"</span>).<span class="function">Find</span>(&users)</code></pre>
                
                <h4>5. ä½¿ç”¨è½¯åˆ é™¤</h4>
                <pre><code><span class="keyword">type</span> User <span class="keyword">struct</span> {
    DeletedAt gorm.DeletedAt <span class="string">`gorm:"index"`</span>
}</code></pre>
            </div>

            <h3>é›†æˆæœ€ä½³å®è·µ</h3>
            <div class="example-box">
                <h4>å®Œæ•´çš„æ•°æ®è®¿é—®å±‚</h4>
                <pre><code><span class="keyword">type</span> UserRepository <span class="keyword">interface</span> {
    <span class="function">Create</span>(user *User) <span class="keyword">error</span>
    <span class="function">GetByID</span>(id <span class="keyword">uint</span>) (*User, <span class="keyword">error</span>)
    <span class="function">GetByEmail</span>(email <span class="keyword">string</span>) (*User, <span class="keyword">error</span>)
    <span class="function">Update</span>(user *User) <span class="keyword">error</span>
    <span class="function">Delete</span>(id <span class="keyword">uint</span>) <span class="keyword">error</span>
}

<span class="keyword">type</span> userRepository <span class="keyword">struct</span> {
    db *gorm.DB
}

<span class="function">func</span> <span class="function">NewUserRepository</span>(db *gorm.DB) UserRepository {
    <span class="keyword">return</span> &userRepository{db: db}
}

<span class="function">func</span> (r *userRepository) <span class="function">GetByID</span>(id <span class="keyword">uint</span>) (*User, <span class="keyword">error</span>) {
    <span class="keyword">var</span> user User
    err := r.db.<span class="function">First</span>(&user, id).<span class="function">Error</span>
    <span class="keyword">if</span> err != <span class="keyword">nil</span> {
        <span class="keyword">return</span> <span class="keyword">nil</span>, err
    }
    <span class="keyword">return</span> &user, <span class="keyword">nil</span>
}</code></pre>
            </div>
<h3>æ€»ç»“</h3>
            <div class="example-box">
                <p>æœ¬ç« ä»‹ç»äº† Go è¯­è¨€ç”Ÿæ€ä¸­æ›´å¤šé‡è¦çš„ç¤¾åŒºåº“ï¼š</p>
                <ul>
                    <li><strong>Validator</strong>ï¼šå¼ºå¤§çš„å‚æ•°æ ¡éªŒåº“ï¼Œæ”¯æŒå¤šç§æ ¡éªŒè§„åˆ™å’Œè‡ªå®šä¹‰è§„åˆ™</li>
                    <li><strong>Cobra</strong>ï¼šåŠŸèƒ½ä¸°å¯Œçš„å‘½ä»¤è¡Œæ¡†æ¶ï¼Œé€‚åˆæ„å»º CLI åº”ç”¨</li>
                    <li><strong>Go-Micro</strong>ï¼šå¾®æœåŠ¡æ¡†æ¶ï¼Œæä¾›æœåŠ¡å‘ç°ã€RPC é€šä¿¡ç­‰åŠŸèƒ½</li>
                    <li><strong>Etcd</strong>ï¼šåˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ï¼Œç”¨äºé…ç½®ç®¡ç†å’ŒæœåŠ¡å‘ç°</li>
                    <li><strong>YAML</strong>ï¼šé…ç½®æ–‡ä»¶å¤„ç†åº“ï¼Œæ”¯æŒ YAML æ ¼å¼çš„è¯»å–ã€å†™å…¥å’Œåºåˆ—åŒ–</li>
                    <li><strong>Sonyflake</strong>ï¼šåˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆå™¨ï¼ŒåŸºäº Snowflake ç®—æ³•ä¼˜åŒ–</li>
                    <li><strong>jinzhu/now</strong>ï¼šè½»é‡çº§æ—¶é—´å·¥å…·åº“ï¼Œæä¾›ä¸°å¯Œçš„æ—¶é—´å¤„ç†åŠŸèƒ½</li>
                </ul>
                <p>è¿™äº›åº“åœ¨æ„å»ºä¼ä¸šçº§åº”ç”¨æ—¶éå¸¸æœ‰ç”¨ï¼ŒæŒæ¡å®ƒä»¬å¯ä»¥å¸®åŠ©æ‚¨æ„å»ºé«˜æ€§èƒ½ã€å¯æ‰©å±•çš„å¾®æœåŠ¡æ¶æ„ã€‚</p>
            </div>
        </div>
    </div>
<script src="code-collapse.js"></script>

</body>
    <script src="navigation.js"></script>
</html>